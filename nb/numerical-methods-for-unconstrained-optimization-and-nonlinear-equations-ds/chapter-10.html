<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Nonlinear Least Squares &#8212; All Things Phi</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-styles.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/phi.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Methods for Problems with Special Structure" href="chapter-11.html" />
    <link rel="prev" title="Secant Methods for Unconstrained Minimization" href="chapter-09.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          All Things Phi</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Archive <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/20/mask-r-cnn.html">Mask R-CNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/19/rich-feature-hierarchies-for-accurate-object-detection-and-semantic-segmentation.html">Rich Feature Hierarchies for Accurate Object Detection and Semantic Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/18/watertight-ray-triangle-intersection.html">Watertight Ray/Triangle Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/17/understanding-deep-learning-requires-rethinking-generalization.html">Understanding Deep Learning Requires Rethinking Generalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/16/accurate-large-minibatch-sgd-training-imagenet-in-1-hour.html">Accurate, Large Minibatch SGD: Training ImageNet in 1 Hour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/15/on-large-batch-training-for-deep-learning-generalization-gap-and-sharp-minima.html">On Large-Batch Training for Deep Learning: Generalization Gap and Sharp Minima</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/14/layer-normalization.html">Layer Normalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/13/batch-normalization-accelerating-deep-network-training-by-reducing-internal-covariate-shift.html">Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/12/deep-residual-learning-for-image-recognition.html">Deep Residual Learning for Image Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/11/optimal-step-nonrigid-icp-algorithms-for-surface-registration.html">Optimal Step Nonrigid ICP Algorithms for Surface Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/10/delving-deep-into-rectifiers-surpassing-human-level-performance-on-imagenet-classification.html">Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/09/least-squares-estimation-of-transformation-parameters-between-two-point-patterns.html">Least-Squares Estimation of Transformation Parameters Between Two Point Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/08/a-fast-learning-algorithm-for-deep-belief-nets.html">A Fast Learning Algorithm for Deep Belief Nets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/07/a-view-of-the-EM-algorithm-that-justifies-incremental-sparse-and-other-variants.html">A View of the EM Algorithm that Justifies Incremental, Sparse, and Other Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/06/one-weird-trick-for-parallelizing-convolutional-neural-networks.html">One Weird Trick for Parallelizing Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/05/exponential-family-harmoniums-with-an-application-to-information-retrieval.html">Exponential Family Harmoniums with an Application to Information Retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/04/pose-space-deformation-a-unified-approach-to-shape-interpolation-and-skeleton-driven-deformation.html">Pose Space Deformation: A Unified Approach to Shape Interpolation and Skeleton-Driven Deformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/02/learning-internal-representations-by-error-propagation.html">Learning Internal Representations by Error Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/01/structuring-a-renderer-phi-ray.html">Structuring a Renderer: <span class="math notranslate nohighlight">\(\varphi\)</span>-Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/30/information-processing-in-dynamical-systems-foundations-of-harmony-theory.html">Information Processing in Dynamical Systems: Foundations of Harmony Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/29/an-introduction-to-the-conjugate-gradient-method-without-the-agonizing-pain.html">An Introduction to the Conjugate Gradient Method Without the Agonizing Pain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/28/a-learning-algorithm-for-boltzmann-machines.html">A Learning Algorithm for Boltzmann Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/27/geometric-skinning-with-approximate-dual-quaternion-blending.html">Geometric Skinning with Approximate Dual Quaternion Blending</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/26/the-perceptron-a-probabilistic-model-for-information-storage-and-organization-in-the-brain.html">The Perceptron: A Probabilistic Model for Information Storage and Organization in the Brain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/25/the-sharpe-ratio.html">The Sharpe Ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/24/neural-networks-and-physical-systems-with-emergent-collective-computational-abilities.html">Neural Networks and Physical Systems with Emergent Collective Computational Abilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/23/training-products-of-experts-by-minimizing-contrastive-divergence.html">Training Products of Experts by Minimizing Contrastive Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/22/market-timing-with-candlestick-technical-analysis.html">Market Timing with Candlestick Technical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/21/all-that-glitters-is-not-gold-comparing-backtest-and-out-of-sample-performance-on-a-large-cohort-of-trading-algorithms.html">All that Glitters is Not Gold: Comparing Backtest and Out-of-Sample Performance on a Large Cohort of Trading Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/20/easy-volatility-investing.html">Easy Volatility Investing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/19/a-tutorial-on-helmholtz-machines.html">A Tutorial on Helmholtz Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/18/when-do-stop-loss-rules-stop-losses.html">When Do Stop-Loss Rules Stop Losses?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/17/a-simple-implicit-measure-of-the-effective-bid-ask-spread-in-an-efficient-market.html">A Simple Implicit Measure of the Effective Bid-Ask Spread in an Efficient Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/16/asset-prices-and-trading-volume-under-fixed-transactions-costs.html">Asset Prices and Trading Volume Under Fixed Transactions Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/15/maxout-networks.html">Maxout Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/14/dropout-a-simple-way-to-prevent-neural-networks-from-overfitting.html">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/13/dropout-training-as-adaptive-regularization.html">Dropout Training as Adaptive Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/12/model-compression.html">Model Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/11/distilling-the-knowledge-in-a-neural-network.html">Distilling the Knowledge in a Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/10/do-deep-nets-really-need-to-be-deep.html">Do Deep Nets Really Need to be Deep?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/09/efficient-backprop.html">Efficient Backprop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/08/stochastic-gradient-descent-tricks.html">Stochastic Gradient Descent Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/07/automatic-differentiation-in-machine-learning-a-survey.html">Automatic Differentiation in Machine Learning: A Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/06/econometric-models-of-limit-order-executions.html">Econometric Models of Limit-Order Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/05/multilayer-feedforward-networks-are-universal-approximators.html">Multilayer Feedforward Networks are Universal Approximators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/04/dendritic-computation.html">Dendritic Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/03/understanding-order-flow.html">Understanding Order Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/02/optimal-control-of-execution-costs.html">Optimal Control of Execution Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/01/risks-and-portfolio-decisions-involving-hedge-funds.html">Risks and Portfolio Decisions Involving Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/30/coordinate-systems.html">Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/28/hedge-funds-the-living-and-the-dead.html">Hedge Funds: The Living and the Dead</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/24/do-hedge-funds-have-enough-capital-a-value-at-risk-approach.html">Do Hedge Funds Have Enough Capital?  A Value-at-Risk Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/23/characterizing-computer-performance-with-a-single-number.html">Characterizing Computer Performance with a Single Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/22/how-to-not-lie-with-statistics-the-correct-way-to-summarize-benchmark-results.html">How Not to Lie with Statistics: The Correct Way to Summarize Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/19/an-econometric-analysis-of-serial-correlation-and-illiquidity-in-hedge-fund-returns.html">An Econometric Analysis of Serial Correlation and Illiquidity in Hedge-Fund Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/13/empirical-characteristics-of-dynamic-trading-strategies-the-case-of-hedge-funds.html">Empirical Characteristics of Dynamic Trading Strategies: The Case of Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/06/orange-juice-and-weath.html">Orange Juice and Weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/04/the-adaptive-markets-hypothesis-market-efficiency-from-an-evolutionary-perspective.html">The Adaptive Markets Hypothesis: Market Efficiency from an Evolutionary Perspective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/02/do-asset-prices-reflect-fundamentals-freshly-squeezed-evidence-from-the-oj-market.html">Do Asset Prices Reflect Fundamentals?  Freshly Squeezed Evidence from the OJ Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/30/neuroeconomics-how-neuroscience-can-inform-economics.html">Neuroeconomics: How Neuroscience Can Inform Economics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/28/drawing-inferences-from-statistics-based-on-multiyear-asset-returns.html">Drawing Inferences from Statistics based on Multiyear Asset Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/26/when-are-contrarian-profits-due-to-stock-market-overreaction.html">When are Contrarian Profits Due to Stock Market Overreaction?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/24/profitability-of-momentum-strategies-an-evaluation-of-alternative-explanations.html">Profitability of Momentum Strategies: An Evaluation of Alternative Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/22/the-restrictions-on-predictability-implied-by-rational-asset-pricing.html">The Restrictions on Predictability Implied by Rational Asset Pricing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/20/the-myth-of-long-horizon-predictability.html">The Myth of Long-Horizon Predictability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/18/the-standard-error-of-regressions.html">The Standard Error of Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/16/lets-take-the-con-out-of-econometrics.html">Let’s Take the Con Out of Econometrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/14/role-of-models-in-statistical-analysis.html">Role of Models in Statistical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/12/the-experimental-generation-of-interpersonal-closeness-a-procedure-and-some-preliminary-findings.html">The Experimental Generation of Interpersonal Closeness: A Procedure and Some Preliminary Findings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/08/02/notes-on-tensorflow.html">Notes on TensorFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/08/01/tensorflow-tensorboard-and-docker.html">TensorFlow, TensorBoard, and Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/13/review-and-analysis-of-solutions-of-the-three-point-perspective-pose-estimation-problem.html">Review and Analysis of Solutions of the Three Point Perspective Pose Estimation Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/12/variational-learning-for-switching-state-space-models.html">Variational Learning for Switching State-Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/11/bayesian-face-recognition.html">Bayesian Face Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/10/robust-generative-subspace-modeling-the-subspace-t-distribution.html">Robust Generative Subspace Modeling: The Subspace <span class="math notranslate nohighlight">\(t\)</span> Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/09/robust-subspace-mixture-models-using-t-distributions.html">Robust Subspace Mixture Models using <span class="math notranslate nohighlight">\(t\)</span>-distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/08/robust-mixture-modelling-using-the-t-distribution.html">Robust Mixture Modelling using the <span class="math notranslate nohighlight">\(t\)</span>-distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/07/mixtures-of-probabilistic-principal-component-analyzers.html">Mixtures of Probabilistic Principal Component Analysers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/06/the-em-algorithm-for-mixtures-of-factor-analyzers.html">The EM Algorithm for Mixtures of Factor Analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/05/3d-live-real-time-captured-content-for-mixed-reality.html">3D Live: Real Time Captured Content for Mixed Reality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/04/high-accuracy-stereo-depth-maps-using-structured-light.html">High-Accuracy Stereo Depth Maps Using Structured Light</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/03/simple-accurate-and-robust-projector-camera-calibration.html">Simple, Accurate, and Robust Projector-Camera Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/02/multiresolution-gray-scale-and-rotation-invariant-texture-classification-with-local-binary-patterns.html">Multiresolution Gray Scale and Rotation Invariant Texture Classification with Local Binary Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/01/generative-or-discriminative-getting-the-best-of-both-worlds.html">Generative or Discriminative?  Getting the Best of Both Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/02/01/seda-an-architecture-for-well-conditioned,-scalable-internet-services.html">SEDA: An Architecture for Well-Conditioned, Scalable Internet Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/26/reconciling-environment-integration-and-component-independence.html">Reconciling Environment Integration and Component Independence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/25/design-patterns-abstraction-and-reuse-of-object-oriented-design.html">Design Patterns: Abstraction and Reuse of Object-Oriented Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/24/a-guide-to-metaphorical-design.html">A Guide to Metaphorical Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/23/a-spiral-model-of-software-development-and-enhancement.html">A Spiral Model of Software Development and Enhancement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/22/sequential-and-concurrent-object-oriented-programming.html">Sequential and Concurrent Object-Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/21/software-aging.html">Software Aging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/20/applying-design-by-contract.html">Applying “Design by Contract”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/19/predicate-logic-for-software-engineering.html">Predicate Logic for Software Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/18/active-design-reviews-principles-and-practices.html">Active Design Reviews: Principles and Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/17/a-rational-design-process-how-and-why-to-fake-it.html">A Rational Design Process: How and Why to Fake It</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/16/the-modular-structure-of-complex-systems.html">The Modular Structure of Complex Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/15/abstract-types-defined-as-classes-of-variables.html">Abstract Types Defined as Classes of Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/14/use-of-abstract-interfaces-in-the-development-of-software-for-embedded-computer-systems.html">Use of Abstract Interfaces in the Development of Software for Embedded Computer Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/13/the-influence-of-software-structure-on-reliability.html">The Influence of Software Structure on Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/12/response-to-detected-errors-in-well-structured-programs.html">Response to Detected Errors in Well-Structured Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/11/the-use-of-abstract-data-types-to-simplify-program-modifications.html">The Use of Abstract Data Types to Simplify Program Modifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/10/use-of-the-concept-of-transparency-in-the-design-of-hierarchically-structured-systems.html">Use of the Concept of Transparency in the Design of Hierarchically Structured Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/09/designing-software-for-ease-of-extension-and-contraction.html">Designing Software for Ease of Extension and Contraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/08/on-the-design-and-development-of-program-families.html">On the Design and Development of Program Families</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/07/on-the-criteria-to-be-used-in-decomposing-systems-into-modules.html">On the Criteria to be Used in Decomposing Systems into Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/06/a-technique-for-software-module-specification-with-examples.html">A Technique for Software Module Specification with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/05/information-distribution-aspects-of-design-methodology.html">Information Distribution Aspects of Design Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/04/a-model-of-large-program-development.html">A Model of Large Program Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/03/architectural-styles-and-the-design-of-network-based-software-architectures.html">Architectural Styles and the Design of Network-based Software Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/02/design-of-design.html">Design of Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/01/notes-on-the-synthesis-of-form.html">Notes on the Synthesis of Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/27/sphinx-on-github-pages.html">Sphinx on GitHub Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/26/blogging-with-docker.html">Blogging with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/25/typical-mercurial-usage.html">Typical Mercurial Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/24/profiling-on-linux.html">Profiling on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/23/trading-cryptocurrencies.html">Trading Cryptocurrencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/22/notes-on-software-design.html">Notes on Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/21/notes-on-scraping-together-a-heterogeneous-system.html">Notes on Scraping Together a Heterogeneous System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/20/transfer-media-files-to-mobile-device-via-vlc.html">Transfer Media Files to Mobile Device via VLC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/19/style-lessons-in-clarity-and-grace.html">Style: Lessons in Clarity and Grace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/18/the-science-of-scientific-writing.html">The Science of Scientific Writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/17/collection-of-notes-on-research.html">Collection of Notes on Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/16/typical-ffmpeg-usage.html">Typical FFmpeg Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/15/generate-svg-graphics.html">Generate SVG Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/14/blogging-with-restructuredtext-a-google-domain-and-sphinx.html">Blogging with RestructuredText, a Google Domain, and Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/13/set-up-android-development-environment.html">Set Up Android Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/12/svegan-lifestyle.html">Svegan Lifestyle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/11/set-up-system-programming-environment.html">Set Up System Programming Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/10/the-rise-and-fall-of-react-flux-redux-and-cycle.html">The Rise and Fall of React, Flux, Redux, and Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/09/install-graphics-and-compute-linux-mint.html">Install Graphics and Compute on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/08/set-up-web-development-environment.html">Set Up Web Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/07/vfio-tips-and-tricks.html">VFIO Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/06/options-trading.html">Options Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/05/assimp-mesh-loader.html">Assimp Mesh Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/04/set-up-data-analysis-environment.html">Set Up Data Analysis Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/03/install-nvidia-drivers-on-linux-mint.html">Install Nvidia Drivers on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/02/blogging-with-restructuredtext-a-google-domain-and-pelican.html">Blogging with RestructuredText, a Google Domain, and Pelican</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/01/linux-mint-installation.html">Linux Mint Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../an-invitation-to-3d-vision-msks/index.html">An Invitation to 3-D Vision - Ma, Soatto, Kosecka, and Sastry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complete-musician-laitz/index.html">The Complete Musician: An Integrated Approach to Tonal Theory, Analysis, and Listening - Laitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer-science-theory-for-the-information-age-hk/index.html">Computer Science Theory for the Information Age - Hopcroft &amp; Kannan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer-vision-models-learning-and-inference-prince/index.html">Computer Vision: Models, Learning, and Inference - Prince</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creativity-nlph/index.html">Creativity - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../differential-geometry-from-a-graphics-perspective-nlph/index.html">Differential Geometry from a Graphics Perspective - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals-of-electric-circuits-as/index.html">Fundamentals of Electric Circuits - Alexander &amp; Sadiku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linear-programming-vanderbei/index.html">Linear Programming - Vanderbei</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multiple-view-geometry-hz/index.html">Multiple View Geometry in Computer Vision - Hartley &amp; Zisserman</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Numerical Methods for Unconstrained Optimization and Nonlinear Equations - Dennis &amp; Schnabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pattern-recognition-and-machine-learning-bishop/index.html">Pattern Recognition and Machine Learning - Bishop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reinforcement-learning-sb/index.html">Reinforcement Learning: An Introduction - Sutton &amp; Barto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stat-labs-ns/index.html">Stat Labs - Nolan &amp; Speed</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Nonlinear Least Squares</a><ul>
<li><a class="reference internal" href="#Gauss-Newton-Type-Methods">Gauss-Newton-Type Methods</a></li>
<li><a class="reference internal" href="#Exercise-1">Exercise 1</a><ul>
<li><a class="reference internal" href="#J(x)"><span class="math notranslate nohighlight">\(J(x)\)</span></a></li>
<li><a class="reference internal" href="#\nabla-f(x)"><span class="math notranslate nohighlight">\(\nabla f(x)\)</span></a></li>
<li><a class="reference internal" href="#S(x)"><span class="math notranslate nohighlight">\(S(x)\)</span></a></li>
<li><a class="reference internal" href="#\nabla^2-f(x)"><span class="math notranslate nohighlight">\(\nabla^2 f(x)\)</span></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-2">Exercise 2</a></li>
<li><a class="reference internal" href="#Exercise-3">Exercise 3</a></li>
<li><a class="reference internal" href="#Exercise-4">Exercise 4</a></li>
<li><a class="reference internal" href="#Exercise-5">Exercise 5</a></li>
<li><a class="reference internal" href="#Exercise-6">Exercise 6</a></li>
<li><a class="reference internal" href="#Exercise-7">Exercise 7</a></li>
<li><a class="reference internal" href="#Exercise-8">Exercise 8</a></li>
<li><a class="reference internal" href="#Exercise-9">Exercise 9</a></li>
<li><a class="reference internal" href="#Exercise-10">Exercise 10</a></li>
<li><a class="reference internal" href="#Exercise-11">Exercise 11</a></li>
<li><a class="reference internal" href="#Exercise-12">Exercise 12</a></li>
<li><a class="reference internal" href="#Exercise-13">Exercise 13</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a><ul>
<li><a class="reference internal" href="#(a.1)">(a.1)</a></li>
<li><a class="reference internal" href="#(b.1)">(b.1)</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-14">Exercise 14</a></li>
<li><a class="reference internal" href="#Exercise-15">Exercise 15</a></li>
<li><a class="reference internal" href="#Exercise-16">Exercise 16</a></li>
<li><a class="reference internal" href="#Exercise-17">Exercise 17</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-18">Exercise 18</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a><ul>
<li><a class="reference internal" href="#(a.1)">(a.1)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-19">Exercise 19</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-20">Exercise 20</a></li>
<li><a class="reference internal" href="#Exercise-21">Exercise 21</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="chapter-09.html" title="Previous Chapter: Secant Methods for Unconstrained Minimization"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Secant Method...</span>
    </a>
  </li>
  <li>
    <a href="chapter-11.html" title="Next Chapter: Methods for Problems with Special Structure"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Methods for P... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Nonlinear-Least-Squares">
<h1>Nonlinear Least Squares<a class="headerlink" href="#Nonlinear-Least-Squares" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Gauss-Newton-Type-Methods">
<h2>Gauss-Newton-Type Methods<a class="headerlink" href="#Gauss-Newton-Type-Methods" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Advantages and disadvantages of Gauss-Newton method</p>
<ul>
<li><p>See Table 10.2.3.</p></li>
<li><p>Each step is a descent direction.</p></li>
</ul>
</li>
<li><p>Damped Gauss-Newton</p>
<ul>
<li><p>Combine line-search with Gauss-Newton to make it locally convergent on most
large-residual or very nonlinear problems.</p></li>
<li><p>Still requires Jacobian to be full column rank.</p></li>
</ul>
</li>
<li><p>Levenberg-Marquardt</p>
<ul>
<li><p>Combine Gauss-Newton with trust region to ensure inverse is well-defined
even if Jacobian is not full column rank.</p></li>
<li><p>Proven to be globally convergent.</p></li>
<li><p>Each step is within the vicinity of steepest descent direction.</p></li>
<li><p>Often superior to damped Gauss-Newton.</p></li>
<li><p>Theorem 10.2.6 suggests that this algorithm may still be slowly
convergent on large residual or very nonlinear problems.</p>
<ul>
<li><p>In practice, More’s scaled trust region is very successful.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="Exercise-1">
<span id="dennis1996numerical-ex-10-1"></span><h2>Exercise 1<a class="headerlink" href="#Exercise-1" title="Permalink to this headline">¶</a></h2>
<p>Define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather*}
  R(x) \colon \mathbb{R}^{n = 4} \mapsto \mathbb{R}^{m = 20},\\
  r_i(x) = x_1 + x_2 \exp[-(t_i + x_3)^2 / x_4] - y_i, \text{and}\\
  f(x) = \frac{1}{2} R(x)^\top R(x) = \frac{1}{2} \sum_{i = 1}^m r_i(x)^2.
\end{gather*}\end{split}\]</div>
<div class="section" id="J(x)">
<h3><span class="math notranslate nohighlight">\(J(x)\)</span><a class="headerlink" href="#J(x)" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="chapter-06.html#dennis1996numerical-ex-6-17"><span class="std std-ref">Exercise 6.17</span></a> for more details.</p>
<div class="math notranslate nohighlight">
\[\begin{split}J(x) = R'(x)
 &amp;= \begin{bmatrix}
      \frac{\partial r_1(x)}{\partial x_1} &amp; \cdots &amp;
        \frac{\partial r_1(x)}{\partial x_n}\\
      \vdots &amp; \ddots &amp; \vdots\\
      \frac{\partial r_m(x)}{\partial x_1} &amp; \cdots &amp;
        \frac{\partial r_m(x)}{\partial x_n}\\
    \end{bmatrix}
    &amp; \quad &amp; \text{Exercise 6.17}\\
 &amp;= \begin{bmatrix}
      1 &amp; \exp[-(t_1 + x_3)^2 x_4^{-1}] &amp;
        -2 x_2 (t_1 + x_3) x_4^{-1} \exp[-(t_1 + x_3)^2 x_4^{-1}] &amp;
        x_2 (t_1 + x_3)^2 x_4^{-2} \exp[-(t_1 + x_3)^2 x_4^{-1}]\\
      \vdots &amp; \vdots &amp; \vdots &amp; \vdots\\
      1 &amp; \exp[-(t_{20} + x_3)^2 x_4^{-1}] &amp;
        -2 x_2 (t_{20} + x_3) x_4^{-1} \exp[-(t_{20} + x_3)^2 x_4^{-1}] &amp;
        x_2 (t_{20} + x_3)^2 x_4^{-2} \exp[-(t_{20} + x_3)^2 x_4^{-1}]
    \end{bmatrix}\end{split}\]</div>
</div>
<div class="section" id="\nabla-f(x)">
<h3><span class="math notranslate nohighlight">\(\nabla f(x)\)</span><a class="headerlink" href="#\nabla-f(x)" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="chapter-06.html#dennis1996numerical-ex-6-17"><span class="std std-ref">Exercise 6.17</span></a> for more details.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f(x) = \sum_{i = 1}^m r_i(x) \nabla r_i(x)
 &amp;= J(x)^\top R(x) \qquad \text{Exercise 6.17}\\
 &amp;= \begin{bmatrix}
      1 &amp; \cdots &amp; 1\\
      \exp[-(t_1 + x_3)^2 x_4^{-1}] &amp; \cdots &amp;
        \exp[-(t_{20} + x_3)^2 x_4^{-1}]\\
      -2 x_2 (t_1 + x_3) x_4^{-1} \exp[-(t_1 + x_3)^2 x_4^{-1}] &amp; \cdots &amp;
        -2 x_2 (t_{20} + x_3) x_4^{-1} \exp[-(t_{20} + x_3)^2 x_4^{-1}]\\
      x_2 (t_1 + x_3)^2 x_4^{-2} \exp[-(t_1 + x_3)^2 x_4^{-1}] &amp; \cdots &amp;
        x_2 (t_{20} + x_3)^2 x_4^{-2} \exp[-(t_{20} + x_3)^2 x_4^{-1}]
    \end{bmatrix} R(x)\\
 &amp;= \begin{bmatrix}
      \sum_{i = 1}^m r_i(x)\\
      \sum_{i = 1}^m r_i(x) \exp[-(t_i + x_3)^2 x_4^{-1}]\\
      -\sum_{i = 1}^m r_i(x) 2 x_2 (t_i + x_3) x_4^{-1}
        \exp[-(t_i + x_3)^2 x_4^{-1}]\\
      \sum_{i = 1}^m r_i(x) x_2 (t_i + x_3)^2 x_4^{-2}
        \exp[-(t_i + x_3)^2 x_4^{-1}]
    \end{bmatrix}\end{split}\]</div>
</div>
<div class="section" id="S(x)">
<h3><span class="math notranslate nohighlight">\(S(x)\)</span><a class="headerlink" href="#S(x)" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="chapter-06.html#dennis1996numerical-ex-6-18"><span class="std std-ref">Exercise 6.18</span></a> for more details.</p>
<div class="math notranslate nohighlight">
\[\begin{split}S(x) &amp;= \sum_{i = 1}^m r_i(x) \nabla^2 r_i(x)
        &amp; \quad &amp; \text{Exercise 6.18}\\
 &amp;= \sum_{i = 1}^m r_i(x) \nabla
      \begin{bmatrix}
        1\\
        \exp[-(t_i + x_3)^2 x_4^{-1}]\\
        -2 x_2 (t_i + x_3) x_4^{-1} \exp[-(t_i + x_3)^2 x_4^{-1}]\\
        x_2 (t_i + x_3)^2 x_4^{-2} \exp[-(t_i + x_3)^2 x_4^{-1}]
      \end{bmatrix}\\
 &amp;= \sum_{i = 1}^m r_i(x)
      \begin{bmatrix}
        0 &amp; 0 &amp; 0 &amp; 0\\
        \star &amp; 0 &amp; -2 (t_i + x_3) x_4^{-1} \exp[-(t_i + x_3)^2 x_4^{-1}] &amp;
          (t_i + x_3)^2 x_4^{-2} \exp[-(t_i + x_3)^2 x_4^{-1}]\\
        \star &amp; \star &amp; \ast &amp; \ast\\
        \star &amp; \star &amp; \star &amp; \ast
      \end{bmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\star\)</span> have the same value as its transposed location and
<span class="math notranslate nohighlight">\(\ast\)</span> are to be completed by the reader.</p>
</div>
<div class="section" id="\nabla^2-f(x)">
<h3><span class="math notranslate nohighlight">\(\nabla^2 f(x)\)</span><a class="headerlink" href="#\nabla^2-f(x)" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="chapter-06.html#dennis1996numerical-ex-6-18"><span class="std std-ref">Exercise 6.18</span></a> for more details.</p>
<div class="math notranslate nohighlight">
\[\nabla^2 f(x) = J(x)^\top J(x) + S(x)\]</div>
</div>
</div>
<div class="section" id="Exercise-2">
<h2>Exercise 2<a class="headerlink" href="#Exercise-2" title="Permalink to this headline">¶</a></h2>
<p>Recall that <span class="math notranslate nohighlight">\(\lambda &gt; \sigma \geq 0\)</span> and
<span class="math notranslate nohighlight">\(c \in (1, \lambda / \sigma)\)</span>.</p>
<p>The constant in (10.2.6) has a range of</p>
<div class="math notranslate nohighlight">
\[\frac{c \sigma + \lambda}{2 \lambda} \in
\left( \frac{\sigma + \lambda}{2 \lambda}, 1 \right).\]</div>
<p>That constant’s original form was</p>
<div class="math notranslate nohighlight">
\[c \frac{\sigma}{\lambda} + \frac{\lambda - c \sigma}{2 \lambda},\]</div>
<p>which is reduced to the proposed <span class="math notranslate nohighlight">\(c \frac{\sigma}{\lambda} = 1\)</span> when
<span class="math notranslate nohighlight">\(c = \lambda / \sigma\)</span>.</p>
<p>This is what I could understand from the problem description.  Otherwise,
(10.2.6) is violated because</p>
<div class="math notranslate nohighlight">
\[c \frac{\sigma}{\lambda} \in \left( \frac{\sigma}{\lambda}, 1 \right)\]</div>
<p>unless when <span class="math notranslate nohighlight">\(\alpha = 0\)</span> in (10.2.5).</p>
</div>
<div class="section" id="Exercise-3">
<h2>Exercise 3<a class="headerlink" href="#Exercise-3" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ J(x) - J(x_*) \right]^\top R(x_*)
 &amp;= J(x)^\top R(x_*)
    &amp; \quad &amp; \text{Theorem 10.2.1 and } J(x_*)^\top R(x_*) = 0\\
 &amp;= \sum_{i = 1}^m r_i(x_*) \nabla r_i(x)
    &amp; \quad &amp; \text{Exercise 1}\\
 &amp;= \sum_{i = 1}^m r_i(x_*) \left[
      \nabla r_i(x_*) + \nabla^2 r_i(x_*) (x - x_*) +
      \mathcal{O}(\left\Vert x - x_* \right\Vert_2^2)
    \right]
    &amp; \quad &amp; \text{first-order Taylor expansion}\\
 &amp;= S(x_*) (x - x_*) + J(x_*)^\top R(x_*) +
    \sum_{i = 1}^m r_i(x_*) \mathcal{O}(\left\Vert x - x_* \right\Vert_2^2)
    &amp; \quad &amp; \text{Exercise 1}\\
 &amp;= S(x_*) (x - x_*) + \mathcal{O}(\left\Vert x - x_* \right\Vert_2^2)\end{split}\]</div>
<p>See <a class="reference internal" href="#dennis1996numerical-ex-10-1"><span class="std std-ref">Exercise 1</span></a> and
<a class="bibtex reference internal" href="#binegarhodte" id="id1">[Bin]</a><a class="bibtex reference internal" href="#follandhodtfsv" id="id2">[Fol]</a> for more details.</p>
</div>
<div class="section" id="Exercise-4">
<span id="dennis1996numerical-ex-10-4"></span><h2>Exercise 4<a class="headerlink" href="#Exercise-4" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">newton</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">S_c</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">J_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J_c</span> <span class="o">+</span> <span class="n">S_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">s</span>

    <span class="c1">#extract scalar from matrix</span>
    <span class="k">return</span> <span class="n">_</span>

<span class="k">def</span> <span class="nf">gauss_newton</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">J_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">s</span>

    <span class="c1">#extract scalar from matrix</span>
    <span class="k">return</span> <span class="n">_</span>

<span class="k">def</span> <span class="nf">secant_1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="n">J_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x_next</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">a_next</span> <span class="o">=</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_next</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_next</span><span class="p">)</span> <span class="o">-</span> <span class="n">g</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_next</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_next</span><span class="p">,</span> <span class="n">a_next</span>

<span class="k">def</span> <span class="nf">secant_newton</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
    <span class="n">J_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">J_c</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J_c</span> <span class="o">+</span> <span class="n">A</span>
    <span class="n">x_next</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">A_next</span> <span class="o">=</span> <span class="p">((</span><span class="n">J</span><span class="p">(</span><span class="n">x_next</span><span class="p">)</span> <span class="o">-</span> <span class="n">J_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_next</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_next</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x_next</span><span class="p">,</span> <span class="n">A_next</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)],</span>
                           <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)],</span>
                           <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)]])</span>

<span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>

<span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">_</span> <span class="o">+=</span> <span class="n">r_i</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">_</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">])</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gauss-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Secant-1D&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">a_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">secant_1d</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">a_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Secant-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">A_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">secant_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">A_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">A_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gauss-Newton
1 0.797681485268023 4.798572539663344 106.43337959215394
2 0.7075326297366793 0.06947285928496987 9.860940386410261
3 0.6934421945480853 2.804859826706154e-05 0.1902319942916944
4 0.6931473062113115 5.083823436164468e-12 8.091952383927143e-05
5 0.6931471805599682 1.684266350377305e-25 1.472866273388815e-11
6 0.6931471805599453 1.5777218104420236e-30 -4.2632564145606e-14
7 0.6931471805599454 1.9721522630525295e-30 4.9737991503207026e-14
8 0.6931471805599453 1.5777218104420236e-30 -4.2632564145606e-14
Newton
1 0.8729918237243539 17.945438055943427 256.32405187794905
2 0.7736000145002915 2.642378244000565 73.64363082415387
3 0.7142113601455673 0.15188433600754053 14.864643595252721
4 0.6949161568380523 0.001012790924586588 1.1479866632350721
5 0.6931606396245242 5.833141447658211e-08 0.008668143002826043
6 0.6931471813446821 1.9829141280503995e-16 5.053704985954406e-07
7 0.6931471805599453 1.5777218104420236e-30 -4.2632564145606e-14
8 0.6931471805599454 1.9721522630525295e-30 4.9737991503207026e-14
Secant-1D
1 0.8729918237243539 17.945438055943427 256.32405187794905
2 0.8108570547759058 6.334571483430388 127.06401085423846
3 0.7497779084785361 1.2191425191346346 46.68223221178341
4 0.7143058034952143 0.15329163936525653 14.937429607434115
5 0.6976145019987203 0.006509690750205783 2.933205196835438
6 0.6935360200729546 4.873987772145979e-05 0.25083485731468713
7 0.6931546314865848 1.7876635805453848e-08 0.00479855164903069
8 0.6931471931013226 5.0646139471428766e-14 8.076647346819262e-06
Secant-Newton
1 0.797681485268023 4.798572539663344 106.43337959215394
2 0.731289681799256 0.5235985265595988 28.997539172425046
3 0.6989136719544521 0.010887376118456476 3.807623768439826
4 0.6932923743798246 6.791008308303912e-06 0.09356365612181405
5 0.6931472723387299 2.7123179020933864e-12 5.910556073636461e-05
6 0.6931471805599818 4.288094052904902e-25 2.3501200985267795e-11
7 0.6931471805599453 1.5777218104420236e-30 -4.2632564145606e-14
8 0.6931471805599454 1.9721522630525295e-30 4.9737991503207026e-14
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-5">
<span id="dennis1996numerical-ex-10-5"></span><h2>Exercise 5<a class="headerlink" href="#Exercise-5" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">])</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.7</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gauss-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Secant-1D&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">a_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">secant_1d</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">a_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">a_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Secant-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">A_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">secant_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">A_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">A_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gauss-Newton
1 -1.3181392160204424 41.37014622797392 -0.5652177807736287
2 4.603063420929212 493776978174.8777 2962538999580.457
3 4.2697199740280904 66829586764.7546 400942681957.58496
4 3.936364890074363 9045570175.395155 54263341625.477844
5 3.6029836310886236 1224521251.1689384 7344143794.657102
6 3.269541898071428 165819808.15308744 994013600.4270636
7 2.935956749386091 22470974.235461347 134544297.35789526
8 2.6020232241347236 3050228.5712296856 18211744.7482201
Newton
1 -0.7753181925883713 41.14527907441983 0.05727237701094268
2 -0.7909037398531175 41.1448223711391 0.0019908002207311704
3 -0.7914855557238429 41.144821791482315 2.6663328043241563e-06
4 -0.7914863370578041 41.14482179148127 4.802380715318577e-12
5 -0.7914863370592115 41.14482179148128 4.440892098500626e-16
6 -0.7914863370592116 41.14482179148128 -8.881784197001252e-16
7 -0.7914863370592113 41.14482179148128 8.881784197001252e-16
8 -0.7914863370592116 41.14482179148128 -8.881784197001252e-16
Secant-1D
1 -0.7753181925883713 41.14527907441983 0.05727237701094268
2 -0.7884320120357908 41.144837783961584 0.010496620886760066
3 -0.7913747927094275 41.144821812714476 0.00038074597382831143
4 -0.7914855544480799 41.144821791482315 2.6706863969216954e-06
5 -0.7914863368580352 41.14482179148127 6.865192858640512e-10
6 -0.791486337059211 41.14482179148128 1.3322676295501878e-15
7 -0.7914863370592115 41.14482179148128 4.440892098500626e-16
8 -0.7914863370592117 41.14482179148128 -1.3322676295501878e-15
Secant-Newton
1 -1.3181392160204424 41.37014622797392 -0.5652177807736287
2 -0.8658644841836972 41.15325353487681 -0.21408957648183602
3 -0.651247739313924 41.18666389076415 0.6641431077724418
4 -0.8016261951479147 41.14499451637015 -0.03380400577673148
5 -0.7939862144878457 41.14483241371934 -0.008481899318829367
6 -0.7914338276553045 41.14482179618622 0.00017921144377242015
7 -0.7914865943296561 41.14482179148138 -8.779418063653566e-07
8 -0.791486337085712 41.14482179148128 -9.043343851544705e-11
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">])</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Secant-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="n">A_c</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">secant_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">,</span> <span class="n">A_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">A_c</span> <span class="o">=</span> <span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x_c</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Secant-Newton
1 0.8289297211970873 2.866613066659297 86.71740114325145
2 0.7789272577862364 0.3567726169698321 18.299700156353552
3 0.7624256408592597 0.19852242343622828 1.2817262639102118
4 0.7610898236380687 0.19766317205318565 0.007228509731195487
5 0.761082202873457 0.19766314450975261 9.251903421159113e-08
6 0.7610822027759129 0.19766314450975353 -1.4033219031261979e-13
7 0.761082202775913 0.19766314450975309 2.3092638912203256e-14
-5.936710010394714
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-6">
<h2>Exercise 6<a class="headerlink" href="#Exercise-6" title="Permalink to this headline">¶</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}S_G - S_N &amp;= (x_+^G - x_c) - (x_+^N - x_c)\\
 &amp;= -(J_c^\top J_c)^{-1} J_c^\top R_c +
    (J_c^\top J_c + S_c)^{-1} J_c^\top R_c\\
 &amp;= -(J_c^\top J_c)^{-1}
    \left[
      I - J_c^\top J_c (J_c^\top J_c + S_c)^{-1}
    \right] J_c^\top R_c\\
 &amp;= -(J_c^\top J_c)^{-1}
    \left[
      -(J_c^\top J_c + S_c) + J_c^\top J_c
    \right] S_N\\
 &amp;= (J_c^\top J_c)^{-1} S_c S_N\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\nabla f(x_c) = \nabla f_c = J_c^\top R_c\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_+^G - x_* &amp;= x_c - x_* - (J_c^\top J_c)^{-1} J_c^\top R_c\\
 &amp;= -(J_c^\top J_c)^{-1} \left[
      \nabla f_c + J_c^\top J_c (x_* - x_c)
    \right]\\
 &amp;= -(J_c^\top J_c)^{-1} \left[
      \nabla f_c - S_c (x_* - x_c) +
      (J_c^\top J_c + S_c) (x_* - x_c)
    \right]\\
 &amp;= (J_c^\top J_c)^{-1} \left[
      S_c (x_* - x_c) + \nabla f_* - \nabla f_c -
      (J_c^\top J_c + S_c) (x_* - x_c)
    \right]
    &amp; \quad &amp; \nabla f_* = J_*^\top R_* = 0 \text{ by Lemma 4.3.1}\\
\left\Vert x_+^G - x_* \right\Vert_2
 &amp;= \left\Vert
      (J_c^\top J_c)^{-1} \left[
        S_c (x_* - x_c) + \nabla f_* - \nabla f_c -
        (J_c^\top J_c + S_c) (x_* - x_c)
      \right]
    \right\Vert_2\\
 &amp;\leq \left\Vert (J_c^\top J_c)^{-1} \right\Vert_2
       \left\Vert S_c \right\Vert_2 \left\Vert x_c - x_* \right\Vert_2 +
       \left\Vert (J_c^\top J_c)^{-1} \right\Vert_2
         \left\Vert
           \nabla f_* - \nabla f_c - (J_c^\top J_c + S_c) (x_* - x_c)
         \right\Vert_2
       &amp; \quad &amp; \text{(3.1.10) and Exercise 3.4}\\
 &amp;\leq \left\Vert (J_c^\top J_c)^{-1} \right\Vert_2
       \left\Vert S_c \right\Vert_2 \left\Vert x_c - x_* \right\Vert_2 +
       \frac{\gamma}{2} \left\Vert (J_c^\top J_c)^{-1} \right\Vert_2
         \left\Vert x_* - x_c \right\Vert_2^2
       &amp; \quad &amp; \text{Lemma 4.1.12}\\
 &amp;\leq \left\Vert (J_c^\top J_c)^{-1} \right\Vert_2
       \left\Vert S_c \right\Vert_2 \left\Vert x_c - x_* \right\Vert_2 +
       \mathcal{O}\left( \left\Vert x_c - x_* \right\Vert_2^2 \right)
       &amp; \quad &amp; \text{Exercise 3.4}\end{split}\]</div>
<p>In the case of <span class="math notranslate nohighlight">\(n = 1\)</span>, applying (3.1.2c) gives (10.5.1).
See <a class="reference internal" href="chapter-03.html#dennis1996numerical-ex-3-4"><span class="std std-ref">Exercise 3.4</span></a> for more details.</p>
</div>
<div class="section" id="Exercise-7">
<h2>Exercise 7<a class="headerlink" href="#Exercise-7" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(x_0 = x_* + \delta\)</span> where <span class="math notranslate nohighlight">\(\delta &gt; 0\)</span>.  When
<span class="math notranslate nohighlight">\(\lvert \delta \rvert\)</span> is sufficiently small,</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_1^G &amp;= x_0 - (J_0^\top J_0)^{-1} J_0^\top R_0
         &amp; \quad &amp; \text{by definition of Gauss-Newton}\\
\left\Vert x_1^G - x_0 \right\Vert_2
 &amp;\leq \alpha \lvert \delta \rvert
       &amp; \quad &amp; \text{Lemma 4.2.1}.\end{split}\]</div>
<p>Hence <span class="math notranslate nohighlight">\(x_1 \cong x_0 - \alpha \delta\)</span>.  Invoking (10.5.1) yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}(x_+^G - x_*) - \left( S_c (J_c^\top J_c)^{-1} \right) (x_c - x_*)
 &amp;= \mathcal{O}(\left\vert x_c - x_* \right\vert^2)\\
x_+^G - x_*
 &amp;= \left( S_c (J_c^\top J_c)^{-1} \right) (x_c - x_*) +
    \mathcal{O}(\left\vert x_c - x_* \right\vert^2)\\
x_1 - x_*
 &amp;= \delta \left[
      \left( S_0 (J_0^\top J_0)^{-1} \right) +
      \mathcal{O}(\delta)
    \right]\\
\left\vert \frac{x_1 - x_*}{\delta} \right\vert
 &amp;= \left\vert
      \left( S_0 (J_0^\top J_0)^{-1} \right) + \mathcal{O}(\delta)
    \right\vert.\end{split}\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">delta</span> <span class="o">=</span> <span class="mf">0.0001</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">])</span>
<span class="n">x_star</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3719287</span>
<span class="n">J_star</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_star</span><span class="p">)</span>
<span class="n">S_star</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x_star</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">J_star</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J_star</span><span class="p">,</span> <span class="n">S_star</span><span class="p">)</span>

<span class="n">x_0</span> <span class="o">=</span> <span class="n">x_star</span> <span class="o">+</span> <span class="n">delta</span>
<span class="n">e</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x_0</span> <span class="o">-</span> <span class="n">e</span> <span class="o">*</span> <span class="n">delta</span> <span class="o">-</span> <span class="n">x_star</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_0</span> <span class="o">-</span> <span class="n">x_star</span><span class="p">))</span>


<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.0</span><span class="p">])</span>
<span class="n">x_star</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.7914863</span>
<span class="n">J_star</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_star</span><span class="p">)</span>
<span class="n">S_star</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">x_star</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">J_star</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J_star</span><span class="p">,</span> <span class="n">S_star</span><span class="p">)</span>

<span class="n">x_0</span> <span class="o">=</span> <span class="n">x_star</span> <span class="o">+</span> <span class="n">delta</span>
<span class="n">e</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">((</span><span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_0</span><span class="p">)</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x_0</span> <span class="o">-</span> <span class="n">e</span> <span class="o">*</span> <span class="n">delta</span> <span class="o">-</span> <span class="n">x_star</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_0</span> <span class="o">-</span> <span class="n">x_star</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[2.34506567]] [[5.15750003]]
[[2.19976901]]
[[0.45201033]] [[2.9605172]]
[[6.55160976]]
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-8">
<h2>Exercise 8<a class="headerlink" href="#Exercise-8" title="Permalink to this headline">¶</a></h2>
<p>The nonlinearity measure for the latter configuration is twice that of the
former’s settings.  This could explain why both methods converged to the
wrong result.</p>
<p>The Gauss-Newton method converges faster in both settings compared to Newton’s
method.  In the latter configuration, the Hessian of Newton’s method shrinks
towards the zero matrix as the magnitude of the gradient goes to zero.
Gauss-Newton did not experience that despite having a faster shrinking gradient.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">])],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">])]])</span>

<span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">]]])</span>

<span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">r_i</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">_</span> <span class="o">+=</span> <span class="n">r_i</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
                                           <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]])</span>
    <span class="k">return</span> <span class="n">_</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">R</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fpp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">S</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">])</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gauss-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fpp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fpp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gauss-Newton
1 [0.75406408 0.78581937] 0.230568840781627 4.588006739285215 52.501520036199445
2 [0.69782818 0.69931189] 0.0010036922558129178 0.2642056161400473 35.652589176231444
3 [0.6931729  0.69317775] 2.6841803927285428e-08 0.0013536418753972424 34.589627280948655
4 [0.69314718 0.69314718] 1.9726285056677948e-17 3.6695081563895345e-08 34.58413668570615
5 [0.69314718 0.69314718] 4.005934284325451e-31 5.0649172608481935e-15 34.58413653685745
6 [0.69314718 0.69314718] 4.005934284325451e-31 4.9864341922878095e-15 34.58413653685749
7 [0.69314718 0.69314718] 4.005934284325451e-31 5.0649172608481935e-15 34.58413653685745
8 [0.69314718 0.69314718] 4.005934284325451e-31 4.9864341922878095e-15 34.58413653685749
Newton
1 [0.81564456 0.86820864] 1.0013289027358931 11.00808913350165 76.13038140740468
2 [0.73026818 0.74718706] 0.07646606536852447 2.488684557651273 44.44978255981308
3 [0.69788478 0.69905288] 0.0009679391078418193 0.2595675234876606 35.6340302609343
4 [0.69322068 0.69323479] 2.1988614600444903e-07 0.0038746246180375037 34.5998525308189
5 [0.6931472 0.6931472] 1.1906844585914362e-14 9.015366143490777e-07 34.58414019381937
6 [0.69314718 0.69314718] 3.3719181466331725e-29 4.797709209280672e-14 34.58413653685767
7 [0.69314718 0.69314718] 4.005934284325451e-31 4.9864341922878095e-15 34.58413653685749
8 [0.69314718 0.69314718] 4.005934284325451e-31 5.0649172608481935e-15 34.58413653685745
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">])</span>
<span class="n">x_0</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span>
                      <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gauss-Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">gauss_newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fpp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)))</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Newton&#39;</span><span class="p">)</span>
<span class="n">x_c</span> <span class="o">=</span> <span class="n">x_0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">newton</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span>
    <span class="n">x_c</span> <span class="o">=</span> <span class="n">_</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_c</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x_c</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span>
          <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">fpp</span><span class="p">(</span><span class="n">x_c</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Gauss-Newton
1 [ 0.90163112 -0.46628928] 20.56191776952204 34.58973081262516 289.6715725097342
2 [-0.36818859 -1.02409293] 10.376725641662436 6.06987964672671 163.84835201858382
3 [-1.35679809 -1.49393682] 9.767842221661171 1.1702074383497212 135.96800692867657
4 [-1.30903259 -1.45981383] 9.762473917870453 0.009666786819778306 128.18531867833067
5 [-1.33251806 -1.47178715] 9.762400496911953 0.007016785162575777 128.27103187578723
6 [-1.3241041  -1.46745693] 9.762391254263322 0.002433728927208294 128.20915596103677
7 [-1.32717445 -1.46903601] 9.762390012341301 0.000901156793237069 128.23088462217402
8 [-1.32605814 -1.46846175] 9.76238984871859 0.0003259007271765508 128.22287481308905
9 [-1.32646455 -1.4686708 ] 9.76238982700529 0.00011887909378551661 128.22577625980256
10 [-1.32631666 -1.46859473] 9.762389824131397 4.3228210833789006e-05 128.22471852324045
11 [-1.32637049 -1.46862242] 9.762389823750652 1.5737057403786923e-05 128.22510323276728
12 [-1.3263509  -1.46861234] 9.76238982370023 5.7266395893342314e-06 128.22496319179058
13 [-1.32635803 -1.46861601] 9.762389823693551 2.084210919093698e-06 128.2250141534847
14 [-1.32635543 -1.46861467] 9.762389823692667 7.58507091534126e-07 128.224995606165
15 [-1.32635638 -1.46861516] 9.76238982369255 2.760490723046993e-07 128.22500235611844
16 [-1.32635603 -1.46861498] 9.762389823692533 1.0046384255095575e-07 128.22499989956154
Newton
1 [-5.74923409  7.46802779] 60.860720234508165 75.54702133707183 169.06642212514757
2 [-6.75061755  7.83744677] 39.25228502035673 29.201597831652535 58.87923451951846
3 [-7.75108426  8.13649786] 29.96080533250285 11.373123185856448 20.40756245009949
4 [-8.75123711  8.34848473] 25.897025050859376 4.413215372409868 7.135111931295802
5 [-9.75128646  8.47378858] 24.153665247324113 1.686548330594559 2.540582864457937
6 [-10.75130275   8.53496468] 23.441928711923843 0.6334141741732487 0.9195696277964355
7 [-11.75130837   8.56081363] 23.165436990089965 0.235171827605604 0.3359779599874159
8 [-12.75131037   8.57089609] 23.06127981190756 0.08683219837152847 0.1232698720635962
9 [-13.7513111    8.57469085] 23.022602051371816 0.03198818502117416 0.04530296995548207
10 [-14.75131136   8.57609891] 23.008322834899026 0.011773881162521788 0.016659830516505058
11 [-15.75131146   8.57661856] 23.00306288784996 0.004332196260795135 0.006127967670570039
12 [-16.7513115    8.57680995] 23.001126920948433 0.0015938381140055543 0.002254239327183045
13 [-17.75131151   8.57688039] 23.000414591019343 0.0005863554654991157 0.0008292728707017905
14 [-18.75131152   8.57690631] 23.000152522215817 0.00021571017730657692 0.0003050703513048174
15 [-19.75131152   8.57691585] 23.000056110153405 7.935561780067604e-05 0.00011222882763368799
16 [-20.75131152   8.57691935] 23.000020641821397 2.9193337997770915e-05 4.128664013018487e-05
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-9">
<h2>Exercise 9<a class="headerlink" href="#Exercise-9" title="Permalink to this headline">¶</a></h2>
<p>There is no value in implementing this at the moment since optimization packages
provide this and the previous exercises have implemented Gauss-Newton and
line-search independently.</p>
<p>The section after (10.2.12) mentioned that the damped Gauss-Newton took ten
times more iterations than Newton’s method for Example 10.2.4.  Since the
symmetric secant method in Example 9.3.2 took twice as long as Newton’s method,
I hypothesize the damped Gauss-Newton will be slower than the secant
approximation.</p>
</div>
<div class="section" id="Exercise-10">
<h2>Exercise 10<a class="headerlink" href="#Exercise-10" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(s = x_+ - x_c \in \mathbb{R}^n\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_{x_+} \left\Vert R(x_c) + J(x_c) s \right\Vert_2
 &amp;\equiv \min_{x_+} \left(
           R(x_c) + J(x_c) s \right)^\top \left( R(x_c) + J(x_c) s
         \right)
         &amp; \quad &amp; \text{square root is monotonically increasing}\\
 &amp;\equiv \min_{x_+} \frac{1}{2} \left(
           R(x_c)^\top R(x_c) + 2 R(x_c)^\top J(x_c) s +
           s^\top J(x_c)^\top J(x_c) s
         \right)
         &amp; \quad &amp; \text{minimum point is not affected by positive scaling}\\
 &amp;= \min_{x_+}
      f(x_c) + \nabla f(x_c)^\top s + \frac{1}{2} s^\top J(x_c)^\top J(x_c) s
    &amp; \quad &amp; \text{see Exercise 1}\end{split}\]</div>
<p>subject to <span class="math notranslate nohighlight">\(\left\Vert s \right\Vert_2 \leq \delta_c\)</span>.
See <a class="reference internal" href="#dennis1996numerical-ex-10-1"><span class="std std-ref">Exercise 1</span></a> for more details.</p>
<p>(10.2.13) now matches the problem format of (6.4.1), so applying Lemma
6.4.1 gives (10.2.14).</p>
</div>
<div class="section" id="Exercise-11">
<h2>Exercise 11<a class="headerlink" href="#Exercise-11" title="Permalink to this headline">¶</a></h2>
<p>Let</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather*}
  x_+, x_c \in \mathbb{R}^n,\\
  f_c = f(x_c) \in \mathbb{R},\\
  J_c = J(x_c) \in \mathbb{R}^{m \times n},\\
  R_c = R(x_c) \in \mathbb{R}^m, \text{ and}\\
  s = x_+ - x_c = -\left( J_c^\top J_c + \mu_c I_n \right)^{-1} J_c^\top R_c.
\end{gather*}\end{split}\]</div>
<p>Assume that either <span class="math notranslate nohighlight">\(J_c^\top J_c\)</span> is positive definite or
<span class="math notranslate nohighlight">\(\mu_c \geq 0\)</span> is picked such that <span class="math notranslate nohighlight">\(J_c^\top J_c + \mu_c I_n\)</span> is
positive definite.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla f_c^\top s
 &amp;= \left[ R_c^\top J_c \right]
    \left[ -\left( J_c^\top J_c + \mu_c I \right)^{-1} J_c^\top R_c \right]
    &amp; \quad &amp; \text{Exercise 1}\\
 &amp;= -\left( R_c^\top J_c \right)
    \left( J_c^\top J_c + \mu_c I \right)^{-1}
    \left( J_c^\top R_c \right)\\
 &amp;&lt; 0\end{split}\]</div>
<p>satisfies the definition of a descent direction (6.2.3).
See <a class="reference internal" href="#dennis1996numerical-ex-10-1"><span class="std std-ref">Exercise 1</span></a> for more details.</p>
</div>
<div class="section" id="Exercise-12">
<h2>Exercise 12<a class="headerlink" href="#Exercise-12" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(R \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(J \in \mathbb{R}^{m \times n}\)</span>, and
<span class="math notranslate nohighlight">\(s \in \mathbb{R}^n\)</span>.</p>
<p>Denote <span class="math notranslate nohighlight">\(A = \begin{bmatrix} J^\top &amp; \mu^{1 / 2} I \end{bmatrix}^\top \in
\mathbb{R}^{(m + n) \times n}\)</span> and <span class="math notranslate nohighlight">\(b =
\begin{bmatrix} R^\top &amp; 0 \end{bmatrix}^\top \in \mathbb{R}^{m + n}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_s \left\Vert As + b \right\Vert
 &amp;\equiv \min_s
           \frac{1}{2} \left( As + b \right)^\top \left( As + b \right)\\
 &amp;= \min_s \frac{1}{2} s^\top A^\top A s + b^\top As + \frac{1}{2} b^\top b\end{split}\]</div>
<p>The solution to this unconstrained minimization problem is</p>
<div class="math notranslate nohighlight">
\[\begin{split}0 &amp;= \frac{\partial}{\partial s} \frac{1}{2} s^\top A^\top As +
     b^\top As + \frac{1}{2} b^\top b\\
 &amp;= A^\top As + A^\top b\\
s &amp;= -\left( A^\top A \right)^{-1} A^\top b\\
 &amp;= -\left( J^\top J + \mu I \right)^{-1} J^\top R.\end{split}\]</div>
</div>
<div class="section" id="Exercise-13">
<h2>Exercise 13<a class="headerlink" href="#Exercise-13" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(J_* \triangleq J(x_*)\)</span>, <span class="math notranslate nohighlight">\(J_k \triangleq J(x_k)\)</span>,
<span class="math notranslate nohighlight">\(R_* \triangleq R(x_*)\)</span>, and <span class="math notranslate nohighlight">\(R_k \triangleq R(x_k)\)</span>.</p>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>According to Theorem 3.1.4, the Levenberg-Marquardt method is well-defined if</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert
  \left( J_*^\top J_* + \mu_* I \right)^{-1}
  \left( J_k^\top J_k + \mu_k I - J_*^\top J_* \right)
\right\Vert_2
 &amp;\leq \left\Vert \left( J_*^\top J_* + \mu_* I \right)^{-1} \right\Vert_2
       \left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2
       &amp; \quad &amp; \text{(3.1.10)}\\
 &amp;\leq \frac{
         \left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2
       }{\lambda + b}
       &amp; \quad &amp; \text{(a.1)}\\
 &amp;&lt; 1,\end{split}\]</div>
<p>which implies that
<span class="math notranslate nohighlight">\(\left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2 &lt;
\lambda + b\)</span>.</p>
<p>Applying (3.2.20) yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert
  \left( J_k^\top J_k + \mu_k I \right)^{-1}
\right\Vert_2
 &amp;\leq \frac{
         \left\Vert \left( J_*^\top J_* + \mu_* I \right)^{-1} \right\Vert_2
       }{
         1 -
         \left\Vert
           \left( J_*^\top J_* + \mu_* I \right)^{-1}
           \left( J_k^\top J_k + \mu_k I - J_*^\top J_* \right)
         \right\Vert_2
       }\\
 &amp;\leq \frac{1}{
         \lambda + b -
         \left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2
       }.\end{split}\]</div>
<p>By inspection, the lower bound on the inverse is attained when
<span class="math notranslate nohighlight">\(\left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2 = 0\)</span>.</p>
<p>In order to make subsequent derivations more elegant, it is beneficial to
obtain an upper bound for the inverse using the assumption that
<span class="math notranslate nohighlight">\(\lambda &gt; \sigma \geq 0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\left\Vert
  \left( J_k^\top J_k + \mu_k I \right)^{-1}
\right\Vert_2 \leq \frac{c}{\lambda + b}
\quad \text{where} \quad
c \in \left( 1, \frac{\lambda + b}{\sigma + b} \right)
\text{ for } x_k \in N(x_*, \epsilon_1).\]</div>
<p>Since the conditions of Theorem 10.2.1 are satisfied,
<span class="math notranslate nohighlight">\(\left\Vert J(x) \right\Vert_2 \leq \alpha \, \forall x \in D\)</span>.  Applying
the results of <a class="reference internal" href="chapter-03.html#dennis1996numerical-ex-3-4"><span class="std std-ref">Exercise 3.4</span></a>,
<a class="reference internal" href="chapter-03.html#dennis1996numerical-ex-3-8"><span class="std std-ref">Exercise 3.8</span></a>, and the proof techniques of
Theorem 10.2.1 gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_{k + 1} - x_*
 &amp;= x_k - x_* - \left( J_k^\top J_k + \mu_k I \right)^{-1} J_k^\top R_k\\
 &amp;= -\left( J_k^\top J_k + \mu_k I \right)^{-1}
    \left[
      J_k^\top R_k + (J_k^\top J_k + \mu_k I) (x_* - x_k)
    \right]\\
\left\Vert x_{k + 1} - x_* \right\Vert_2
 &amp;= \left\Vert
      -\left( J_k^\top J_k + \mu_k I \right)^{-1}
      \left[
        J_k^\top R_* - J_k^\top \left( R_* - R_k - J_k (x_* - x_k) \right) +
        \mu_k (x_* - x_k)
      \right]
    \right\Vert_2\\
 &amp;\leq \left\Vert \left( J_k^\top J_k + \mu_k I \right)^{-1} \right\Vert_2
    \left[
      \left\Vert J_k^\top R_* \right\Vert_2 +
      \left\Vert J_k^\top \right\Vert_2
        \left\Vert R_* - R_k - J_k (x_* - x_k) \right\Vert_2 +
      \left\Vert \mu_k (x_* - x_k) \right\Vert_2
    \right]
    &amp; \quad &amp; \text{(3.1.10) and Exercise 3.4}\\
 &amp;\leq \frac{c}{\lambda + b}
       \left[
         (\sigma + b) \left\Vert x_k - x_* \right\Vert_2 +
         \frac{\alpha \gamma}{2} \left\Vert x_k - x_* \right\Vert_2^2
       \right]
       &amp; \quad &amp; \text{(a.1), (10.2.4), (4.1.12), and Exercise 3.8}.\end{split}\]</div>
<p>Picking</p>
<div class="math notranslate nohighlight">
\[\epsilon =
\min \left\{
  \epsilon_1, \frac{(\lambda + b) - c(\sigma + b)}{c \alpha \gamma}
\right\}\]</div>
<p>simplifies the preceding result to</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert x_{k + 1} - x_* \right\Vert_2
 &amp;\leq \left\Vert x_k - x_* \right\Vert_2
       \left[
         \frac{c (\sigma + b)}{\lambda + b} +
         \frac{c \alpha \gamma}{2 (\lambda + b)}
           \left\Vert x_k - x_* \right\Vert_2
       \right]\\
 &amp;\leq \left\Vert x_k - x_* \right\Vert_2
       \left[
         \frac{c (\sigma + b)}{\lambda + b} +
         \frac{(\lambda + b) - c(\sigma + b)}{2 (\lambda + b)}
       \right]\\
 &amp;\leq \left\Vert x_k - x_* \right\Vert_2
       \frac{c (\sigma + b) + (\lambda + b)}{2 (\lambda + b)}\\
 &amp;&lt; \left\Vert x_k - x_* \right\Vert_2.\end{split}\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>When <span class="math notranslate nohighlight">\(R_* = 0\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span> in (10.2.4) can be set to zero.
Substituting this into the results of (a) shows that <span class="math notranslate nohighlight">\(\{ x_k \}\)</span> converges
to <span class="math notranslate nohighlight">\(x_*\)</span>.</p>
<p>When <span class="math notranslate nohighlight">\(\mu_k = \mathcal{O}(\left\Vert J_k^\top R_k \right\Vert_2)\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert \left( J_*^\top J_* + \mu_* I \right)^{-1} \right\Vert_2
 &amp;= \left\Vert \left(
      J_*^\top J_* + \mathcal{O}(\left\Vert J_*^\top R_* \right\Vert_2) I
    \right)^{-1} \right\Vert_2\\
 &amp;= \left\Vert \left(
      J_*^\top J_*
    \right)^{-1} \right\Vert_2\\
 &amp;\leq \frac{1}{\lambda}
       &amp; \quad &amp; \text{(a.1)}\end{split}\]</div>
<p>and consequently</p>
<div class="math notranslate nohighlight">
\[\left\Vert
  \left( J_k^\top J_k + \mu_k I \right)^{-1}
\right\Vert_2 \leq \frac{c}{\lambda}
\quad \text{where} \quad
c \in \left( 1, \frac{\lambda}{\sigma} \right)
\text{ for } x_k \in N(x_*, \epsilon_1).\]</div>
<p>Applying the same procedures as in (a) gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert x_{k + 1} - x_* \right\Vert_2
 &amp;\leq \left\Vert \left( J_k^\top J_k + \mu_k I \right)^{-1} \right\Vert_2
       \left[
         \left\Vert J_k^\top R_* \right\Vert_2 +
         \left\Vert J_k^\top \right\Vert_2
           \left\Vert R_* - R_k - J_k (x_* - x_k) \right\Vert_2 +
         \left\Vert \mu_k (x_* - x_k) \right\Vert_2
       \right]\\
 &amp;\leq \frac{c}{\lambda}
       \left[
         \mathcal{O}(\left\Vert J_k^\top R_k \right\Vert_2)
           \left\Vert x_k - x_* \right\Vert_2 +
         \frac{\alpha \gamma}{2} \left\Vert x_k - x_* \right\Vert_2^2
       \right].\end{split}\]</div>
<p>Picking <span class="math notranslate nohighlight">\(\epsilon = \min \{ \epsilon_1, \epsilon_2 \}\)</span> so that (b.1) is
satisfied
(i.e. <span class="math notranslate nohighlight">\(\mathcal{O}(\left\Vert J_k^\top R_k \right\Vert_2) \leq 0\)</span>)
proves that the convergence rate is q-quadratic.</p>
<div class="section" id="(a.1)">
<h4>(a.1)<a class="headerlink" href="#(a.1)" title="Permalink to this headline">¶</a></h4>
<p>Assuming <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> is the smallest eigenvalue of
<span class="math notranslate nohighlight">\(J_*^\top J_*\)</span> i.e. the spectral decomposition exists,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert \left( J_*^\top J_* + \mu_* I \right)^{-1} \right\Vert_2
 &amp;= \left(
      \min_{v \in \mathbb{R}^n \setminus 0}
      \frac{
        \left\Vert (J_*^\top J_* + \mu_* I) v \right\Vert_2
      }{
        \left\Vert v \right\Vert_2
      }
    \right)^{-1}
    &amp; \quad &amp; \text{(3.1.18)}\\
 &amp;\leq \left(
         \min_{v \in \mathbb{R}^n \setminus 0}
         \frac{
           \left\Vert J_*^\top J_* v \right\Vert_2 +
           \mu_* \left\Vert v \right\Vert_2
         }{
           \left\Vert v \right\Vert_2
         }
       \right)^{-1}
       &amp; \quad &amp; \text{(3.1.1c) and (3.1.1b)}\\
 &amp;\leq \left(
         \min_{v \in \mathbb{R}^n \setminus 0}
         \frac{
           \left\Vert J_*^\top J_* v \right\Vert_2
         }{
           \left\Vert v \right\Vert_2
         } + b
       \right)^{-1}
       &amp; \quad &amp; \{ \mu_k \} &lt; b \text{ and } b &gt; 0\\
 &amp;\leq \frac{1}{\lambda + b}
       &amp; \quad &amp; \text{Exercise 3.6}.\end{split}\]</div>
<p>See <a class="reference internal" href="chapter-03.html#dennis1996numerical-ex-3-6"><span class="std std-ref">Exercise 3.6</span></a> for more details on the
last inequality relation.</p>
</div>
<div class="section" id="(b.1)">
<h4>(b.1)<a class="headerlink" href="#(b.1)" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert
  \left( J_*^\top J_* + \mu_* I \right)^{-1}
  \left( J_k^\top J_k + \mu_k I - J_*^\top J_* \right)
\right\Vert_2
 &amp;\leq \left\Vert \left( J_*^\top J_* + \mu_* I \right)^{-1} \right\Vert_2
       \left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2\\
 &amp;\leq \frac{
         \left\Vert J_k^\top J_k + \mu_k I - J_*^\top J_* \right\Vert_2
       }{\lambda}\\
 &amp;\leq \frac{
         \left\Vert J_k^\top J_k - J_*^\top J_* \right\Vert_2 +
         \mathcal{O}(\left\Vert J_k^\top R_k \right\Vert_2)
       }{\lambda}\\
 &amp;\leq 1\end{split}\]</div>
<p>implies that</p>
<div class="math notranslate nohighlight">
\[\mathcal{O}(\left\Vert J_k^\top R_k \right\Vert_2) \leq
\lambda - \left\Vert J_k^\top J_k - J_*^\top J_* \right\Vert_2.\]</div>
</div>
</div>
</div>
<div class="section" id="Exercise-14">
<h2>Exercise 14<a class="headerlink" href="#Exercise-14" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="#dennis1996numerical-ex-10-4"><span class="std std-ref">Exercise 4</span></a> and
<a class="reference internal" href="#dennis1996numerical-ex-10-5"><span class="std std-ref">Exercise 5</span></a> for code.  The suggested
secant method converges slower than (10.3.4) in
<a class="reference internal" href="#dennis1996numerical-ex-10-4"><span class="std std-ref">Exercise 4</span></a> but wins
out in <a class="reference internal" href="#dennis1996numerical-ex-10-5"><span class="std std-ref">Exercise 5</span></a>.</p>
<p>The suggested secant method did not beat Newton’s method in terms of
convergence rate.  (10.3.4) beats Newton’s method when Gauss-Newton dominated.</p>
</div>
<div class="section" id="Exercise-15">
<h2>Exercise 15<a class="headerlink" href="#Exercise-15" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="#dennis1996numerical-ex-10-5"><span class="std std-ref">Exercise 5</span></a> for code.</p>
</div>
<div class="section" id="Exercise-16">
<h2>Exercise 16<a class="headerlink" href="#Exercise-16" title="Permalink to this headline">¶</a></h2>
<p>Define <span class="math notranslate nohighlight">\(S = \{ T T^\top \mid T T^\top \in Q(y_c, s_c) \}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_+ - A_c
 &amp;= \frac{
      (y^\#_c - A_c s_c) {y^\#_c}^\top +
      y^\#_c (y^\#_c - A_c s_c)^\top
    }{
      {y^\#_c}^\top s_c
    } -
    \frac{
      (y^\#_c - A_c s_c)^\top s_c y^\#_c {y^\#_c}^\top
    }{
      ({y^\#_c}^\top s_c)^2
    }
    &amp; \quad &amp; \text{(9.3.4) applied to (10.3.5)}\\
 &amp;= \frac{
      (y^\#_c - A_c s_c) s_c^\top A_+^\top +
      A_+ s_c (y^\#_c - A_c s_c)^\top
    }{
      s_c^\top A_+^\top s_c
    } -
    \frac{
      (A_+ s_c - A_c s_c)^\top s_c A_+ s_c s_c^\top A_+^\top
    }{
      (s_c^\top A_+^\top s_c)^2
    }
    &amp; \quad &amp; A_+ s_c = y^\#_c\\
 &amp;= \frac{
      (y_c^\# - A_c s_c) y_c^\top + y_c (y_c^\# - A_c s_c)^\top
    }{
      y_c^\top s_c
    } -
    \frac{
      (y_c^\# - A_c s_c)^\top s_c y_c y_c^\top
    }{
      (y_c^\top s_c)^2
    }
    &amp; \quad &amp; A_+ \in Q(y^\#_c, s_c) \cap S\end{split}\]</div>
</div>
<div class="section" id="Exercise-17">
<h2>Exercise 17<a class="headerlink" href="#Exercise-17" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>, <span class="math notranslate nohighlight">\(R \in \mathbb{R}^m\)</span>, and
<span class="math notranslate nohighlight">\(J \in \mathbb{R}^{m \times n}\)</span> have full column rank i.e.
<span class="math notranslate nohighlight">\(J^\top J\)</span> is nonsingular.</p>
<p>(a) shows that the solution to the linear least-squares problem (b) is
equivalent to the Euclidean projection of <span class="math notranslate nohighlight">\(R\)</span> onto the linear subspace
spanned by the columns of <span class="math notranslate nohighlight">\(J\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}R^\top J (J^\top J)^{-1} J^\top R
 &amp;= \left\Vert R \right\Vert_2
    \left\Vert J (J^\top J)^{-1} J^\top R \right\Vert_2 \cos(\phi)
    &amp; \quad &amp; \text{definition of dot product}\\
\cos(\phi)
 &amp;= \frac{
      R^\top J (J^\top J)^{-1} J^\top R
    }{
      \left\Vert R \right\Vert_2
      \left\Vert J (J^\top J)^{-1} J^\top R \right\Vert_2
    }\end{split}\]</div>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>The Euclidean projection of a point <span class="math notranslate nohighlight">\(x_0 \in \mathbb{R}^n\)</span> on a set
<span class="math notranslate nohighlight">\(\mathcal{S} \subseteq \mathbb{R}^n\)</span> is a point that achieves the smallest
Euclidean distance from <span class="math notranslate nohighlight">\(x_0\)</span> to the set.  Symbolically this means</p>
<div class="math notranslate nohighlight">
\[\min_{x \in \mathcal{S}} \left\Vert x - x_0 \right\Vert_2.\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Given</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_x \left\Vert Jx - R \right\Vert_2^2
 &amp;= \min_x (Jx - R)^\top (Jx - R)
    &amp; \quad &amp; \text{(3.1.2c)}\\
 &amp;= \min_x x^\top J^\top J x - 2 R^\top J x + R^\top R,\end{split}\]</div>
<p>the minima is</p>
<div class="math notranslate nohighlight">
\[\begin{split}0 &amp;= \frac{\partial}{\partial x}
     \left( x^\top J^\top J x - 2 R^\top J x + R^\top R \right)\\
 &amp;= 2 J^\top J x - 2 J^\top R
    &amp; \quad &amp; \text{Matrix Cookbook (81) and (69)}\\
x &amp;= (J^\top J)^{-1} J^\top R.\end{split}\]</div>
</div>
</div>
<div class="section" id="Exercise-18">
<h2>Exercise 18<a class="headerlink" href="#Exercise-18" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}\)</span>, <span class="math notranslate nohighlight">\(s \in \mathbb{R}^n\)</span>, and
<span class="math notranslate nohighlight">\(M \in \mathbb{R}^{n \times n}\)</span>.
Suppose <span class="math notranslate nohighlight">\(\alpha &gt; 0\)</span> and <span class="math notranslate nohighlight">\(M\)</span> is positive definite i.e.
<span class="math notranslate nohighlight">\(M \triangleq L L^\top\)</span>.</p>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\max_v \phi(v) =
\max_v \frac{\alpha v^\top s}{(v^\top M v)^{1 / 2}}
 &amp;= \max_v \frac{\alpha v^\top s}{\left\Vert L^\top v \right\Vert_2}\\
 &amp;\leq \max_v
         \frac{
           \alpha \left\Vert v \right\Vert_2 \left\Vert s \right\Vert_2
         }{
           \left\Vert L^\top v \right\Vert_2
         }
       &amp; \quad &amp; \text{Cauchy-Schwarz Inequality}\\
 &amp;\leq \alpha \left\Vert s \right\Vert_2 \left\Vert L^{-\top} \right\Vert_2
       &amp; \quad &amp; \text{(3.1.18)}\\
 &amp;\leq \alpha \left\Vert s \right\Vert_2 \left\Vert L^{-\top} \right\Vert_F
       &amp; \quad &amp; \text{(3.1.12)}\end{split}\]</div>
<p>Applying (a.1) shows that the maximum value is
<span class="math notranslate nohighlight">\(\alpha \left( s^\top M^{-1} s \right)^{1 / 2}\)</span>.</p>
<div class="section" id="(a.1)">
<h4>(a.1)<a class="headerlink" href="#(a.1)" title="Permalink to this headline">¶</a></h4>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator{\tr}{tr}
\alpha \left( s^\top M^{-1} s \right)^{1 / 2}
 &amp;= \alpha \left\Vert L^{-1} s \right\Vert_2
    &amp; \quad &amp; \text{(3.1.2c)}\\
 &amp;\leq \alpha \left\Vert L^{-1} \right\Vert_F \left\Vert s \right\Vert_2
       &amp; \quad &amp; \text{(3.1.16)}\\
 &amp;= \alpha \text{tr}(L^{-\top} L^{-1}) \left\Vert s \right\Vert_2
    &amp; \quad &amp; \text{(3.1.14)}\\
 &amp;= \alpha \text{tr}(L^{-1} L^{-\top}) \left\Vert s \right\Vert_2
    &amp; \quad &amp; \tr(AB) = \tr(BA)\\
 &amp;= \alpha \left\Vert L^{-\top} \right\Vert_F \left\Vert s \right\Vert_2\end{split}\]</div>
</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(M = (J^\top J)^{-1}\)</span> and <span class="math notranslate nohighlight">\(s = -M J^\top R\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\max_v \phi(v)
 &amp;\leq \alpha \left( s^\top M^{-1} s \right)^{1 / 2}
       &amp; \quad &amp; \text{(10.5.2) and (a)}\\
 &amp;\leq \alpha \left( R^\top J M^\top J^\top J M J^\top R \right)^{1 / 2}\\
 &amp;\leq \alpha \left\Vert J M J^\top R \right\Vert_2.\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(H \in \mathbb{R}^{n \times n}\)</span> be <span class="math notranslate nohighlight">\(\nabla^2 f(x)\)</span> or an
approximation of it.  If <span class="math notranslate nohighlight">\(M = H^{-1}\)</span> and <span class="math notranslate nohighlight">\(s = -M J^\top R\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}\max_v \phi(v)
 &amp;\leq \alpha \left( s^\top M^{-1} s \right)^{1 / 2}
       &amp; \quad &amp; \text{(10.5.2) and (a)}\\
 &amp;\leq \alpha \left( R^\top J H^{-\top} J^\top R \right)^{1 / 2}.\end{split}\]</div>
<p>It is interesting to note that (10.4.2) can be written in the form of (10.5.2)
where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{gather*}
  M = (J^\top J)^{-1},\\
  s = -M J^\top R,\\
  v = -J^\top R = -\nabla f(x), \text{ and}\\
  \alpha = \left\Vert R \right\Vert_2^{-1}.
\end{gather*}\end{split}\]</div>
<p>Applying the results in (a) shows that (10.5.4) is an upper bound for (10.4.2).</p>
</div>
</div>
<div class="section" id="Exercise-19">
<h2>Exercise 19<a class="headerlink" href="#Exercise-19" title="Permalink to this headline">¶</a></h2>
<p>Define <span class="math notranslate nohighlight">\(R \colon \mathbb{R}^n \mapsto \mathbb{R}^m\)</span> with <span class="math notranslate nohighlight">\(m &gt; n\)</span>.
Let <span class="math notranslate nohighlight">\(x \in \begin{bmatrix} u\\ v \end{bmatrix}\)</span>,
<span class="math notranslate nohighlight">\(u \in \mathbb{R}^{n - p}\)</span>, <span class="math notranslate nohighlight">\(v \in \mathbb{R}^{p}\)</span> with
<span class="math notranslate nohighlight">\(0 &lt; p &lt; n\)</span>, and <span class="math notranslate nohighlight">\(R(x) = N(v) u - b\)</span> where
<span class="math notranslate nohighlight">\(N \colon \mathbb{R}^p \rightarrow \mathbb{R}^{m \times (n - p)}\)</span> and
<span class="math notranslate nohighlight">\(b \in \mathbb{R}^m\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) &amp;= \frac{1}{2} R(x)^\top R(x)\\
 &amp;= \frac{1}{2} (N(v) u - b)^\top (N(v) u - b)\\
 &amp;= \frac{1}{2} \left[
      u^\top N(v)^\top N(v) u - u^\top N(v)^\top b -
      b^\top N(v) u + b^\top b
    \right]\end{split}\]</div>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}0 &amp;= \frac{\partial }{\partial u} f(x)\\
 &amp;= N(v)^\top N(v) u - N(v)^\top b
    &amp; \quad &amp; \text{Matrix Cookbook (81) and (69)}\\
(V D^\top U^\top) (U D V^\top) u
 &amp;= V D^\top U^\top b
    &amp; \quad &amp; \text{Theorem 3.6.4}\\
u &amp;= V D^+ U^\top b
     &amp; \quad &amp; \text{(3.6.6)}\\
 &amp;= N(v)^+ b
    &amp; \quad &amp; \text{Theorem 3.6.5}\end{split}\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\min_x f(x)
 &amp;= \min_v \frac{1}{2} \left(
      b^\top {N(v)^+}^\top N(v)^\top N(v) N(v)^+ b -
      b^\top {N(v)^+}^\top N(v)^\top b - b^\top N(v) N(v)^+ b + b^\top b
    \right)
    &amp; \quad &amp; \text{(a)}\\
 &amp;= \min_v \left\Vert
      N(v) N(v)^+ b - b
    \right\Vert_2^2
    &amp; \quad &amp; \text{(3.1.2c)}\end{split}\]</div>
</div>
</div>
<div class="section" id="Exercise-20">
<h2>Exercise 20<a class="headerlink" href="#Exercise-20" title="Permalink to this headline">¶</a></h2>
<p>The answer to this problem may be located in the section after (3.5) of
<a class="bibtex reference internal" href="#golub1973differentiation" id="id10">[GP73]</a> and in this book’s Chapter 5.  Unfortunately,
my current (2015) knowledge does not allow me to comprehend this 100%; however,
I do feel that it is within my reach to fully dissect this succinct and lucid
paper.  The first item to understand are Frechet derivatives.</p>
<p>Two things I learned from reading this are:</p>
<ul class="simple">
<li><p>The rank of the matrix must be locally constant at the point where the
derivative calculated; otherwise the pseudo-inverse is not a continuous
function.</p></li>
<li><p>Based on the convergence results, the variable projection via modified
Marquardt method should definitely be used when appropriate.</p></li>
</ul>
</div>
<div class="section" id="Exercise-21">
<h2>Exercise 21<a class="headerlink" href="#Exercise-21" title="Permalink to this headline">¶</a></h2>
<p>There are existing Levenberg-Marquardt implementations (e.g. Ceres, Eigen), so a
more interesting venture is to implement the secent approximation.  However,
such a thing is not of immediate interest at the moment.</p>
<p class="rubric">References</p>
<p id="bibtex-bibliography-nb/numerical-methods-for-unconstrained-optimization-and-nonlinear-equations-ds/chapter-10-0"><dl class="citation">
<dt class="bibtex label" id="binegarhodte"><span class="brackets"><a class="fn-backref" href="#id1">Bin</a></span></dt>
<dd><p>Birne Binegar. Higher order derivatives and taylor expansions. <span><a class="reference external" href="#"></a></span>https://math.okstate.edu/people/binegar/4013-U98/4013-l10.pdf. Accessed on 2017-05-31.</p>
</dd>
<dt class="bibtex label" id="follandhodtfsv"><span class="brackets"><a class="fn-backref" href="#id2">Fol</a></span></dt>
<dd><p>G. A. Folland. Higher-order derivatives and taylor’s formula in several variables. <span><a class="reference external" href="#"></a></span>https://sites.math.washington.edu/ folland/Math425/taylor2.pdf. Accessed on 2017-05-31.</p>
</dd>
<dt class="bibtex label" id="golub1973differentiation"><span class="brackets"><a class="fn-backref" href="#id10">GP73</a></span></dt>
<dd><p>Gene H Golub and Victor Pereyra. The differentiation of pseudo-inverses and nonlinear least squares problems whose variables separate. <em>SIAM Journal on numerical analysis</em>, 10(2):413–432, 1973.</p>
</dd>
</dl>
</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/nb/numerical-methods-for-unconstrained-optimization-and-nonlinear-equations-ds/chapter-10.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2013-2020, alphaXomega.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>