<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Secant Methods for Systems of Nonlinear Equations &#8212; All Things Phi</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/my-styles.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../_static/phi.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Secant Methods for Unconstrained Minimization" href="chapter-09.html" />
    <link rel="prev" title="Scaling, Stopping, and Testing" href="chapter-07.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html">
          All Things Phi</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Archive <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/20/mask-r-cnn.html">Mask R-CNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/19/rich-feature-hierarchies-for-accurate-object-detection-and-semantic-segmentation.html">Rich Feature Hierarchies for Accurate Object Detection and Semantic Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/18/watertight-ray-triangle-intersection.html">Watertight Ray/Triangle Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/17/understanding-deep-learning-requires-rethinking-generalization.html">Understanding Deep Learning Requires Rethinking Generalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/16/accurate-large-minibatch-sgd-training-imagenet-in-1-hour.html">Accurate, Large Minibatch SGD: Training ImageNet in 1 Hour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/15/on-large-batch-training-for-deep-learning-generalization-gap-and-sharp-minima.html">On Large-Batch Training for Deep Learning: Generalization Gap and Sharp Minima</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/14/layer-normalization.html">Layer Normalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/13/batch-normalization-accelerating-deep-network-training-by-reducing-internal-covariate-shift.html">Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/12/deep-residual-learning-for-image-recognition.html">Deep Residual Learning for Image Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/11/optimal-step-nonrigid-icp-algorithms-for-surface-registration.html">Optimal Step Nonrigid ICP Algorithms for Surface Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/10/delving-deep-into-rectifiers-surpassing-human-level-performance-on-imagenet-classification.html">Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/09/least-squares-estimation-of-transformation-parameters-between-two-point-patterns.html">Least-Squares Estimation of Transformation Parameters Between Two Point Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/08/a-fast-learning-algorithm-for-deep-belief-nets.html">A Fast Learning Algorithm for Deep Belief Nets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/07/a-view-of-the-EM-algorithm-that-justifies-incremental-sparse-and-other-variants.html">A View of the EM Algorithm that Justifies Incremental, Sparse, and Other Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/06/one-weird-trick-for-parallelizing-convolutional-neural-networks.html">One Weird Trick for Parallelizing Convolutional Neural Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/05/exponential-family-harmoniums-with-an-application-to-information-retrieval.html">Exponential Family Harmoniums with an Application to Information Retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/04/pose-space-deformation-a-unified-approach-to-shape-interpolation-and-skeleton-driven-deformation.html">Pose Space Deformation: A Unified Approach to Shape Interpolation and Skeleton-Driven Deformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/02/learning-internal-representations-by-error-propagation.html">Learning Internal Representations by Error Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/12/01/structuring-a-renderer-phi-ray.html">Structuring a Renderer: <span class="math notranslate nohighlight">\(\varphi\)</span>-Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/30/information-processing-in-dynamical-systems-foundations-of-harmony-theory.html">Information Processing in Dynamical Systems: Foundations of Harmony Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/29/an-introduction-to-the-conjugate-gradient-method-without-the-agonizing-pain.html">An Introduction to the Conjugate Gradient Method Without the Agonizing Pain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/28/a-learning-algorithm-for-boltzmann-machines.html">A Learning Algorithm for Boltzmann Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/27/geometric-skinning-with-approximate-dual-quaternion-blending.html">Geometric Skinning with Approximate Dual Quaternion Blending</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/26/the-perceptron-a-probabilistic-model-for-information-storage-and-organization-in-the-brain.html">The Perceptron: A Probabilistic Model for Information Storage and Organization in the Brain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/25/the-sharpe-ratio.html">The Sharpe Ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/24/neural-networks-and-physical-systems-with-emergent-collective-computational-abilities.html">Neural Networks and Physical Systems with Emergent Collective Computational Abilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/23/training-products-of-experts-by-minimizing-contrastive-divergence.html">Training Products of Experts by Minimizing Contrastive Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/22/market-timing-with-candlestick-technical-analysis.html">Market Timing with Candlestick Technical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/21/all-that-glitters-is-not-gold-comparing-backtest-and-out-of-sample-performance-on-a-large-cohort-of-trading-algorithms.html">All that Glitters is Not Gold: Comparing Backtest and Out-of-Sample Performance on a Large Cohort of Trading Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/20/easy-volatility-investing.html">Easy Volatility Investing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/19/a-tutorial-on-helmholtz-machines.html">A Tutorial on Helmholtz Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/18/when-do-stop-loss-rules-stop-losses.html">When Do Stop-Loss Rules Stop Losses?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/17/a-simple-implicit-measure-of-the-effective-bid-ask-spread-in-an-efficient-market.html">A Simple Implicit Measure of the Effective Bid-Ask Spread in an Efficient Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/16/asset-prices-and-trading-volume-under-fixed-transactions-costs.html">Asset Prices and Trading Volume Under Fixed Transactions Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/15/maxout-networks.html">Maxout Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/14/dropout-a-simple-way-to-prevent-neural-networks-from-overfitting.html">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/13/dropout-training-as-adaptive-regularization.html">Dropout Training as Adaptive Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/12/model-compression.html">Model Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/11/distilling-the-knowledge-in-a-neural-network.html">Distilling the Knowledge in a Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/10/do-deep-nets-really-need-to-be-deep.html">Do Deep Nets Really Need to be Deep?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/09/efficient-backprop.html">Efficient Backprop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/08/stochastic-gradient-descent-tricks.html">Stochastic Gradient Descent Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/07/automatic-differentiation-in-machine-learning-a-survey.html">Automatic Differentiation in Machine Learning: A Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/06/econometric-models-of-limit-order-executions.html">Econometric Models of Limit-Order Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/05/multilayer-feedforward-networks-are-universal-approximators.html">Multilayer Feedforward Networks are Universal Approximators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/04/dendritic-computation.html">Dendritic Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/03/understanding-order-flow.html">Understanding Order Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/02/optimal-control-of-execution-costs.html">Optimal Control of Execution Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/11/01/risks-and-portfolio-decisions-involving-hedge-funds.html">Risks and Portfolio Decisions Involving Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/30/coordinate-systems.html">Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/28/hedge-funds-the-living-and-the-dead.html">Hedge Funds: The Living and the Dead</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/24/do-hedge-funds-have-enough-capital-a-value-at-risk-approach.html">Do Hedge Funds Have Enough Capital?  A Value-at-Risk Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/23/characterizing-computer-performance-with-a-single-number.html">Characterizing Computer Performance with a Single Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/22/how-to-not-lie-with-statistics-the-correct-way-to-summarize-benchmark-results.html">How Not to Lie with Statistics: The Correct Way to Summarize Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/19/an-econometric-analysis-of-serial-correlation-and-illiquidity-in-hedge-fund-returns.html">An Econometric Analysis of Serial Correlation and Illiquidity in Hedge-Fund Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/13/empirical-characteristics-of-dynamic-trading-strategies-the-case-of-hedge-funds.html">Empirical Characteristics of Dynamic Trading Strategies: The Case of Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/06/orange-juice-and-weath.html">Orange Juice and Weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/04/the-adaptive-markets-hypothesis-market-efficiency-from-an-evolutionary-perspective.html">The Adaptive Markets Hypothesis: Market Efficiency from an Evolutionary Perspective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/10/02/do-asset-prices-reflect-fundamentals-freshly-squeezed-evidence-from-the-oj-market.html">Do Asset Prices Reflect Fundamentals?  Freshly Squeezed Evidence from the OJ Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/30/neuroeconomics-how-neuroscience-can-inform-economics.html">Neuroeconomics: How Neuroscience Can Inform Economics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/28/drawing-inferences-from-statistics-based-on-multiyear-asset-returns.html">Drawing Inferences from Statistics based on Multiyear Asset Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/26/when-are-contrarian-profits-due-to-stock-market-overreaction.html">When are Contrarian Profits Due to Stock Market Overreaction?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/24/profitability-of-momentum-strategies-an-evaluation-of-alternative-explanations.html">Profitability of Momentum Strategies: An Evaluation of Alternative Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/22/the-restrictions-on-predictability-implied-by-rational-asset-pricing.html">The Restrictions on Predictability Implied by Rational Asset Pricing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/20/the-myth-of-long-horizon-predictability.html">The Myth of Long-Horizon Predictability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/18/the-standard-error-of-regressions.html">The Standard Error of Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/16/lets-take-the-con-out-of-econometrics.html">Let’s Take the Con Out of Econometrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/14/role-of-models-in-statistical-analysis.html">Role of Models in Statistical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/09/12/the-experimental-generation-of-interpersonal-closeness-a-procedure-and-some-preliminary-findings.html">The Experimental Generation of Interpersonal Closeness: A Procedure and Some Preliminary Findings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/08/02/notes-on-tensorflow.html">Notes on TensorFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/08/01/tensorflow-tensorboard-and-docker.html">TensorFlow, TensorBoard, and Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/13/review-and-analysis-of-solutions-of-the-three-point-perspective-pose-estimation-problem.html">Review and Analysis of Solutions of the Three Point Perspective Pose Estimation Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/12/variational-learning-for-switching-state-space-models.html">Variational Learning for Switching State-Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/11/bayesian-face-recognition.html">Bayesian Face Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/10/robust-generative-subspace-modeling-the-subspace-t-distribution.html">Robust Generative Subspace Modeling: The Subspace <span class="math notranslate nohighlight">\(t\)</span> Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/09/robust-subspace-mixture-models-using-t-distributions.html">Robust Subspace Mixture Models using <span class="math notranslate nohighlight">\(t\)</span>-distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/08/robust-mixture-modelling-using-the-t-distribution.html">Robust Mixture Modelling using the <span class="math notranslate nohighlight">\(t\)</span>-distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/07/mixtures-of-probabilistic-principal-component-analyzers.html">Mixtures of Probabilistic Principal Component Analysers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/06/the-em-algorithm-for-mixtures-of-factor-analyzers.html">The EM Algorithm for Mixtures of Factor Analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/05/3d-live-real-time-captured-content-for-mixed-reality.html">3D Live: Real Time Captured Content for Mixed Reality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/04/high-accuracy-stereo-depth-maps-using-structured-light.html">High-Accuracy Stereo Depth Maps Using Structured Light</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/03/simple-accurate-and-robust-projector-camera-calibration.html">Simple, Accurate, and Robust Projector-Camera Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/02/multiresolution-gray-scale-and-rotation-invariant-texture-classification-with-local-binary-patterns.html">Multiresolution Gray Scale and Rotation Invariant Texture Classification with Local Binary Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2016/01/01/generative-or-discriminative-getting-the-best-of-both-worlds.html">Generative or Discriminative?  Getting the Best of Both Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/02/01/seda-an-architecture-for-well-conditioned,-scalable-internet-services.html">SEDA: An Architecture for Well-Conditioned, Scalable Internet Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/26/reconciling-environment-integration-and-component-independence.html">Reconciling Environment Integration and Component Independence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/25/design-patterns-abstraction-and-reuse-of-object-oriented-design.html">Design Patterns: Abstraction and Reuse of Object-Oriented Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/24/a-guide-to-metaphorical-design.html">A Guide to Metaphorical Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/23/a-spiral-model-of-software-development-and-enhancement.html">A Spiral Model of Software Development and Enhancement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/22/sequential-and-concurrent-object-oriented-programming.html">Sequential and Concurrent Object-Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/21/software-aging.html">Software Aging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/20/applying-design-by-contract.html">Applying “Design by Contract”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/19/predicate-logic-for-software-engineering.html">Predicate Logic for Software Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/18/active-design-reviews-principles-and-practices.html">Active Design Reviews: Principles and Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/17/a-rational-design-process-how-and-why-to-fake-it.html">A Rational Design Process: How and Why to Fake It</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/16/the-modular-structure-of-complex-systems.html">The Modular Structure of Complex Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/15/abstract-types-defined-as-classes-of-variables.html">Abstract Types Defined as Classes of Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/14/use-of-abstract-interfaces-in-the-development-of-software-for-embedded-computer-systems.html">Use of Abstract Interfaces in the Development of Software for Embedded Computer Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/13/the-influence-of-software-structure-on-reliability.html">The Influence of Software Structure on Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/12/response-to-detected-errors-in-well-structured-programs.html">Response to Detected Errors in Well-Structured Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/11/the-use-of-abstract-data-types-to-simplify-program-modifications.html">The Use of Abstract Data Types to Simplify Program Modifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/10/use-of-the-concept-of-transparency-in-the-design-of-hierarchically-structured-systems.html">Use of the Concept of Transparency in the Design of Hierarchically Structured Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/09/designing-software-for-ease-of-extension-and-contraction.html">Designing Software for Ease of Extension and Contraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/08/on-the-design-and-development-of-program-families.html">On the Design and Development of Program Families</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/07/on-the-criteria-to-be-used-in-decomposing-systems-into-modules.html">On the Criteria to be Used in Decomposing Systems into Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/06/a-technique-for-software-module-specification-with-examples.html">A Technique for Software Module Specification with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/05/information-distribution-aspects-of-design-methodology.html">Information Distribution Aspects of Design Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/04/a-model-of-large-program-development.html">A Model of Large Program Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/03/architectural-styles-and-the-design-of-network-based-software-architectures.html">Architectural Styles and the Design of Network-based Software Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/02/design-of-design.html">Design of Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2014/01/01/notes-on-the-synthesis-of-form.html">Notes on the Synthesis of Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/27/sphinx-on-github-pages.html">Sphinx on GitHub Pages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/26/blogging-with-docker.html">Blogging with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/25/typical-mercurial-usage.html">Typical Mercurial Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/24/profiling-on-linux.html">Profiling on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/23/trading-cryptocurrencies.html">Trading Cryptocurrencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/22/notes-on-software-design.html">Notes on Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/21/notes-on-scraping-together-a-heterogeneous-system.html">Notes on Scraping Together a Heterogeneous System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/20/transfer-media-files-to-mobile-device-via-vlc.html">Transfer Media Files to Mobile Device via VLC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/19/style-lessons-in-clarity-and-grace.html">Style: Lessons in Clarity and Grace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/18/the-science-of-scientific-writing.html">The Science of Scientific Writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/17/collection-of-notes-on-research.html">Collection of Notes on Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/16/typical-ffmpeg-usage.html">Typical FFmpeg Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/15/generate-svg-graphics.html">Generate SVG Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/14/blogging-with-restructuredtext-a-google-domain-and-sphinx.html">Blogging with RestructuredText, a Google Domain, and Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/13/set-up-android-development-environment.html">Set Up Android Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/12/svegan-lifestyle.html">Svegan Lifestyle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/11/set-up-system-programming-environment.html">Set Up System Programming Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/10/the-rise-and-fall-of-react-flux-redux-and-cycle.html">The Rise and Fall of React, Flux, Redux, and Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/09/install-graphics-and-compute-linux-mint.html">Install Graphics and Compute on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/08/set-up-web-development-environment.html">Set Up Web Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/07/vfio-tips-and-tricks.html">VFIO Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/06/options-trading.html">Options Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/05/assimp-mesh-loader.html">Assimp Mesh Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/04/set-up-data-analysis-environment.html">Set Up Data Analysis Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/03/install-nvidia-drivers-on-linux-mint.html">Install Nvidia Drivers on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/02/blogging-with-restructuredtext-a-google-domain-and-pelican.html">Blogging with RestructuredText, a Google Domain, and Pelican</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../blog/2013/01/01/linux-mint-installation.html">Linux Mint Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../an-invitation-to-3d-vision-msks/index.html">An Invitation to 3-D Vision - Ma, Soatto, Kosecka, and Sastry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complete-musician-laitz/index.html">The Complete Musician: An Integrated Approach to Tonal Theory, Analysis, and Listening - Laitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer-science-theory-for-the-information-age-hk/index.html">Computer Science Theory for the Information Age - Hopcroft &amp; Kannan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../computer-vision-models-learning-and-inference-prince/index.html">Computer Vision: Models, Learning, and Inference - Prince</a></li>
<li class="toctree-l1"><a class="reference internal" href="../creativity-nlph/index.html">Creativity - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../differential-geometry-from-a-graphics-perspective-nlph/index.html">Differential Geometry from a Graphics Perspective - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fundamentals-of-electric-circuits-as/index.html">Fundamentals of Electric Circuits - Alexander &amp; Sadiku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linear-programming-vanderbei/index.html">Linear Programming - Vanderbei</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multiple-view-geometry-hz/index.html">Multiple View Geometry in Computer Vision - Hartley &amp; Zisserman</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Numerical Methods for Unconstrained Optimization and Nonlinear Equations - Dennis &amp; Schnabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pattern-recognition-and-machine-learning-bishop/index.html">Pattern Recognition and Machine Learning - Bishop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reinforcement-learning-sb/index.html">Reinforcement Learning: An Introduction - Sutton &amp; Barto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stat-labs-ns/index.html">Stat Labs - Nolan &amp; Speed</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Secant Methods for Systems of Nonlinear Equations</a><ul>
<li><a class="reference internal" href="#Exercise-1">Exercise 1</a></li>
<li><a class="reference internal" href="#Exercise-2">Exercise 2</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
<li><a class="reference internal" href="#(c)">(c)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-3">Exercise 3</a></li>
<li><a class="reference internal" href="#Exercise-4">Exercise 4</a></li>
<li><a class="reference internal" href="#Exercise-5">Exercise 5</a></li>
<li><a class="reference internal" href="#Exercise-6">Exercise 6</a></li>
<li><a class="reference internal" href="#Exercise-7">Exercise 7</a></li>
<li><a class="reference internal" href="#Exercise-8">Exercise 8</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-9">Exercise 9</a></li>
<li><a class="reference internal" href="#Exercise-10">Exercise 10</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-11">Exercise 11</a></li>
<li><a class="reference internal" href="#Exercise-12">Exercise 12</a></li>
<li><a class="reference internal" href="#Exercise-13">Exercise 13</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-14">Exercise 14</a></li>
<li><a class="reference internal" href="#Exercise-15">Exercise 15</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-16">Exercise 16</a></li>
<li><a class="reference internal" href="#Exercise-17">Exercise 17</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
<li><a class="reference internal" href="#(b.1)">(b.1)</a></li>
<li><a class="reference internal" href="#(b.2)">(b.2)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Exercise-18">Exercise 18</a><ul>
<li><a class="reference internal" href="#(a)">(a)</a></li>
<li><a class="reference internal" href="#(b)">(b)</a></li>
<li><a class="reference internal" href="#(b.1)">(b.1)</a></li>
<li><a class="reference internal" href="#(b.1.1)">(b.1.1)</a></li>
<li><a class="reference internal" href="#(b.2)">(b.2)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="chapter-07.html" title="Previous Chapter: Scaling, Stopping, and Testing"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Scaling, Stop...</span>
    </a>
  </li>
  <li>
    <a href="chapter-09.html" title="Next Chapter: Secant Methods for Unconstrained Minimization"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Secant Method... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Secant-Methods-for-Systems-of-Nonlinear-Equations">
<h1>Secant Methods for Systems of Nonlinear Equations<a class="headerlink" href="#Secant-Methods-for-Systems-of-Nonlinear-Equations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Exercise-1">
<h2>Exercise 1<a class="headerlink" href="#Exercise-1" title="Permalink to this headline">¶</a></h2>
<p>Given <span class="math notranslate nohighlight">\(s_i, y_i \in \mathbb{R}^n\)</span> for <span class="math notranslate nohighlight">\(i = 1, \ldots, n\)</span> where
<span class="math notranslate nohighlight">\(s_i\)</span> are linearly independent, <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> can
be uniquely determined using the secant equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
  A_{1,1} &amp; \cdots &amp; A_{1, n}\\
  \vdots &amp; \ddots &amp; \vdots\\
  A_{n,1} &amp; \cdots &amp; A_{n, n}
\end{bmatrix}
\begin{bmatrix}
  s_1 &amp; \cdots &amp; s_n
\end{bmatrix}
 &amp;= \begin{bmatrix} y_1 &amp; \cdots &amp; y_n \end{bmatrix}\\
A S &amp;= Y\\
A &amp;= Y S^{-1}.\end{split}\]</div>
<p>This is a bad way to form the model because it only works when <span class="math notranslate nohighlight">\(S\)</span> is
invertible i.e. the columns of <span class="math notranslate nohighlight">\(S\)</span> are linearly independent.</p>
</div>
<div class="section" id="Exercise-2">
<h2>Exercise 2<a class="headerlink" href="#Exercise-2" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(A = \begin{bmatrix} 4 &amp; 1\\ -1 &amp; 1 \end{bmatrix}\)</span>,
<span class="math notranslate nohighlight">\(s = \begin{bmatrix} 1\\ 0 \end{bmatrix}\)</span>, and
<span class="math notranslate nohighlight">\(y = \begin{bmatrix} 5\\ -2 \end{bmatrix}\)</span>.</p>
<p>One way to solve this is to invoke Lemma 8.1.1 since its assumptions are
satisfied.  The following derivations does not use that lemma.</p>
<p>Given <span class="math notranslate nohighlight">\(M \in Q(y, s)\)</span>, its form must be
<span class="math notranslate nohighlight">\(\begin{bmatrix} 5 &amp; a\\ -2 &amp; b\end{bmatrix}\)</span> where
<span class="math notranslate nohighlight">\(a, b \in \mathbb{R}\)</span>.  The minimization problem becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\min_{M \in Q(y, s)} \left\Vert M - A \right\Vert =
\min_{a, b} \left\Vert
  \begin{bmatrix} 1 &amp; a - 1\\ -1 &amp; b - 1 \end{bmatrix}
\right\Vert.\end{split}\]</div>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>Minimizing over the <span class="math notranslate nohighlight">\(l_2\)</span> operator norm (3.1.8b) gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert M - A \right\Vert_2
 &amp;= \max_{\sqrt{\lambda}}
    \begin{bmatrix} 2 &amp; a - b\\ a - b &amp; (a - 1)^2 + (b - 1)^2 \end{bmatrix}\\
 &amp;= \max_{\lambda} \left\{
      \frac{a^2}{2} - a + \frac{b^2}{2} - b + 2 \pm \frac{1}{2}
      \sqrt{\left( a^2 + b^2 \right) \left( a^2 - 4a + b^2 - 4b + 8 \right)}
    \right\}^{1/2}\\
 &amp;= \left(
      \frac{a^2}{2} - a + \frac{b^2}{2} - b + 2 + \frac{1}{2}
      \sqrt{\left( a^2 + b^2 \right) \left( a^2 - 4a + b^2 - 4b + 8 \right)}
    \right)^{1/2}\\
 &amp;= \frac{1}{\sqrt{2}} \left(
      (a - 1)^2 + (b - 1)^2 + 2 +
      \sqrt{a^2 + b^2} \sqrt{(a - 2)^2 + (b - 2)^2}
    \right)^{1/2}\\
 &amp;= \frac{1}{\sqrt{2}} \left(
      2 (\beta - 1)^2 + 2 + 2 \sqrt{\beta^2 \left( \beta - 2 \right)^2}
    \right)^{1/2} \qquad
    &amp; \quad &amp; a = b = \beta\\
 &amp;= \left(
      (\beta - 1)^2 + 1 + \sqrt{\beta^2 \left( \beta - 2 \right)^2}
    \right)^{1/2}.\end{split}\]</div>
<p>Plotting the last equation shows that the function is at a global minimum
<span class="math notranslate nohighlight">\(\sqrt{2}\)</span> when <span class="math notranslate nohighlight">\(\beta \in [0, 2]\)</span>.</p>
<p>Replacing <span class="math notranslate nohighlight">\(M\)</span> with
<span class="math notranslate nohighlight">\(A_+ = A + \begin{bmatrix} 1 &amp; \alpha\\ -1 &amp; \alpha \end{bmatrix}\)</span> yields</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert A_+ - A \right\Vert_2
 &amp;= \max_{\sqrt{\lambda}}
      \begin{bmatrix} 2 &amp; 0\\ 0 &amp; 2 \alpha^2 \end{bmatrix}\\
 &amp;= \max_{\lambda} \left\{
      \alpha^2 + 1 \pm \sqrt{(\alpha - 1)^2 (\alpha + 1)^2}
    \right\}^{1/2}\\
 &amp;= \left(
      \alpha^2 + 1 + \sqrt{(\alpha - 1)^2 (\alpha + 1)^2}
    \right)^{1/2}\\
 &amp;= \left(
      (\alpha - 1) (\alpha + 1) + 2 + \sqrt{(\alpha - 1)^2 (\alpha + 1)^2}
    \right)^{1/2}.\end{split}\]</div>
<p>Plotting the last equation shows that the function is at a global minimum
<span class="math notranslate nohighlight">\(\sqrt{2}\)</span> when <span class="math notranslate nohighlight">\(\alpha \in [-1, 1]\)</span>.</p>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Minimizing over the Frobenius matrix norm (3.1.6) yields</p>
<div class="math notranslate nohighlight">
\[\left\Vert M - A \right\Vert_F =
\sqrt{1^2 + (a - 1)^2 + (b - 1)^2 + (-1)^2}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\left\Vert A_+ - A \right\Vert_F = \sqrt{1^2 + 2 \alpha^2 + (-1)^2}\]</div>
<p>with both achieving a global minimum <span class="math notranslate nohighlight">\(\sqrt{2}\)</span> when <span class="math notranslate nohighlight">\(a = b = 1\)</span> and
<span class="math notranslate nohighlight">\(\alpha = 0\)</span> respectively.</p>
</div>
<div class="section" id="(c)">
<h3>(c)<a class="headerlink" href="#(c)" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(F(x)\)</span> is linear in <span class="math notranslate nohighlight">\(x_2\)</span>, then the Frobenius matrix norm should
be used because there is a single minimum which serves to isolate the changes
in <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
</div>
</div>
<div class="section" id="Exercise-3">
<h2>Exercise 3<a class="headerlink" href="#Exercise-3" title="Permalink to this headline">¶</a></h2>
<p>Even though Broyden’s method converges to a root, the relative error with
respect to <span class="math notranslate nohighlight">\(\frac{\partial f_2}{\partial x_1}\)</span> is huge; the others are
within <span class="math notranslate nohighlight">\([0.0, 0.5]\)</span> with <span class="math notranslate nohighlight">\(0.0\)</span> applicable only to the linear
function <span class="math notranslate nohighlight">\(f_1\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">def</span> <span class="nf">broydens_update</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span><span class="p">):</span>
    <span class="n">s_k</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_k</span><span class="p">,</span> <span class="o">-</span><span class="n">F</span><span class="p">(</span><span class="n">x_k</span><span class="p">))</span>
    <span class="n">x_next</span> <span class="o">=</span> <span class="n">x_k</span> <span class="o">+</span> <span class="n">s_k</span>
    <span class="n">y_k</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">x_next</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>
    <span class="n">A_next</span> <span class="o">=</span> <span class="n">A_k</span> <span class="o">+</span> <span class="p">(</span><span class="n">y_k</span> <span class="o">-</span> <span class="n">A_k</span> <span class="o">*</span> <span class="n">s_k</span><span class="p">)</span> <span class="o">*</span> <span class="n">s_k</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_k</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">s_k</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A_next</span><span class="p">,</span> <span class="n">x_next</span>

<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">],</span>
                           <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">9</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]])</span>

<span class="n">macheps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="n">x_k</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">]])</span>
<span class="n">A_k</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">broydens_update</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;L2-Norm(x_{} - x_{}): {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">norm</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">&lt;=</span> <span class="n">macheps</span><span class="p">:</span>
        <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>
        <span class="k">break</span>
    <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x_k: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;A_k:</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A_k</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;J(x_k):</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L2-Norm(x_1 - x_0): 4.47213595499958
L2-Norm(x_2 - x_1): 2.357022603955159
L2-Norm(x_3 - x_2): 0.29462782549439437
L2-Norm(x_4 - x_3): 0.15973797767768386
L2-Norm(x_5 - x_4): 0.016359786480031936
L2-Norm(x_6 - x_5): 0.0006762158471433808
L2-Norm(x_7 - x_6): 2.714857331443653e-06
L2-Norm(x_8 - x_7): 4.344464330780998e-10

x_k: [5.32388602e-17 3.00000000e+00]

A_k:
[[1.         1.        ]
 [2.99999808 9.00000192]]

J(x_k):
[[1.0000000e+00 1.0000000e+00]
 [1.0647772e-16 6.0000000e+00]]
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-4">
<h2>Exercise 4<a class="headerlink" href="#Exercise-4" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(F \colon \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span> for which
<span class="math notranslate nohighlight">\(f_1, \ldots, f_m\)</span> are linear with <span class="math notranslate nohighlight">\(m &lt; n\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(A_0 = J(x_0)\)</span> where <span class="math notranslate nohighlight">\(x_0 \in \mathbb{R}^n\)</span>.  As illustrated in
(2.2.1), the extension of the local affine approximation to higher dimensions
(5.1.1) will be exact for <span class="math notranslate nohighlight">\(f_1, \ldots, f_m\)</span> such that</p>
<div class="math notranslate nohighlight">
\[f_1(x_1) = \cdots = f_m(x_1) = 0
\quad \text{where} \quad
x_1 = x_0 + s_0
\quad \text{with} \quad
s_0 = -A_0^{-1} F(x_0) = -J_0^{-1}(x_0) F(x_0).\]</div>
<p>The next step in Broyden’s method computes</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_1 &amp;= A_0 + \frac{y_0 - A_0 s_0}{s_0^\top s_0} s_0^\top\\
 &amp;= J(x_0) + \frac{F(x_1)}{s_0^\top s_0} s_0^\top
    &amp; \quad &amp; y_0 = F(x_1) - F(x_0) \text{ and } A_0 s_0 = -F(x_0).\end{split}\]</div>
<p>By inspection, the first <span class="math notranslate nohighlight">\(m\)</span> rows of the outer product
<span class="math notranslate nohighlight">\(F(x_1) s_0^\top\)</span> contains only zeros such that
<span class="math notranslate nohighlight">\((A_1)_i = (A_0)_i = J(x_0)_i\)</span> for <span class="math notranslate nohighlight">\(i = 1, \ldots, m\)</span>.</p>
<p>An equivalent view of Newton’s method is</p>
<div class="math notranslate nohighlight">
\[(M_c)_i(x_c + s) = f_i(x_c) + \nabla f_i(x_c)^\top s\]</div>
<p>where <span class="math notranslate nohighlight">\(M_c\)</span> denotes the current model.  From the intuition of the method
in lower dimensions, it is clear that</p>
<div class="math notranslate nohighlight">
\[f_1(x_k) = \cdots = f_m(x_k) = 0 \text{ for } k \geq 1\]</div>
<p>and consequently</p>
<div class="math notranslate nohighlight">
\[(A_k)_i = (A_0)_i \text{ for } k \geq 0 \text{ and } i = 1, \ldots, m.\]</div>
<p>For the finite difference case, Theorem 5.4.1 states that the
<span class="math notranslate nohighlight">\(i^\text{th}\)</span> component has an error of <span class="math notranslate nohighlight">\(\mathcal{O}(h_i)\)</span> when
using forward differencing (5.6.5) and <span class="math notranslate nohighlight">\(\mathcal{O}(h_i^2)\)</span> when using
central differencing (5.6.6).</p>
</div>
<div class="section" id="Exercise-5">
<span id="dennis1996numerical-ex-8-5"></span><h2>Exercise 5<a class="headerlink" href="#Exercise-5" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(F(x) = Jx + b\)</span> where <span class="math notranslate nohighlight">\(J \in \mathbb{R}^{n \times n}\)</span>,
<span class="math notranslate nohighlight">\(b \in \mathbb{R}^n\)</span>, and <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>.</p>
<p>The proof is by contradiction.  Assume <span class="math notranslate nohighlight">\(x_+, x_c \in \mathbb{R}^n\)</span> and
<span class="math notranslate nohighlight">\(x_+ \neq x_c\)</span> with</p>
<div class="math notranslate nohighlight">
\[\begin{split}s_c &amp;= x_+ - x_c,\\\\
y_c &amp;= F(x_+) - F(x_c),\\\\
J \not\in Q(y_c, s_c)
 &amp;= \left\{ B \in \mathbb{R}^{n \times n} \mid Bs = y \right\}.\end{split}\]</div>
<p>Consequently, the following must hold</p>
<div class="math notranslate nohighlight">
\[\begin{split}y_c &amp;= F(x_+) - F(x_c)\\
 &amp;= J x_+ + b - J x_c - b\\
 &amp;= J (x_+ - x_c)\\
 &amp;= J s_c,\end{split}\]</div>
<p>but this contradicts the initial assumptions.  Thus <span class="math notranslate nohighlight">\(J \in Q(y_c, s_c)\)</span>.</p>
</div>
<div class="section" id="Exercise-6">
<h2>Exercise 6<a class="headerlink" href="#Exercise-6" title="Permalink to this headline">¶</a></h2>
<p>Let the assumptions of Lemma 8.2.1 be satisfied and define</p>
<div class="math notranslate nohighlight">
\[\begin{split}J_+ &amp;\triangleq J(x_+),\\\\
F_+ &amp;\triangleq F(x_+),\\\\
F_c &amp;\triangleq F(x_c),\\\\
s_c &amp;= x_+ - x_c,\\\\
y_c &amp;= F_+ - F_c.\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}A_+ &amp;= A_c + \frac{\left( y_c - A_c s_c \right) s_c^\top}{s_c^\top s_c}
       &amp; \quad &amp; \text{(8.1.5)}\\
A_+ - J_+
 &amp;= A_c - J_+ + \frac{\left( y_c - A_c s_c \right) s_c^\top}{s_c^\top s_c}\\
 &amp;= \left( A_c - J_+ \right)
      \left[ I - \frac{s_c s_c^\top}{s_c^\top s_c} \right] +
    \frac{\left( y_c - J_+ s_c \right) s_c^\top}{s_c^\top s_c}
    &amp; \quad &amp; \text{(8.2.4)}\\
\left\Vert A_+ - J_+ \right\Vert
 &amp;= \left\Vert
      \left( A_c - J_+ \right)
        \left[ I - \frac{s_c s_c^\top}{s_c^\top s_c} \right] +
      \frac{\left( y_c - J_+ s_c \right) s_c^\top}{s_c^\top s_c}
    \right\Vert\\
 &amp;\leq \left\Vert
         \left( A_c - J_+ \right)
           \left[ I - \frac{s_c s_c^\top}{s_c^\top s_c} \right]
       \right\Vert +
       \left\Vert
         \frac{\left( y_c - J_+ s_c \right) s_c^\top}{s_c^\top s_c}
       \right\Vert
       &amp; \quad &amp; \text{(3.1.1c)}\\
 &amp;\leq \left\Vert A_c - J_+ \right\Vert
         \left\Vert I - \frac{s_c s_c^\top}{s_c^\top s_c} \right\Vert_2 +
       \left\Vert
         \frac{\left( y_c - J_+ s_c \right) s_c^\top}{s_c^\top s_c}
       \right\Vert
       &amp; \quad &amp; \text{(3.1.10) and (3.1.15)}\\
 &amp;\leq \left\Vert A_c - J_c + J_c - J_+ \right\Vert +
       \left\Vert y_c - J_+ s_c \right\Vert_2
         \left\Vert \frac{s_c}{s_c^\top s_c} \right\Vert_2
       &amp; \quad &amp; \text{(3.1.17)}\\
 &amp;\leq \left\Vert A_c - J_c \right\Vert + \left\Vert J_c - J_+ \right\Vert +
       \left\Vert F_+ - F_c - J_+ s_c \right\Vert_2
         \left\Vert s_c \right\Vert_2^{-1}
       &amp; \quad &amp; \text{(3.1.1c) and (3.1.2c)}\\
 &amp;\leq \left\Vert A_c - J_c \right\Vert +
       \gamma \left\Vert x_c - x_+ \right\Vert +
       \frac{\gamma}{2} \left(
         \left\Vert x_+ - x_+ \right\Vert_2 +
         \left\Vert x_c - x_+ \right\Vert_2
       \right)
         \left\Vert s_c \right\Vert_2
         \left\Vert s_c \right\Vert_2^{-1}
       &amp; \quad &amp; J(x) \in \text{Lip}_\gamma(D) \text{ and Lemma 4.1.15}\\
 &amp;\leq \left\Vert A_c - J_c \right\Vert +
       \frac{3 \gamma}{2} \left\Vert x_+ - x_c \right\Vert_2
       &amp; \quad &amp; \text{(3.1.1c), (3.1.2c), and (3.1.6).}\end{split}\]</div>
<p>For a proof of (3.1.1c), see <a class="reference internal" href="chapter-03.html#dennis1996numerical-ex-3-4"><span class="std std-ref">Exercise 3.4</span></a>.
<a class="reference internal" href="#dennis1996numerical-ex-8-7"><span class="std std-ref">Exercise 7</span></a> may be helpful towards
understanding the application of (3.1.17).</p>
</div>
<div class="section" id="Exercise-7">
<span id="dennis1996numerical-ex-8-7"></span><h2>Exercise 7<a class="headerlink" href="#Exercise-7" title="Permalink to this headline">¶</a></h2>
<p>Suppose <span class="math notranslate nohighlight">\(s \in \mathbb{R}^n \setminus \{ 0 \}\)</span> and
<span class="math notranslate nohighlight">\(I \in \mathbb{R}^{n \times n}\)</span> is the identity matrix.</p>
<p>In order to simplify the derivations, rewrite the original problem as</p>
<div class="math notranslate nohighlight">
\[I - \frac{s s^\top}{s^\top s} =
I - \frac{s s^\top}{\left\Vert s \right\Vert_2^2} =
I - u u^\top\]</div>
<p>where <span class="math notranslate nohighlight">\(u = \frac{s}{\left\Vert s \right\Vert_2}\)</span> and <span class="math notranslate nohighlight">\(u^\top u = 1\)</span>.</p>
<p>By definition, the resulting (projection) matrix and its summands are
idempotent</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( I - u u^\top \right) \left( I - u u^\top \right)
 &amp;= I - 2u u^\top + u u^\top u u^\top\\
 &amp;= I - 2u u^\top + u u^\top\\
 &amp;= I - u u^\top\end{split}\]</div>
<p>and symmetric</p>
<div class="math notranslate nohighlight">
\[\left( I - u u^\top \right)^\top = I - u u^\top.\]</div>
<p>The rank of the matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\text{rank}(I - u u^\top)
 &amp;= \text{tr}(I - u u^\top)
    &amp; \quad &amp; \text{the trace of an idempotent matrix is its rank}\\
 &amp;= \text{tr}(I) - \text{tr}(u u ^\top)
    &amp; \quad &amp; \text{trace is a linear mapping}\\
 &amp;= n - \sum_{i = 1}^n u_i^2\\
 &amp;= n - u^\top u\\
 &amp;= n - 1.\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(A = I - u u^\top\)</span>.  Recall that the relation between an eigenvalue
<span class="math notranslate nohighlight">\(\lambda\)</span> and a non-zero eigenvector <span class="math notranslate nohighlight">\(v\)</span> for <span class="math notranslate nohighlight">\(A\)</span> is
<span class="math notranslate nohighlight">\(Av = \lambda v\)</span>.  Since <span class="math notranslate nohighlight">\(A\)</span> is idempotent, the following must hold:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lambda v = Av = A^2 v = A (Av) &amp;= \lambda^2 v\\
\boldsymbol{0} &amp;= \lambda (\lambda - 1) v\end{split}\]</div>
<p>i.e. the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span> must be either <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>By Theorem 3.5.6 and</p>
<div class="math notranslate nohighlight">
\[\text{rank}(A) = n - 1 = \text{tr}(A) = \sum_{i = 1}^n \lambda_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_i\)</span> are the eigenvalues of <span class="math notranslate nohighlight">\(A\)</span>,</p>
<div class="math notranslate nohighlight">
\[\left\Vert I - \frac{s s^\top}{s^\top s} \right\Vert_2 =
\max_{1 \leq i \leq n} \left\vert \lambda_i \right\vert = 1.\]</div>
</div>
<div class="section" id="Exercise-8">
<h2>Exercise 8<a class="headerlink" href="#Exercise-8" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(D \subseteq \mathbb{R}^n\)</span> be an open convex set,
<span class="math notranslate nohighlight">\(F \colon \mathbb{R}^n \rightarrow \mathbb{R}^n\)</span>,
<span class="math notranslate nohighlight">\(J(x) \in \text{Lip}_\gamma(D)\)</span>, <span class="math notranslate nohighlight">\(x_* \in D\)</span>, and <span class="math notranslate nohighlight">\(J(x_*)\)</span> be
nonsingular.</p>
<p>Let <span class="math notranslate nohighlight">\(\{ A_k \in \mathbb{R}^{n \times n} \}\)</span> be a sequence of nonsingular
matrices, and suppose for some <span class="math notranslate nohighlight">\(x_0 \in D\)</span> that the sequence of points
generated by <span class="math notranslate nohighlight">\(x_{k + 1} = x_k - A_k^{-1} F(x_k)\)</span> remains in <span class="math notranslate nohighlight">\(D\)</span>
and satisfies <span class="math notranslate nohighlight">\(\lim_{k \rightarrow \infty} x_k = x_*\)</span> for any <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>Define <span class="math notranslate nohighlight">\(J(x_k) = J_k\)</span>, <span class="math notranslate nohighlight">\(e_k = x_k - x_*\)</span>, <span class="math notranslate nohighlight">\(F(x_k) = F_k\)</span>, and
<span class="math notranslate nohighlight">\(s_k \triangleq x_{k + 1} - x_k\)</span>.</p>
<p>A useful fact is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lim_{k \rightarrow \infty} \left\Vert s_k \right\Vert
 &amp;= \lim_{k \rightarrow \infty} \left\Vert x_{k + 1} - x_k \right\Vert\\
 &amp;= \lim_{k \rightarrow \infty} \left\Vert x_* - x_* \right\Vert\\
 &amp;= \left\Vert \lim_{k \rightarrow \infty} x_* - x_* \right\Vert
    &amp; \quad &amp; \left\Vert \cdot \right\Vert \text{ is continuous}\\
 &amp;= 0.\end{split}\]</div>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(\lim_{k \rightarrow \infty}
\frac{\left\Vert (A_k - J_k) s_k \right\Vert}{\left\Vert s_k \right\Vert} = 0\)</span>
where <span class="math notranslate nohighlight">\(s_k \triangleq x_{k + 1} - x_k\)</span>, then <span class="math notranslate nohighlight">\(\{ x_k \}\)</span> converges
<span class="math notranslate nohighlight">\(q\)</span>-superlinearly to <span class="math notranslate nohighlight">\(x_*\)</span> in some norm
<span class="math notranslate nohighlight">\(\left\Vert \cdot \right\Vert\)</span> and <span class="math notranslate nohighlight">\(F_* = 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_{k + 1} &amp;= x_k - A_k^{-1} F_k
             &amp; \quad &amp; \text{(8.2.15)}\\
0 &amp;= A_k s_k + F_k\\
0 &amp;= \left( A_k - J_k \right) s_k + F_k + J_k s_k\\
-F_{k + 1} &amp;= \left( A_k - J_k \right) s_k - F_{k + 1} + F_k + J_k s_k\\
\left\Vert -F_{k + 1} \right\Vert
 &amp;= \left\Vert
      \left( A_k - J_k \right) s_k - F_{k + 1} + F_k + J_k s_k
    \right\Vert\\
\left\Vert F_{k + 1} \right\Vert
 &amp;\leq \left\Vert \left( A_k - J_k \right) s_k \right\Vert +
       \left\Vert F_{k + 1} - F_k - J_k s_k \right\Vert
       &amp; \quad &amp; \text{(3.1.1c) and (3.1.10)}\\
\frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert}
 &amp;\leq \frac{
         \left\Vert \left( A_k - J_k \right) s_k \right\Vert
       }{
         \left\Vert s_k \right\Vert
       } +
       \frac{\gamma}{2}\left\Vert s_k \right\Vert
       &amp; \quad &amp; \text{Lemma 4.1.15}\\
\lim_{k \rightarrow \infty}
    \frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert}
  &amp;\leq 0
        &amp; \quad &amp; \text{see initial assumptions.}\end{split}\]</div>
<p>Thus <span class="math notranslate nohighlight">\(F_* = \lim_{k \rightarrow \infty} F_k = 0\)</span>.  The sequence
<span class="math notranslate nohighlight">\(\{ x_k \}\)</span> converges <span class="math notranslate nohighlight">\(q\)</span>-superlinearly because</p>
<div class="math notranslate nohighlight">
\[\begin{split}0 &amp;= \lim_{k \rightarrow \infty}
       \frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert}\\
 &amp;= \lim_{k \rightarrow \infty}
      \frac{
        \left\Vert F_{k + 1} - F_* \right\Vert
      }{
        \left\Vert x_{k + 1} - x_k \right\Vert
      }\\
 &amp;\geq \lim_{k \rightarrow \infty} \alpha
         \frac{
           \left\Vert e_{k + 1} \right\Vert
         }{
           \left\Vert x_{k + 1} - x_* + x_* - x_k \right\Vert
         }
       &amp; \quad &amp; \text{Lemma 4.1.16}\\
 &amp;\geq \lim_{k \rightarrow \infty} \alpha
         \frac{
           \left\Vert e_{k + 1} \right\Vert
         }{
           \left\Vert e_{k + 1} \right\Vert + \left\Vert e_k \right\Vert
         }
       &amp; \quad &amp; \text{(3.1.1c)}\\
 &amp;= \lim_{k \rightarrow \infty} \alpha \frac{r_k}{1 + r_k}
    &amp; \quad &amp; \text{(2.3.2)}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_k \triangleq
\left\Vert e_{k + 1} \right\Vert / \left\Vert e_k \right\Vert\)</span>.</p>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>If <span class="math notranslate nohighlight">\(\{ x_k \}\)</span> converges <span class="math notranslate nohighlight">\(q\)</span>-superlinearly to <span class="math notranslate nohighlight">\(x_*\)</span> in some
norm <span class="math notranslate nohighlight">\(\left\Vert \cdot \right\Vert\)</span> and <span class="math notranslate nohighlight">\(F(x_*) = 0\)</span>, then
<span class="math notranslate nohighlight">\(\lim_{k \rightarrow \infty}
\frac{\left\Vert (A_k - J_k) s_k \right\Vert}{\left\Vert s_k \right\Vert} = 0\)</span>
where <span class="math notranslate nohighlight">\(s_k \triangleq x_{k + 1} - x_k\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}0 &amp;= \lim_{k \rightarrow \infty}
       \frac{\left\Vert e_{k + 1} \right\Vert}{\left\Vert e_k \right\Vert}
     &amp; \quad &amp; \text{(2.3.2)}\\
 &amp;\geq \lim_{k \rightarrow \infty}
         \frac{
           \left\Vert F_{k + 1} \right\Vert
         }{
           \beta \left\Vert e_k \right\Vert
         }
       &amp; \quad &amp; \text{Lemma 4.1.16 states that }
                 \left\Vert F_{k + 1} - F_* \right\Vert \leq
                 \beta \left\Vert e_{k + 1} \right\Vert\\
 &amp;= \lim_{k \rightarrow \infty} \beta^{-1}
      \frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert}
      \frac{\left\Vert s_k \right\Vert}{\left\Vert e_k \right\Vert}.\end{split}\]</div>
<p>Applying Lemma 8.2.3 shows that <span class="math notranslate nohighlight">\(\lim_{k \rightarrow \infty}
\frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert} = 0\)</span>.  Thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_{k + 1} &amp;= x_k - A_k^{-1} F_k
             &amp; \quad &amp; \text{(8.2.15)}\\
0 &amp;= A_k s_k + F_k\\
0 &amp;= \left( A_k - J_k \right) s_k + F_k + J_k s_k\\
-\left( A_k - J_k \right) s_k &amp;= F_{k + 1} - F_{k + 1} + F_k + J_k s_k\\
\left\Vert -\left( A_k - J_k \right) s_k \right\Vert
 &amp;= \left\Vert F_{k + 1} - F_{k + 1} + F_k + J_k s_k \right\Vert\\
\left\Vert \left( A_k - J_k \right) s_k \right\Vert
 &amp;\leq \left\Vert F_{k + 1} \right\Vert +
       \left\Vert F_{k + 1} - F_k - J_k s_k \right\Vert
       &amp; \quad &amp; \text{(3.1.1c) and (3.1.10)}\\
\frac{
  \left\Vert \left( A_k - J_k \right) s_k \right\Vert
}{
  \left\Vert s_k \right\Vert
} &amp;\leq \frac{\left\Vert F_{k + 1} \right\Vert}{\left\Vert s_k \right\Vert} +
        \frac{\gamma}{2} \left\Vert s_k \right\Vert
        &amp; \quad &amp; \text{Lemma 4.1.15}\\
\lim_{k \rightarrow \infty}
  \frac{
    \left\Vert \left( A_k - J_k \right) s_k \right\Vert
  }{
    \left\Vert s_k \right\Vert
  }
 &amp;\leq 0
       &amp; \quad &amp; \text{see initial assumptions.}\end{split}\]</div>
</div>
</div>
<div class="section" id="Exercise-9">
<span id="dennis1996numerical-ex-8-9"></span><h2>Exercise 9<a class="headerlink" href="#Exercise-9" title="Permalink to this headline">¶</a></h2>
<p>The purpose of Example 8.2.6 is to illustrate that Broyden’s method can get
relatively close to the true Jacobian.</p>
<p>This exercise is more along the lines of Lemma 8.2.7 where the relative error
is much greater: in this case it is between <span class="math notranslate nohighlight">\(39\%\)</span> and <span class="math notranslate nohighlight">\(620\%\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">macheps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="n">x_k</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">A_k</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">broydens_update</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;L2-Norm(x_{} - x_{}): {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">norm</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">&lt;=</span> <span class="n">macheps</span><span class="p">:</span>
        <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>
        <span class="k">break</span>
    <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x_k: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;A_k:</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A_k</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;J(x_k):</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A_k</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Relative Error at {}: {:0.2f}%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L2-Norm(x_1 - x_0): 1.6767467315827993
L2-Norm(x_2 - x_1): 0.5245600994611522
L2-Norm(x_3 - x_2): 0.31879902339630917
L2-Norm(x_4 - x_3): 0.09733974405443968
L2-Norm(x_5 - x_4): 0.23265589552166405
L2-Norm(x_6 - x_5): 3.268722459941512
L2-Norm(x_7 - x_6): 3.1691877752357605
L2-Norm(x_8 - x_7): 4.705640972470869
L2-Norm(x_9 - x_8): 0.4705727292535645
L2-Norm(x_10 - x_9): 0.14864052229030497
L2-Norm(x_11 - x_10): 1.9639366915192304
L2-Norm(x_12 - x_11): 1.703473765729639
L2-Norm(x_13 - x_12): 0.08713054352155514
L2-Norm(x_14 - x_13): 0.030090519390857193
L2-Norm(x_15 - x_14): 0.007459734854001399
L2-Norm(x_16 - x_15): 0.0009364321451569183

x_k: [-0.71387461  1.22097779]

A_k:
[[-0.2321455   4.31364145]
 [ 1.29755602  6.22127445]]

J(x_k):
[[-1.42774922  2.44195558]
 [ 0.18016636  4.47236031]]

Relative Error at 0: 83.74%

Relative Error at 1: 76.65%

Relative Error at 2: 620.20%

Relative Error at 3: 39.10%
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-10">
<span id="dennis1996numerical-ex-8-10"></span><h2>Exercise 10<a class="headerlink" href="#Exercise-10" title="Permalink to this headline">¶</a></h2>
<p>The following extension of (2.2.1) to higher dimensions (5.1.1) will be useful
in the proof that follows.</p>
<p>Suppose <span class="math notranslate nohighlight">\(F(x) = Ax + b\)</span> is an affine transformation where
<span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span> and <span class="math notranslate nohighlight">\(F'(x) = A = J(x)\)</span> is
nonsingular.  For all <span class="math notranslate nohighlight">\(k \geq 1\)</span>, <span class="math notranslate nohighlight">\(F(x_k) = 0\)</span> because</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_{k + 1} &amp;= x_k - s_k = x_k - J^{-1}(x_k) F(x_k)\\
x_1 &amp;= x_0 - A^{-1} (A x_0 + b) = -A^{-1} b\\
x_2 &amp;= x_1 - A^{-1} \left[ A (-A^{-1} b) + b \right] = -A^{-1} b.\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(F(x) = \begin{bmatrix} J_1 x + b_1\\ F_2(x) \end{bmatrix}\)</span> where
<span class="math notranslate nohighlight">\(J_1 \in \mathbb{R}^{m \times n}\)</span>, <span class="math notranslate nohighlight">\(b_1 \in \mathbb{R}^m\)</span>, and
<span class="math notranslate nohighlight">\(F_2 \colon \mathbb{R}^n \rightarrow \mathbb{R}^{n - m}\)</span> is nonlinear.</p>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>In Broyden’s method, the initial <span class="math notranslate nohighlight">\(A_0\)</span> can be calculated analytically as</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_0 = J(x) &amp;= \frac{F(x)}{\partial x^\top}\\
 &amp;= \begin{bmatrix} J_1\\ F'_2(x) \end{bmatrix}
    &amp; \quad &amp; F'_2(x) = \frac{\partial F_2(x)}{\partial x^\top}\\
 &amp;= \begin{bmatrix} A_{01}\\ A_{02} \end{bmatrix}
    &amp; \quad &amp; A_{01} = J_1 \text{ and } A_{02} = F'_2(x).\end{split}\]</div>
<p>For the finite difference case, Theorem 5.4.1 states that <span class="math notranslate nohighlight">\(i\text{th}\)</span>
component has an error of <span class="math notranslate nohighlight">\(\mathcal{O}(h_i)\)</span> when using forward difference
(5.6.5) and <span class="math notranslate nohighlight">\(\mathcal{O}(h_i^2)\)</span> when using central difference (5.6.6).</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_1 &amp;= A_0 + \frac{y_0 - A_0 s_0}{s_0^\top s_0} s_0^\top\\
 &amp;= J(x_0) + \frac{F(x_1)}{s_0^\top s_0} s_0^\top
    &amp; \quad y_k = F(x_{k + 1}) - F(x_k)\\
 &amp;= \begin{bmatrix} J_1\\ F'_2(x_0) \end{bmatrix} +
    \left\Vert s_0 \right\Vert_2^{-2}
      \begin{bmatrix} J_1 x_1 + b_1\\ F_2(x_1) \end{bmatrix} s_0^\top\end{split}\]</div>
<p>By inspection, the first <span class="math notranslate nohighlight">\(m\)</span> rows of the outer product
<span class="math notranslate nohighlight">\(F(x_1) s_0^\top\)</span> contains only zeros.  Thus by induction
<span class="math notranslate nohighlight">\(A_{k1} = J_1 \forall k \geq 0\)</span>.</p>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Generalizing the update sequence</p>
<div class="math notranslate nohighlight">
\[\begin{split}A_{k + 1} &amp;= A_k + \frac{y_k - A_k s_k}{s_k^\top s_k} s_k^\top\\
 &amp;= \begin{bmatrix} J_1\\ A_{k2} \end{bmatrix} +
    \left\Vert s_k \right\Vert_2^{-2}
      \begin{bmatrix} J_1 x_k + b_1\\ F_2(x_k) \end{bmatrix} s_k^\top\end{split}\]</div>
<p>gives</p>
<div class="math notranslate nohighlight">
\[A_{(k + 1)2} = A_{k2} + \left\Vert s_k \right\Vert_2^{-2} F_2(x_k) s_k^\top.\]</div>
<p>Consequently,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( A_{k2} - A_{12} \right) J_1^\top
 &amp;= \left(
      \sum_{i = 1}^{k - 1}
        \left\Vert s_i \right\Vert_2^{-2} F_2(x_i) s_i^\top
    \right) J_1^\top\\
 &amp;= \sum_{i = 1}^{k - 1}
      \left\Vert s_i \right\Vert_2^{-2} F_2(x_i)
      \left( J_1 s_i \right)^\top\\
 &amp;= \sum_{i = 1}^{k - 1}
      \left\Vert s_i \right\Vert_2^{-2} F_2(x_i)
      \left[ J_1 \left( x_{i + 1} - x_i \right) \right]^\top\\
 &amp;= 0 &amp; \quad &amp; J_1 x_k + b_1 = 0 \, \forall \, k \geq 1\end{split}\]</div>
<p>implies the sequence <span class="math notranslate nohighlight">\(\{ A_{k2} \}\)</span> will converge to the correct value
<span class="math notranslate nohighlight">\(F'_2(x_*)\)</span> when the nonlinear solution intersects with the affine
solution <span class="math notranslate nohighlight">\(J_1\)</span>.</p>
</div>
</div>
<div class="section" id="Exercise-11">
<h2>Exercise 11<a class="headerlink" href="#Exercise-11" title="Permalink to this headline">¶</a></h2>
<p>The relative error for <span class="math notranslate nohighlight">\(x_0 = (0.5, 0.5)^\top\)</span> is between
<span class="math notranslate nohighlight">\(2.8\%\)</span> and <span class="math notranslate nohighlight">\(43.6\%\)</span>, which is not as terrible as the starting
point for <a class="reference internal" href="#dennis1996numerical-ex-8-9"><span class="std std-ref">Exercise 9</span></a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">J</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">flat</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                           <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>

<span class="n">macheps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span>
<span class="n">x_k</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]])</span>
<span class="n">A_k</span> <span class="o">=</span> <span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">broydens_update</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_k</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;L2-Norm(x_{} - x_{}): {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">norm</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">norm</span> <span class="o">&lt;=</span> <span class="n">macheps</span><span class="p">:</span>
        <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>
        <span class="k">break</span>
    <span class="n">A_k</span><span class="p">,</span> <span class="n">x_k</span> <span class="o">=</span> <span class="n">_</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">x_k: {}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;A_k:</span><span class="se">\n</span><span class="s1">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A_k</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;J(x_k):</span><span class="se">\n</span><span class="s1">{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">A_k</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">J</span><span class="p">(</span><span class="n">x_k</span><span class="p">)</span><span class="o">.</span><span class="n">flat</span><span class="p">)):</span>
    <span class="n">_</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Relative Error at {}: {:0.2f}%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
L2-Norm(x_1 - x_0): 2.692582403567252
L2-Norm(x_2 - x_1): 2.8572229427438764
L2-Norm(x_3 - x_2): 0.7723700761333678
L2-Norm(x_4 - x_3): 0.34589773894258735
L2-Norm(x_5 - x_4): 0.06824600043497131
L2-Norm(x_6 - x_5): 0.030690913962507314
L2-Norm(x_7 - x_6): 0.16638292726530998
L2-Norm(x_8 - x_7): 0.045234877304341184
L2-Norm(x_9 - x_8): 0.006719355304038589
L2-Norm(x_10 - x_9): 0.0004239644116932341
L2-Norm(x_11 - x_10): 5.577759379756155e-06
L2-Norm(x_12 - x_11): 6.09851312396262e-07
L2-Norm(x_13 - x_12): 2.9139809614567313e-08
L2-Norm(x_14 - x_13): 1.1194150756256751e-11

x_k: [1. 1.]

A_k:
[[1.93259629 1.94390582]
 [0.56428491 2.63765057]]

J(x_k):
[[2. 2.]
 [1. 3.]]

Relative Error at 0: 3.37%

Relative Error at 1: 2.80%

Relative Error at 2: 43.57%

Relative Error at 3: 12.08%
</pre></div></div>
</div>
</div>
<div class="section" id="Exercise-12">
<h2>Exercise 12<a class="headerlink" href="#Exercise-12" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\hat{x} = D_x x\)</span> and <span class="math notranslate nohighlight">\(\hat{F}(\hat{x}) = D_F F(x)\)</span>.  The
following are useful for the proof.</p>
<div class="math notranslate nohighlight">
\[\hat{A}_k \hat{s}_k = -\hat{F}(\hat{x}_k) = -D_F F(x) = D_F A_k s_k\]</div>
<div class="math notranslate nohighlight">
\[\hat{s}_k = \hat{x}_{k + 1} - \hat{x}_k = D_x x_{k + 1} - D_x x_k = D_x s_k\]</div>
<div class="math notranslate nohighlight">
\[\hat{y}_k =
\hat{F}(\hat{x}_{k + 1}) - \hat{F}(\hat{x}_k) =
D_F F(x_{k + 1}) - D_F F(x_k) =
D_F y_k\]</div>
<p>Suppose <span class="math notranslate nohighlight">\(A_k \simeq J_k\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{A}_{k + 1}
 &amp;= \hat{A}_k +
    \frac{
      \left( \hat{y}_k \hat{A}_k \hat{s}_k \right) \hat{s}_k^\top
    }{
      \hat{s}_k^\top \hat{s}_k
    }\\\\
D_F J_{k + 1} D_x^{-1}
 &amp;= D_F J_k D_x^{-1} +
    \frac{
      \left( D_F y_k - D_F A_k s_k \right) s_k^\top D_x
    }{
      s_k^\top D_x^2 s_k
    }\\\\
A_{k + 1}
 &amp;= A_k +
    \frac{\left( y_k - A_k s_k \right) s_k^\top D_x^2}{s_k^\top D_x^2 s_k}\end{split}\]</div>
<p>where the second equality is based on the foregoing results and
<a class="reference internal" href="chapter-07.html#dennis1996numerical-ex-7-4"><span class="std std-ref">Exercise 7.4</span></a>.</p>
</div>
<div class="section" id="Exercise-13">
<span id="dennis1996numerical-ex-8-13"></span><h2>Exercise 13<a class="headerlink" href="#Exercise-13" title="Permalink to this headline">¶</a></h2>
<p>Suppose <span class="math notranslate nohighlight">\(u, v \in \mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{n \times n}\)</span>
is nonsingular.</p>
<p>Recall that the matrix determinant lemma states that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator{\det}{det}
\det\left(
  \begin{bmatrix} I &amp; 0\\ v^\top &amp; 1 \end{bmatrix}
  \begin{bmatrix} I + uv^\top &amp; u\\ 0 &amp; 1 \end{bmatrix}
  \begin{bmatrix} I &amp; 0\\ -v^\top &amp; 1 \end{bmatrix}
\right)
 &amp;= \det\left(
      \begin{bmatrix} I &amp; u\\ 0 &amp; 1 + v^\top u \end{bmatrix}
    \right)\\
\det\left( I + uv^\top \right)
 &amp;= \det\left( 1 + v^\top u \right).\end{split}\]</div>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\det\left( A + uv^\top \right)
 &amp;= \det\left( A \left[I + A^{-1} uv^\top \right] \right)\\
 &amp;= \det(A) \det\left(I + \left( A^{-1} u \right) v^\top \right)\\
 &amp;= \det(A) \det\left(1 + v^\top A^{-1} u \right)
    &amp; \quad &amp; \text{matrix determinant lemma}\end{split}\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Observe that
<span class="math notranslate nohighlight">\(\left( I + uv^\top \right)^{-1} = I - \frac{u v^\top}{\sigma}\)</span> where
<span class="math notranslate nohighlight">\(\sigma \triangleq 1 + v^\top u\)</span> because</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( I + uv^\top \right) \left( I + uv^\top \right)^{-1}
 &amp;= \left( I + uv^\top \right) \left( I - \frac{1}{\sigma} u v^\top \right)\\
 &amp;= I - \frac{uv^\top}{\sigma} + uv^\top - \frac{uv^\top uv^\top}{\sigma}\\
 &amp;= I + uv^\top - \frac{\left( 1 + v^\top u \right) uv^\top}{\sigma}\\
 &amp;= I.\end{split}\]</div>
<p>Applying the foregoing result gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ A + uv^\top \right]^{-1}
 &amp;= \left[ A \left(I + A^{-1} uv^\top \right) \right]^{-1}\\
 &amp;= \left(I + A^{-1} uv^\top \right)^{-1} A^{-1}\\
 &amp;= \left(I + \frac{A^{-1} uv^\top}{1 + v^\top A^{-1} u} \right) A^{-1}\\
 &amp;= A^{-1} + \frac{1}{\sigma} A^{-1} uv^\top A^{-1}.\end{split}\]</div>
</div>
</div>
<div class="section" id="Exercise-14">
<h2>Exercise 14<a class="headerlink" href="#Exercise-14" title="Permalink to this headline">¶</a></h2>
<p>See the previous exercises for a basic implementation of Broyden’s method.</p>
<p>Problems that are not smooth and have varying magnitudes in each dimension could
cause the secant approximation to fail to converge.</p>
</div>
<div class="section" id="Exercise-15">
<h2>Exercise 15<a class="headerlink" href="#Exercise-15" title="Permalink to this headline">¶</a></h2>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<p>Suppose <span class="math notranslate nohighlight">\(B \in Q(y, s)\)</span> such that <span class="math notranslate nohighlight">\(B s = y\)</span> where
<span class="math notranslate nohighlight">\(s \neq 0\)</span> and <span class="math notranslate nohighlight">\(B\)</span> is nonsingular.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert A_+^{-1} - A^{-1} \right\Vert
 &amp;= \left\Vert
      \frac{\left( s - A^{-1} y \right) y^\top}{y^\top y}
    \right\Vert
    &amp; \quad &amp; \text{(8.4.2)}\\
 &amp;= \left\Vert
      \frac{\left( B^{-1} - A^{-1} \right) y y^\top}{y^\top y}
    \right\Vert\\
 &amp;\leq \left\Vert B^{-1} - A^{-1} \right\Vert
       \left\Vert \frac{y y^\top}{y^\top y} \right\Vert
       &amp; \quad &amp; \text{(8.1.6)}\\
 &amp;= \left\Vert B^{-1} - A^{-1} \right\Vert
    &amp; \quad &amp; \text{(8.1.7)}\end{split}\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Suppose <span class="math notranslate nohighlight">\(A\)</span> is nonsingular and <span class="math notranslate nohighlight">\(y^\top A s \neq 0\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( A_+^{-1} \right)^{-1}
 &amp;= \left(
      A^{-1} + \frac{\left( s - A^{-1} y \right) y^\top}{y^\top y}
    \right)^{-1}
    &amp; \quad &amp; \text{(8.4.2)}\\
 &amp;= A -
    \left(
      1 + \frac{y^\top A \left( s - A^{-1} y \right)}{y^\top y}
    \right)^{-1}
      A \frac{\left( s - A^{-1} y \right) y^\top}{y^\top y} A
    &amp; \quad &amp; \text{Lemma 8.3.1}\\
 &amp;= A -
    \left( \frac{y^\top As}{y^\top y} \right)^{-1}
      \frac{\left( As - y \right) y^\top A}{y^\top y}\\
A_+ &amp;= A + \frac{\left( y - As \right) y^\top A}{y^\top As}\end{split}\]</div>
</div>
</div>
<div class="section" id="Exercise-16">
<h2>Exercise 16<a class="headerlink" href="#Exercise-16" title="Permalink to this headline">¶</a></h2>
<p>The bad Broyden update is strongly influenced by the scaling of a norm’s
residuals.  The storage requirement is twice that of the good update.  It
does not exploit sparsity.  See <a class="bibtex reference internal" href="#griewank2012broyden" id="id9">[Gri12]</a> for an excellent
exposition on this matter.</p>
</div>
<div class="section" id="Exercise-17">
<h2>Exercise 17<a class="headerlink" href="#Exercise-17" title="Permalink to this headline">¶</a></h2>
<p>Suppose <span class="math notranslate nohighlight">\(A_k \in \mathbb{R}^{n \times n}\)</span>,
<span class="math notranslate nohighlight">\(s_i, y_i \in \mathbb{R}^n\)</span> for <span class="math notranslate nohighlight">\(i = k - 1, k\)</span> where
<span class="math notranslate nohighlight">\(s_{k - 1}\)</span> and <span class="math notranslate nohighlight">\(s_k\)</span> linearly independent, and
<span class="math notranslate nohighlight">\(A_k s_{k - 1} = y_{k - 1}\)</span>.</p>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}A_{k + 1} s_{k - 1}
 &amp;= \left(
      A_k + \frac{\left( y_k - A_k s_k \right) v_k^\top}{v_k^\top s_k}
    \right) s_{k - 1}\\
 &amp;= A_k s_{k - 1} +
    \frac{\left( y_k - A_k s_k \right) v_k^\top s_{k - 1}}{v_k^\top s_k}\\
 &amp;= y_{k - 1} +
    \frac{\left( y_k - A_k s_k \right) v_k^\top s_{k - 1}}{v_k^\top s_k}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(v_k^\top s_{k - 1} = 0\)</span> when <span class="math notranslate nohighlight">\(v_k\)</span> is defined as the result of
the Gram-Schmidt orthogonalization on the linearly independent set
<span class="math notranslate nohighlight">\(\left\{ s_{k - 1}, s_k \right\}\)</span>:</p>
<div class="math notranslate nohighlight">
\[v_k = s_k - \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}} s_{k - 1}.\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Suppose</p>
<div class="math notranslate nohighlight">
\[v_k = s_k - \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}} s_{k - 1}\]</div>
<p>and <span class="math notranslate nohighlight">\(B \in Q(y_k, s_k) \cap Q(y_{k - 1}, s_{k - 1})\)</span> such that
<span class="math notranslate nohighlight">\(B s_k = y_k\)</span> and <span class="math notranslate nohighlight">\(B s_{k - 1} = y_{k - 1}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert A_{k + 1} - A_k \right\Vert
 &amp;= \left\Vert
      \frac{\left( y_k - A_k s_k \right) v_k^\top}{v_k^\top s_k}
    \right\Vert
    &amp; \quad &amp; \text{(8.4.5)}\\
 &amp;= \left\Vert
      \frac{\left( B - A_k \right) s_k v_k^\top}{v_k^\top s_k}
    \right\Vert\\
 &amp;= \left\Vert
      \frac{\left( B - A_k \right) v_k v_k^\top}{v_k^\top s_k}
    \right\Vert
    &amp; \quad &amp; \text{(b.1)}\\
 &amp;\leq \left\Vert B - A_k \right\Vert
       \left\Vert \frac{v_k v_k^\top}{v_k^\top s_k} \right\Vert_2
       &amp; \quad &amp; \text{(3.1.10), (3.1.15), (3.1.17)}\\
 &amp;= \left\Vert B - A_k \right\Vert
    &amp; \quad &amp; \text{(b.2)}\end{split}\]</div>
<p>Since the Frobenius norm is strictly convex and <span class="math notranslate nohighlight">\(Q(y, s)\)</span> is an affine
subset of <span class="math notranslate nohighlight">\(\mathbb{R}^{n \times n}\)</span> (hence convex), (8.4.5) gives a
unique solution.</p>
</div>
<div class="section" id="(b.1)">
<h3>(b.1)<a class="headerlink" href="#(b.1)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\left( B - A_k \right) s_k
 &amp;= \left( B - A_k \right)
    \left(
      v_k + \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}} s_{k - 1}
    \right)\\
 &amp;= \left( B - A_k \right) v_k +
    \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}}
      \left( B s_{k - 1} - A_k s_{k - 1} \right)\\
 &amp;= \left( B - A_k \right) v_k +
    \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}}
      \left( y_{k - 1} - y_{k - 1} \right)\\
 &amp;= \left( B - A_k \right) v_k\end{split}\]</div>
</div>
<div class="section" id="(b.2)">
<h3>(b.2)<a class="headerlink" href="#(b.2)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}v_k^\top s_k
 &amp;= v_k^\top \left(
      v_k + \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}} s_{k - 1}
    \right)\\
 &amp;= v_k^\top v_k +
    \frac{s_k^\top s_{k - 1}}{s_{k - 1}^\top s_{k - 1}} v_k^\top s_{k - 1}\\
 &amp;= \left\Vert v_k \right\Vert_2^2
    &amp; \quad &amp; \text{(a) shows that } v_k^\top s_{k - 1} = 0\end{split}\]</div>
<p>Define <span class="math notranslate nohighlight">\(u_k = \frac{v_k}{\left\Vert v_k \right\Vert_2}\)</span>.  Applying
(3.1.17) yields</p>
<div class="math notranslate nohighlight">
\[\left\Vert \frac{v_k v_k^\top}{v_k^\top s_k} \right\Vert_2 =
\left\Vert u_k u_k^\top \right\Vert_2 =
\left\Vert u_k \right\Vert_2^2 = 1.\]</div>
</div>
</div>
<div class="section" id="Exercise-18">
<h2>Exercise 18<a class="headerlink" href="#Exercise-18" title="Permalink to this headline">¶</a></h2>
<p>Suppose for some <span class="math notranslate nohighlight">\(m &lt; n\)</span>, <span class="math notranslate nohighlight">\(A_k \in \mathbb{R}^{n \times n}\)</span>,
<span class="math notranslate nohighlight">\(s_j, y_j \in \mathbb{R}^n\)</span> for <span class="math notranslate nohighlight">\(j = k - m, \ldots, k\)</span>,
<span class="math notranslate nohighlight">\(s_{k - m}, \ldots, s_k\)</span> are linearly independent, and
<span class="math notranslate nohighlight">\(A_k s_i = y_i\)</span> for <span class="math notranslate nohighlight">\(i = k - m, \ldots, k - 1\)</span>.</p>
<div class="section" id="(a)">
<h3>(a)<a class="headerlink" href="#(a)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}A_{k + 1} s_i
 &amp;= \left(
      A_k + \frac{\left( y_k - A_k s_k \right) v_k^\top}{v_k^\top s_k}
    \right) s_i\\
 &amp;= A_k s_i +
    \frac{\left( y_k - A_k s_k \right) v_k^\top}{v_k^\top s_k} s_i\\
 &amp;= y_i + \frac{\left( y_k - A_k s_k \right)}{v_k^\top s_k} v_k^\top s_i\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(v_k^\top s_i = 0\)</span> when <span class="math notranslate nohighlight">\(v_k\)</span> is defined as the result of the
Gram-Schmidt orthogonalization on the linearly independent set
<span class="math notranslate nohighlight">\(\left\{ s_{k - m}, \ldots, s_k \right\}\)</span>.</p>
<div class="math notranslate nohighlight">
\[v_k =
s_k - \sum_{i = k - m}^{k - 1} \text{proj}_{v_i}(s_k) =
s_k - \sum_{i = k - m}^{k - 1} \frac{s_k^\top v_i}{v_i^\top v_i} v_i\]</div>
<p>because</p>
<div class="math notranslate nohighlight">
\[\begin{split}v_k^\top s_i
 &amp;= v_k^\top \left(
      v_i + \sum_{z = k - m}^{k - 1} \text{proj}_{v_z}(s_i)
    \right)\\
 &amp;= v_k^\top v_i +
    \sum_{z = k - m}^{k - 1} \frac{s_i^\top v_z}{v_z^\top v_z} v_k^\top v_z\\
 &amp;= 0.\end{split}\]</div>
</div>
<div class="section" id="(b)">
<h3>(b)<a class="headerlink" href="#(b)" title="Permalink to this headline">¶</a></h3>
<p>Define <span class="math notranslate nohighlight">\(v_k\)</span> as in (a) and <span class="math notranslate nohighlight">\(B \in \bigcap_{j} Q(y_j, s_j)\)</span> such that
<span class="math notranslate nohighlight">\(B s_j = y_j\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\Vert A_{k + 1} - A_k \right\Vert
 &amp;= \left\Vert
      \frac{\left( y_k - A_k s_k \right) v_k^\top}{v_k^\top s_k}
    \right\Vert
    &amp; \quad &amp; \text{(8.4.5)}\\
 &amp;= \left\Vert
      \frac{\left( B - A_k \right) s_k v_k^\top}{v_k^\top s_k}
    \right\Vert\\
 &amp;= \left\Vert
      \frac{\left( B - A_k \right) v_k v_k^\top}{v_k^\top s_k}
    \right\Vert
    &amp; \quad &amp; \text{(b.1)}\\
 &amp;\leq \left\Vert B - A_k \right\Vert
       \left\Vert \frac{v_k v_k^\top}{v_k^\top s_k} \right\Vert_2
       &amp; \quad &amp; \text{(3.1.10), (3.1.15), (3.1.17)}\\
 &amp;= \left\Vert B - A_k \right\Vert
    &amp; \quad &amp; \text{(b.2)}\end{split}\]</div>
<p>Since the Frobenius norm is strictly convex and <span class="math notranslate nohighlight">\(Q(y, s)\)</span> is an affine
subset of <span class="math notranslate nohighlight">\(\mathbb{R}^{n \times n}\)</span> (hence convex), (8.4.5) gives a
unique solution.</p>
</div>
<div class="section" id="(b.1)">
<h3>(b.1)<a class="headerlink" href="#(b.1)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\left( B - A_k \right) s_k
 &amp;= \left( B - A_k \right)
    \left(
      v_k + \sum_{i = k - m}^{k - 1} \text{proj}_{v_i}(s_k)
    \right)\\
 &amp;= \left( B - A_k \right) v_k +
    \sum_{i = k - m}^{k - 1}
      \frac{s_k^\top v_i}{v_i^\top v_i}
      \left( B v_i - A_k v_i \right)
    &amp; \quad &amp; \text{(b.1.1)}\\
 &amp;= \left( B - A_k \right) v_k\end{split}\]</div>
</div>
<div class="section" id="(b.1.1)">
<h3>(b.1.1)<a class="headerlink" href="#(b.1.1)" title="Permalink to this headline">¶</a></h3>
<p>Proof via induction:</p>
<p>For the base case <span class="math notranslate nohighlight">\(v_{k - m} = s_{k - m}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\left( B - A_k \right) v_{k - m} =
B s_{k - m} - A_k s_{k - m} =
y_{k - m} - y_{k - m} = 0.\]</div>
<p>For the induction step, assume <span class="math notranslate nohighlight">\(\left( B - A_k \right) v_z = 0\)</span> for
<span class="math notranslate nohighlight">\(z = k - m, \ldots, k - 2\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( B - A_k \right) v_{k - 1}
 &amp;= \left( B - A_k \right)
    \left(
      s_{k - 1} - \sum_{z = k - m}^{(k - 1) - 1} \text{proj}_{v_z}(s_{k - 1})
    \right)\\
 &amp;= B s_{k - 1} - A_k s_{k - 1} -
    \sum_{z = k - m}^{k - 2}
      \frac{s_{k - 1}^\top v_z}{v_z^\top v_z}
      \left( B - A_k \right) v_z\\
 &amp;= y_{k - 1} - y_{k - 1}\\
 &amp;= 0\end{split}\]</div>
</div>
<div class="section" id="(b.2)">
<h3>(b.2)<a class="headerlink" href="#(b.2)" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}v_k^\top s_k
 &amp;= v_k^\top \left(
      v_k + \sum_{i = k - m}^{k - 1} \text{proj}_{v_i}(s_k)
    \right)\\
 &amp;= v_k^\top v_k +
    \sum_{i = k - m}^{k - 1} \frac{s_k^\top v_i}{v_i^\top v_i} v_k^\top v_i\\
 &amp;= \left\Vert v_k \right\Vert_2^2
    &amp; \quad &amp; \text{(a) shows that } v_k^\top v_i = 0\end{split}\]</div>
<p>Define <span class="math notranslate nohighlight">\(u_k = \frac{v_k}{\left\Vert v_k \right\Vert_2}\)</span>.  Applying
(3.1.17) yields</p>
<div class="math notranslate nohighlight">
\[\left\Vert \frac{v_k v_k^\top}{v_k^\top s_k} \right\Vert_2 =
\left\Vert u_k u_k^\top \right\Vert_2 =
\left\Vert u_k \right\Vert_2^2 = 1.\]</div>
<p class="rubric">References</p>
<p id="bibtex-bibliography-nb/numerical-methods-for-unconstrained-optimization-and-nonlinear-equations-ds/chapter-08-0"><dl class="citation">
<dt class="bibtex label" id="griewank2012broyden"><span class="brackets"><a class="fn-backref" href="#id9">Gri12</a></span></dt>
<dd><p>Andreas Griewank. Broyden updating, the good and the bad! <em>Optimization stories. Doc. Math</em>, pages 301–315, 2012.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../_sources/nb/numerical-methods-for-unconstrained-optimization-and-nonlinear-equations-ds/chapter-08.ipynb.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2013-2020, alphaXomega.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>