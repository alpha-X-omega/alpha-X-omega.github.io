{
 "cells": [
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "***************\n",
    "Convex Analysis\n",
    "***************"
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "collapsed": true,
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. _vanderbei2014linear-ex-10.1:\n",
    "\n",
    "Exercise 10.1\n",
    "=============\n",
    "\n",
    "Recall that a polyhedron is defined as the intersection of a finite collection\n",
    "of generalized halfspaces (10.3).  :math:`\\mathbb{R}^n` can be represented as\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\left\\{\n",
    "     \\mathbf{x} \\in \\mathbb{R}^n \\colon \\mathbf{a}^\\top \\mathbf{x} \\leq b\n",
    "   \\right\\}\n",
    "\n",
    "where :math:`\\mathbf{a} = \\boldsymbol{0}` and :math:`b \\geq 0`."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.2\n",
    "=============\n",
    "\n",
    "Let :math:`\\zeta^*(b)` denote the corresponding optimal objective function value\n",
    "for the dual linear program\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\mathcal{D} \\quad \\text{minimize} \\quad b^\\top y &\\\\\n",
    "   \\text{subject to} \\quad\n",
    "     A^\\top y &\\geq c\\\\\n",
    "     0 &\\leq y.\n",
    "\n",
    "Since :math:`\\xi^*(b) < \\infty` for all :math:`b \\in \\mathbb{R}^m`, the weak\n",
    "duality theorem guarantees that :math:`\\zeta^*(b) > -\\infty`.  Furthermore,\n",
    "notice that each instance of :math:`\\zeta^*(b)` shares the same feasible region.\n",
    "This region can be described as a convex polyhedron (10.3), or more precisely a\n",
    "convex polytope according to :ref:`Exercise 10.1 <vanderbei2014linear-ex-10.1>`\n",
    "and Caratheodoryâ€™s theorem.\n",
    "\n",
    "The foregoing enables the application of the fundamental theorem of linear\n",
    "programming which states that the solution :math:`y_i` corresponding to\n",
    ":math:`\\zeta^*(b_i)` must occur at a vertex (extreme point) of the feasible set.\n",
    "Note that if the optimal solution occurs at two adjacent vertices of the\n",
    "feasible set, then the line segment joining the two vertices represents\n",
    "infinitely many solutions.\n",
    "\n",
    "Given :math:`\\left\\{ \\zeta^*(b_i), y_i \\right\\}_{i = 0}^1`,\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\zeta^*(b_2)\n",
    "    &= \\zeta^*\\left( t b_0 + (1 - t) b_1 \\right)\\\\\n",
    "    &= t b_0^\\top y_2 + (1 - t) b_1^\\top y_2\\\\\n",
    "    &= t \\zeta^*(b_0) +\n",
    "       (1 - t) \\zeta^*(b_1) +\n",
    "       t b_0^\\top \\Delta_{02} +\n",
    "       (1 - t) b_1^\\top \\Delta_{12}\n",
    "       & \\quad & y_2 = y_0 + \\Delta_{02} = y_1 + \\Delta_{12}\n",
    "\n",
    "where\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\zeta^*(b_0) \\leq b_0^\\top \\Delta_{02}\n",
    "   \\quad \\text{and} \\quad\n",
    "   \\zeta^*(b_1) \\leq b_1^\\top \\Delta_{12}.\n",
    "\n",
    "Observe that\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\zeta^*\\left( t b_0 + (1 - t) b_1 \\right) =\n",
    "   t \\zeta^*(b_0) + (1 - t) \\zeta^*(b_1)\n",
    "\n",
    "when the optimal solution to\n",
    ":math:`\\left\\{ \\zeta^*(b_i) \\right\\}_{i = 0}^2` is at same vertex or\n",
    ":math:`y_2` lies on the line segment between the two adjacent vertices\n",
    ":math:`y_0` and :math:`y_1`.  When :math:`y_0` and :math:`y_1` are non-adjacent\n",
    "vertices, :math:`\\left\\{ \\Delta_{i2} \\right\\}_{i = 0}^1` can be viewed as\n",
    "translating :math:`y` towards the optimal vertex :math:`y_2`.  Removing the\n",
    "translations would place :math:`y` at a non-optimal location that is interior to\n",
    "a line segment not perpendicular to the direction of improvement of the\n",
    "\"isoprofit\" hyperplanes i.e.\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\zeta^*\\left( t b_0 + (1 - t) b_1 \\right) <\n",
    "   t \\zeta^*(b_0) + (1 - t) \\zeta^*(b_1).\n",
    "\n",
    "Therefore, :math:`\\zeta^*(b)` is convex.  Consequently, by the strong duality\n",
    "theorem, :math:`\\xi^*(b)` is concave due to its formulation as a maximization\n",
    "problem."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.3\n",
    "=============\n",
    "\n",
    "Since :math:`P` and :math:`\\tilde{P}` could each represent an empty polyhedron,\n",
    "the proof needs to cover two additional cases.  The existing proof of Theorem\n",
    "10.4 still holds for the generalized halfspaces when the polyhedra are nonempty.\n",
    "\n",
    ":math:`P = \\emptyset` and :math:`\\tilde{P} = \\emptyset`\n",
    "-------------------------------------------------------\n",
    "\n",
    "Suppose\n",
    "\n",
    ".. math::\n",
    "\n",
    "   P = \\left\\{ x \\colon Ax \\leq b \\right\\} = \\emptyset\n",
    "   \\quad \\text{and} \\quad\n",
    "   \\tilde{P} = \\left\\{ x \\colon \\tilde{A} x \\leq \\tilde{b} \\right\\} = \\emptyset,\n",
    "\n",
    "which is equivalent to saying both systems of inequalities are infeasible.\n",
    "\n",
    "Since :math:`P` and :math:`\\tilde{P}` are empty sets, Farkas' Lemma (10.8)\n",
    "guarantees that :math:`Ay = 0` and :math:`\\tilde{A} y = 0`.  Consequently,\n",
    ":math:`H = \\emptyset` and :math:`\\tilde{H} = \\emptyset` because (10.7) still\n",
    "holds.  By inspection, the generalized halfspaces are disjoint.\n",
    "\n",
    "To see that :math:`P \\subset H` and :math:`\\tilde{P} \\subset \\tilde{H}`, recall\n",
    "that the empty set is a subset of every set including itself.\n",
    "\n",
    ":math:`P \\neq \\emptyset` and :math:`\\tilde{P} = \\emptyset`\n",
    "----------------------------------------------------------\n",
    "\n",
    "Suppose\n",
    "\n",
    ".. math::\n",
    "\n",
    "   P = \\left\\{ x \\colon Ax \\leq b \\right\\} \\neq \\emptyset\n",
    "   \\quad \\text{and} \\quad\n",
    "   \\tilde{P} = \\left\\{ x \\colon \\tilde{A} x \\leq \\tilde{b} \\right\\} = \\emptyset.\n",
    "\n",
    "The polyhedra are clearly disjoint by definition of disjoint sets, so (10.5)\n",
    "through (10.7) still holds.  However, even though :math:`P` is nonempty and\n",
    "the negation of Farkas' Lemma states that\n",
    "\n",
    ".. math::\n",
    "\n",
    "   A^\\top y &\\neq 0\\\\\n",
    "   b^\\top y &\\geq 0\\\\\n",
    "   y &\\geq 0,\n",
    "\n",
    "the fact that :math:`\\tilde{\\mathbf{A}}^\\top \\tilde{y} = 0` forces\n",
    ":math:`\\mathbf{A}^\\top y = 0`.  Furthermore, in order to satisfy (10.7),\n",
    ":math:`\\tilde{b}^\\top \\tilde{y} < 0`.  Consequently, :math:`H = \\mathbb{R}^n`\n",
    "and :math:`\\tilde{H} = \\emptyset`.  By inspection, the generalized halfspaces\n",
    "are disjoint as well as :math:`P \\subset H` and\n",
    ":math:`\\tilde{P} \\subset \\tilde{H}`."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.4\n",
    "=============\n",
    "\n",
    "The dual of the primal LP\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{P} \\quad \\text{maximize} \\quad\n",
    "       2 x_1 + x_2 &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       4 x_1 + 2 x_2 &\\leq 6\\\\\n",
    "       x_2 &\\leq 1\\\\\n",
    "       2 x_1 + x_2 &\\leq 3\\\\\n",
    "       0 &\\leq x_j \\quad j = 1, 2.\n",
    "   \\end{aligned}\n",
    "\n",
    "is\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{D} \\quad \\text{minimize} \\quad\n",
    "       6 y_1 + y_2 + 3 y_3 &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       4 y_1 + 2 y_3 &\\geq 2\\\\\n",
    "       2 y_1 + y_2 + y_3 &\\geq 1\\\\\n",
    "       0 &\\leq y_i \\quad i = 1, 2, 3.\n",
    "   \\end{aligned}\n",
    "\n",
    "The possible optimal solutions are\n",
    "\n",
    ".. math::\n",
    "\n",
    "   (x_1^* = 1.5, x_2^* = 0, w_1^* = 0, w_2^* = 1, w_3^* = 0)\n",
    "   \\quad\n",
    "   (x_1^* = 1, x_2^* = 1, w_1^* = 0, w_2^* = 0, w_3^* = 0)\n",
    "\n",
    "and\n",
    "\n",
    ".. math::\n",
    "\n",
    "   (y_1^* = 0.5, y_2^* = 0, y_3^* = 0, z_1^* = 0, z_2^* = 0)\n",
    "   \\quad\n",
    "   (y_1^* = 0, y_2^* = 0, y_3^* = 1, z_1^* = 0, z_2^* = 0).\n",
    "\n",
    "Notice that each primal (dual) solution is at an extreme point and the line\n",
    "segment joining the two primal (dual) solutions represents infinitely many\n",
    "solutions.\n",
    "\n",
    "The strictly complementary solutions can be defined as\n",
    "\n",
    ".. math::\n",
    "\n",
    "   (x_1^* = 1.5 \\alpha + (1 - \\alpha),\n",
    "       x_2^* = 1 - \\alpha, w_1^* = 0, w_2^* = \\alpha, w_3^* = 0)\n",
    "   \\quad \\text{and} \\quad\n",
    "   (y_1^* = 0.5 \\alpha, y_2^* = 0, y_3^* = 1 - \\alpha, z_1^* = 0, z_2^* = 0)\n",
    "\n",
    "where :math:`0 < \\alpha < 1`."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.5\n",
    "=============\n",
    "\n",
    "The proof for Theorem 10.3 does not address whether the vectors :math:`z_j` are\n",
    "linearly independent, which determines the rank of\n",
    ":math:`A \\in \\mathbb{R}^{m \\times n}`.  :cite:`angellbtlp` presents an algebraic\n",
    "proof of the Fundamental Theorem of Linear Programming showing that there exists\n",
    "at least one basic solution as long as :math:`\\text{rank}(A) = m`.  Note that\n",
    "Theorem 10.3 implies at most :math:`m + 1` points are needed.  It does not cover\n",
    "the scenarios where :math:`n < m + 1`."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.6\n",
    "=============\n",
    "\n",
    "Consider the following primal LP\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{P} \\quad \\text{maximize} \\quad\n",
    "       x_j &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       A \\mathbf{x} &\\leq \\mathbf{b}\\\\\n",
    "       -\\mathbf{c}^\\top \\mathbf{x} &\\leq -\\zeta^*\\\\\n",
    "       0 &\\leq \\mathbf{x}\n",
    "   \\end{aligned}\n",
    "\n",
    "and its dual\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{D} \\quad \\text{minimize} \\quad\n",
    "       \\mathbf{b}^\\top \\mathbf{y} - \\zeta^* t &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       A^\\top \\mathbf{y} - \\mathbf{c} t &\\geq \\mathbf{e}_j\\\\\n",
    "       0 &\\leq \\mathbf{y}, t.\n",
    "   \\end{aligned}\n",
    "\n",
    "The dual written with slack variables is\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{D} \\quad \\text{minimize} \\quad\n",
    "       \\mathbf{b}^\\top \\mathbf{y} - \\zeta^* t &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       A^\\top \\mathbf{y} - \\mathbf{c} t - \\mathbf{z} &= \\mathbf{e}_j\\\\\n",
    "       0 &\\leq \\mathbf{y}, \\mathbf{z}, t.\n",
    "   \\end{aligned}\n",
    "\n",
    "If there is an optimal primal solution :math:`\\mathbf{x}^*` for which\n",
    ":math:`x^*_j > 0`, then the :math:`j\\text{th}` dual slack variable is\n",
    "irrelevant.\n",
    "\n",
    "Suppose :math:`x_j = 0` for every optimal solution.  By the strong duality\n",
    "theorem, all the dual constraints are satisfied and\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\mathbf{b}^\\top \\mathbf{y} - \\zeta^* t = 0.\n",
    "\n",
    ":math:`t > 0`\n",
    "-------------\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathbf{b}^\\top \\frac{\\mathbf{y}}{t} - \\zeta^* &= 0\\\\\n",
    "     \\mathbf{b}^\\top \\mathbf{y}^* &= \\zeta^*\n",
    "   \\end{aligned}\n",
    "   \\quad \\text{and} \\quad\n",
    "   \\begin{aligned}\n",
    "     A^\\top \\frac{\\mathbf{y}}{t} - \\frac{\\mathbf{z} + \\mathbf{e}_j}{t}\n",
    "      &= \\mathbf{c}\\\\\n",
    "     A^\\top \\mathbf{y}^* - \\mathbf{z}^* &= \\mathbf{c}\\\\\n",
    "   \\end{aligned}\n",
    "\n",
    "Notice that :math:`\\mathbf{y}^* = \\mathbf{y} / t` and\n",
    ":math:`\\mathbf{z}^* = (\\mathbf{z} + \\mathbf{e}_j) / t` are optimal solutions\n",
    "that satisfies (10.10).\n",
    "\n",
    ":math:`t = 0`\n",
    "-------------\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\mathbf{b}^\\top \\mathbf{y} = 0\n",
    "   \\quad \\text{and} \\quad\n",
    "   A^\\top \\mathbf{y} - (\\mathbf{z} + \\mathbf{e}_j) = 0\n",
    "\n",
    "Notice that for any optimal dual solution :math:`(\\mathbf{y}^*, \\mathbf{z}^*)`,\n",
    ":math:`(\\mathbf{y}^* + \\mathbf{y}, \\mathbf{z}^* + \\mathbf{z} + \\mathbf{e}_j)` is\n",
    "also an optimal dual solution satisfying (10.10)."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    "Exercise 10.7\n",
    "=============\n",
    "\n",
    "The dual of the linear program (LP)\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{P} \\quad \\text{maximize} \\quad c^\\top x &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       Ax &\\leq b\\\\\n",
    "       0 &\\leq x\n",
    "   \\end{aligned}\n",
    "   \\quad \\overset{\\text{(10.9)}}{\\iff} \\quad\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{P} \\quad \\text{maximize} \\quad c^\\top x &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       Ax + w &= b\\\\\n",
    "       0 &\\leq x, w\n",
    "   \\end{aligned}\n",
    "\n",
    "is\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{D} \\quad \\text{minimize} \\quad b^\\top y &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       A^\\top y &\\geq c\\\\\n",
    "       0 &\\leq y\n",
    "   \\end{aligned}\n",
    "   \\quad \\overset{\\text{(10.10)}}{\\iff} \\quad\n",
    "   \\begin{aligned}\n",
    "     \\mathcal{D} \\quad \\text{minimize} \\quad b^\\top y &\\\\\n",
    "     \\text{subject to} \\quad\n",
    "       A^\\top y - z &= c\\\\\n",
    "       0 &\\leq y, z.\n",
    "   \\end{aligned}\n",
    "\n",
    "The proof for this (a.k.a. Clarkâ€™s Theorem :cite:`orie6300`) is by\n",
    "contradiction.  Suppose the linear program has feasible solutions, the dual has\n",
    "null variables, and the set of primal feasible solutions is bounded.  By the\n",
    "fundamental theorem of linear programming, there exist optimal solutions.\n",
    "\n",
    "Consider the following dual LP:\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\mathcal{D} \\quad \\text{minimize} \\quad -y_i &\\\\\n",
    "   \\text{subject to} \\quad\n",
    "     A^\\top y &\\geq c\\\\\n",
    "     0 &\\leq y\n",
    "\n",
    "where the dual null variable :math:`y_i = 0` for all feasible solutions.  Since\n",
    "its constraints matches the original dual problem, this LP is feasible and has\n",
    "an optimal solution at zero.\n",
    "\n",
    "The corresponding primal LP is\n",
    "\n",
    ".. math::\n",
    "\n",
    "   \\mathcal{P} \\quad \\text{maximize} \\quad c^\\top x &\\\\\n",
    "   \\text{subject to} \\quad\n",
    "     A x &\\leq -e_i\\\\\n",
    "     0 &\\leq x.\n",
    "\n",
    "By the strong duality theorem, the primal has an optimal solution such that\n",
    ":math:`Ax' + w' = -e_i` and :math:`x', w' \\geq 0`.\n",
    "\n",
    "Let :math:`(x, w)` be any feasible solution to the original LP.  Since the\n",
    "feasible region is a convex polytope, :math:`x + \\lambda x'` is feasible for the\n",
    "primal for any :math:`\\lambda \\geq 0` and its slack is\n",
    ":math:`w + \\lambda (w' + e_j)`.  By inspection, there is no upper bound for the\n",
    "maximization of :math:`c^\\top \\left( x + \\lambda x' \\right)`.  This\n",
    "contradiction shows that the feasible region for the original primal LP is\n",
    "unbounded."
   ]
  },
  {
   "cell_type": "raw",
   "metadata": {
    "raw_mimetype": "text/restructuredtext"
   },
   "source": [
    ".. rubric:: References\n",
    "\n",
    ".. bibliography:: chapter-10.bib"
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "celltoolbar": "Raw Cell Format",
  "kernelspec": {
   "display_name": "Python [default]",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.5.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
