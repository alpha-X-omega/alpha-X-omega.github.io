<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Exponential Family Harmoniums with an Application to Information Retrieval &#8212; All Things Phi</title>
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/my-styles.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="shortcut icon" href="../../../../_static/phi.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Pose Space Deformation: A Unified Approach to Shape Interpolation and Skeleton-Driven Deformation" href="../04/pose-space-deformation-a-unified-approach-to-shape-interpolation-and-skeleton-driven-deformation.html" />
    <link rel="prev" title="One Weird Trick for Parallelizing Convolutional Neural Networks" href="../06/one-weird-trick-for-parallelizing-convolutional-neural-networks.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../../index.html">
          All Things Phi</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../../index.html">Archive <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../20/mask-r-cnn.html">Mask R-CNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../19/rich-feature-hierarchies-for-accurate-object-detection-and-semantic-segmentation.html">Rich Feature Hierarchies for Accurate Object Detection and Semantic Segmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../18/watertight-ray-triangle-intersection.html">Watertight Ray/Triangle Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../17/understanding-deep-learning-requires-rethinking-generalization.html">Understanding Deep Learning Requires Rethinking Generalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../16/accurate-large-minibatch-sgd-training-imagenet-in-1-hour.html">Accurate, Large Minibatch SGD: Training ImageNet in 1 Hour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15/on-large-batch-training-for-deep-learning-generalization-gap-and-sharp-minima.html">On Large-Batch Training for Deep Learning: Generalization Gap and Sharp Minima</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14/layer-normalization.html">Layer Normalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13/batch-normalization-accelerating-deep-network-training-by-reducing-internal-covariate-shift.html">Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12/deep-residual-learning-for-image-recognition.html">Deep Residual Learning for Image Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11/optimal-step-nonrigid-icp-algorithms-for-surface-registration.html">Optimal Step Nonrigid ICP Algorithms for Surface Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10/delving-deep-into-rectifiers-surpassing-human-level-performance-on-imagenet-classification.html">Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09/least-squares-estimation-of-transformation-parameters-between-two-point-patterns.html">Least-Squares Estimation of Transformation Parameters Between Two Point Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08/a-fast-learning-algorithm-for-deep-belief-nets.html">A Fast Learning Algorithm for Deep Belief Nets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07/a-view-of-the-EM-algorithm-that-justifies-incremental-sparse-and-other-variants.html">A View of the EM Algorithm that Justifies Incremental, Sparse, and Other Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06/one-weird-trick-for-parallelizing-convolutional-neural-networks.html">One Weird Trick for Parallelizing Convolutional Neural Networks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exponential Family Harmoniums with an Application to Information Retrieval</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04/pose-space-deformation-a-unified-approach-to-shape-interpolation-and-skeleton-driven-deformation.html">Pose Space Deformation: A Unified Approach to Shape Interpolation and Skeleton-Driven Deformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02/learning-internal-representations-by-error-propagation.html">Learning Internal Representations by Error Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01/structuring-a-renderer-phi-ray.html">Structuring a Renderer: <span class="math notranslate nohighlight">\(\varphi\)</span>-Ray</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/30/information-processing-in-dynamical-systems-foundations-of-harmony-theory.html">Information Processing in Dynamical Systems: Foundations of Harmony Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/29/an-introduction-to-the-conjugate-gradient-method-without-the-agonizing-pain.html">An Introduction to the Conjugate Gradient Method Without the Agonizing Pain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/28/a-learning-algorithm-for-boltzmann-machines.html">A Learning Algorithm for Boltzmann Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/27/geometric-skinning-with-approximate-dual-quaternion-blending.html">Geometric Skinning with Approximate Dual Quaternion Blending</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/26/the-perceptron-a-probabilistic-model-for-information-storage-and-organization-in-the-brain.html">The Perceptron: A Probabilistic Model for Information Storage and Organization in the Brain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/25/the-sharpe-ratio.html">The Sharpe Ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/24/neural-networks-and-physical-systems-with-emergent-collective-computational-abilities.html">Neural Networks and Physical Systems with Emergent Collective Computational Abilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/23/training-products-of-experts-by-minimizing-contrastive-divergence.html">Training Products of Experts by Minimizing Contrastive Divergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/22/market-timing-with-candlestick-technical-analysis.html">Market Timing with Candlestick Technical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/21/all-that-glitters-is-not-gold-comparing-backtest-and-out-of-sample-performance-on-a-large-cohort-of-trading-algorithms.html">All that Glitters is Not Gold: Comparing Backtest and Out-of-Sample Performance on a Large Cohort of Trading Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/20/easy-volatility-investing.html">Easy Volatility Investing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/19/a-tutorial-on-helmholtz-machines.html">A Tutorial on Helmholtz Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/18/when-do-stop-loss-rules-stop-losses.html">When Do Stop-Loss Rules Stop Losses?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/17/a-simple-implicit-measure-of-the-effective-bid-ask-spread-in-an-efficient-market.html">A Simple Implicit Measure of the Effective Bid-Ask Spread in an Efficient Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/16/asset-prices-and-trading-volume-under-fixed-transactions-costs.html">Asset Prices and Trading Volume Under Fixed Transactions Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/15/maxout-networks.html">Maxout Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/14/dropout-a-simple-way-to-prevent-neural-networks-from-overfitting.html">Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/13/dropout-training-as-adaptive-regularization.html">Dropout Training as Adaptive Regularization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/12/model-compression.html">Model Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/11/distilling-the-knowledge-in-a-neural-network.html">Distilling the Knowledge in a Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/10/do-deep-nets-really-need-to-be-deep.html">Do Deep Nets Really Need to be Deep?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/09/efficient-backprop.html">Efficient Backprop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/08/stochastic-gradient-descent-tricks.html">Stochastic Gradient Descent Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/07/automatic-differentiation-in-machine-learning-a-survey.html">Automatic Differentiation in Machine Learning: A Survey</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/06/econometric-models-of-limit-order-executions.html">Econometric Models of Limit-Order Executions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/05/multilayer-feedforward-networks-are-universal-approximators.html">Multilayer Feedforward Networks are Universal Approximators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/04/dendritic-computation.html">Dendritic Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/03/understanding-order-flow.html">Understanding Order Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/02/optimal-control-of-execution-costs.html">Optimal Control of Execution Costs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../11/01/risks-and-portfolio-decisions-involving-hedge-funds.html">Risks and Portfolio Decisions Involving Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/30/coordinate-systems.html">Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/28/hedge-funds-the-living-and-the-dead.html">Hedge Funds: The Living and the Dead</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/24/do-hedge-funds-have-enough-capital-a-value-at-risk-approach.html">Do Hedge Funds Have Enough Capital?  A Value-at-Risk Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/23/characterizing-computer-performance-with-a-single-number.html">Characterizing Computer Performance with a Single Number</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/22/how-to-not-lie-with-statistics-the-correct-way-to-summarize-benchmark-results.html">How Not to Lie with Statistics: The Correct Way to Summarize Benchmark Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/19/an-econometric-analysis-of-serial-correlation-and-illiquidity-in-hedge-fund-returns.html">An Econometric Analysis of Serial Correlation and Illiquidity in Hedge-Fund Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/13/empirical-characteristics-of-dynamic-trading-strategies-the-case-of-hedge-funds.html">Empirical Characteristics of Dynamic Trading Strategies: The Case of Hedge Funds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/06/orange-juice-and-weath.html">Orange Juice and Weather</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/04/the-adaptive-markets-hypothesis-market-efficiency-from-an-evolutionary-perspective.html">The Adaptive Markets Hypothesis: Market Efficiency from an Evolutionary Perspective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../10/02/do-asset-prices-reflect-fundamentals-freshly-squeezed-evidence-from-the-oj-market.html">Do Asset Prices Reflect Fundamentals?  Freshly Squeezed Evidence from the OJ Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/30/neuroeconomics-how-neuroscience-can-inform-economics.html">Neuroeconomics: How Neuroscience Can Inform Economics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/28/drawing-inferences-from-statistics-based-on-multiyear-asset-returns.html">Drawing Inferences from Statistics based on Multiyear Asset Returns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/26/when-are-contrarian-profits-due-to-stock-market-overreaction.html">When are Contrarian Profits Due to Stock Market Overreaction?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/24/profitability-of-momentum-strategies-an-evaluation-of-alternative-explanations.html">Profitability of Momentum Strategies: An Evaluation of Alternative Explanations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/22/the-restrictions-on-predictability-implied-by-rational-asset-pricing.html">The Restrictions on Predictability Implied by Rational Asset Pricing Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/20/the-myth-of-long-horizon-predictability.html">The Myth of Long-Horizon Predictability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/18/the-standard-error-of-regressions.html">The Standard Error of Regressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/16/lets-take-the-con-out-of-econometrics.html">Let’s Take the Con Out of Econometrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/14/role-of-models-in-statistical-analysis.html">Role of Models in Statistical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../09/12/the-experimental-generation-of-interpersonal-closeness-a-procedure-and-some-preliminary-findings.html">The Experimental Generation of Interpersonal Closeness: A Procedure and Some Preliminary Findings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../08/02/notes-on-tensorflow.html">Notes on TensorFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../08/01/tensorflow-tensorboard-and-docker.html">TensorFlow, TensorBoard, and Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/13/review-and-analysis-of-solutions-of-the-three-point-perspective-pose-estimation-problem.html">Review and Analysis of Solutions of the Three Point Perspective Pose Estimation Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/12/variational-learning-for-switching-state-space-models.html">Variational Learning for Switching State-Space Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/11/bayesian-face-recognition.html">Bayesian Face Recognition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/10/robust-generative-subspace-modeling-the-subspace-t-distribution.html">Robust Generative Subspace Modeling: The Subspace <span class="math notranslate nohighlight">\(t\)</span> Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/09/robust-subspace-mixture-models-using-t-distributions.html">Robust Subspace Mixture Models using <span class="math notranslate nohighlight">\(t\)</span>-distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/08/robust-mixture-modelling-using-the-t-distribution.html">Robust Mixture Modelling using the <span class="math notranslate nohighlight">\(t\)</span>-distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/07/mixtures-of-probabilistic-principal-component-analyzers.html">Mixtures of Probabilistic Principal Component Analysers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/06/the-em-algorithm-for-mixtures-of-factor-analyzers.html">The EM Algorithm for Mixtures of Factor Analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/05/3d-live-real-time-captured-content-for-mixed-reality.html">3D Live: Real Time Captured Content for Mixed Reality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/04/high-accuracy-stereo-depth-maps-using-structured-light.html">High-Accuracy Stereo Depth Maps Using Structured Light</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/03/simple-accurate-and-robust-projector-camera-calibration.html">Simple, Accurate, and Robust Projector-Camera Calibration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/02/multiresolution-gray-scale-and-rotation-invariant-texture-classification-with-local-binary-patterns.html">Multiresolution Gray Scale and Rotation Invariant Texture Classification with Local Binary Patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01/01/generative-or-discriminative-getting-the-best-of-both-worlds.html">Generative or Discriminative?  Getting the Best of Both Worlds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/02/01/seda-an-architecture-for-well-conditioned,-scalable-internet-services.html">SEDA: An Architecture for Well-Conditioned, Scalable Internet Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/26/reconciling-environment-integration-and-component-independence.html">Reconciling Environment Integration and Component Independence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/25/design-patterns-abstraction-and-reuse-of-object-oriented-design.html">Design Patterns: Abstraction and Reuse of Object-Oriented Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/24/a-guide-to-metaphorical-design.html">A Guide to Metaphorical Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/23/a-spiral-model-of-software-development-and-enhancement.html">A Spiral Model of Software Development and Enhancement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/22/sequential-and-concurrent-object-oriented-programming.html">Sequential and Concurrent Object-Oriented Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/21/software-aging.html">Software Aging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/20/applying-design-by-contract.html">Applying “Design by Contract”</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/19/predicate-logic-for-software-engineering.html">Predicate Logic for Software Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/18/active-design-reviews-principles-and-practices.html">Active Design Reviews: Principles and Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/17/a-rational-design-process-how-and-why-to-fake-it.html">A Rational Design Process: How and Why to Fake It</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/16/the-modular-structure-of-complex-systems.html">The Modular Structure of Complex Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/15/abstract-types-defined-as-classes-of-variables.html">Abstract Types Defined as Classes of Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/14/use-of-abstract-interfaces-in-the-development-of-software-for-embedded-computer-systems.html">Use of Abstract Interfaces in the Development of Software for Embedded Computer Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/13/the-influence-of-software-structure-on-reliability.html">The Influence of Software Structure on Reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/12/response-to-detected-errors-in-well-structured-programs.html">Response to Detected Errors in Well-Structured Programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/11/the-use-of-abstract-data-types-to-simplify-program-modifications.html">The Use of Abstract Data Types to Simplify Program Modifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/10/use-of-the-concept-of-transparency-in-the-design-of-hierarchically-structured-systems.html">Use of the Concept of Transparency in the Design of Hierarchically Structured Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/09/designing-software-for-ease-of-extension-and-contraction.html">Designing Software for Ease of Extension and Contraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/08/on-the-design-and-development-of-program-families.html">On the Design and Development of Program Families</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/07/on-the-criteria-to-be-used-in-decomposing-systems-into-modules.html">On the Criteria to be Used in Decomposing Systems into Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/06/a-technique-for-software-module-specification-with-examples.html">A Technique for Software Module Specification with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/05/information-distribution-aspects-of-design-methodology.html">Information Distribution Aspects of Design Methodology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/04/a-model-of-large-program-development.html">A Model of Large Program Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/03/architectural-styles-and-the-design-of-network-based-software-architectures.html">Architectural Styles and the Design of Network-based Software Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/02/design-of-design.html">Design of Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2014/01/01/notes-on-the-synthesis-of-form.html">Notes on the Synthesis of Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/26/blogging-with-docker.html">Blogging with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/25/typical-mercurial-usage.html">Typical Mercurial Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/24/profiling-on-linux.html">Profiling on Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/23/trading-cryptocurrencies.html">Trading Cryptocurrencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/22/notes-on-software-design.html">Notes on Software Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/21/notes-on-scraping-together-a-heterogeneous-system.html">Notes on Scraping Together a Heterogeneous System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/20/transfer-media-files-to-mobile-device-via-vlc.html">Transfer Media Files to Mobile Device via VLC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/19/style-lessons-in-clarity-and-grace.html">Style: Lessons in Clarity and Grace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/18/the-science-of-scientific-writing.html">The Science of Scientific Writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/17/collection-of-notes-on-research.html">Collection of Notes on Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/16/typical-ffmpeg-usage.html">Typical FFmpeg Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/15/generate-svg-graphics.html">Generate SVG Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/14/blogging-with-restructuredtext-a-google-domain-and-sphinx.html">Blogging with RestructuredText, a Google Domain, and Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/13/set-up-android-development-environment.html">Set Up Android Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/12/svegan-lifestyle.html">Svegan Lifestyle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/11/set-up-system-programming-environment.html">Set Up System Programming Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/10/the-rise-and-fall-of-react-flux-redux-and-cycle.html">The Rise and Fall of React, Flux, Redux, and Cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/09/install-graphics-and-compute-linux-mint.html">Install Graphics and Compute on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/08/set-up-web-development-environment.html">Set Up Web Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/07/vfio-tips-and-tricks.html">VFIO Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/06/options-trading.html">Options Trading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/05/assimp-mesh-loader.html">Assimp Mesh Loader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/04/set-up-data-analysis-environment.html">Set Up Data Analysis Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/03/install-nvidia-drivers-on-linux-mint.html">Install Nvidia Drivers on Linux Mint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/02/blogging-with-restructuredtext-a-google-domain-and-pelican.html">Blogging with RestructuredText, a Google Domain, and Pelican</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../2013/01/01/linux-mint-installation.html">Linux Mint Installation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/an-invitation-to-3d-vision-msks/index.html">An Invitation to 3-D Vision - Ma, Soatto, Kosecka, and Sastry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/complete-musician-laitz/index.html">The Complete Musician: An Integrated Approach to Tonal Theory, Analysis, and Listening - Laitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/computer-science-theory-for-the-information-age-hk/index.html">Computer Science Theory for the Information Age - Hopcroft &amp; Kannan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/computer-vision-models-learning-and-inference-prince/index.html">Computer Vision: Models, Learning, and Inference - Prince</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/creativity-nlph/index.html">Creativity - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/differential-geometry-from-a-graphics-perspective-nlph/index.html">Differential Geometry from a Graphics Perspective - NLPH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/fundamentals-of-electric-circuits-as/index.html">Fundamentals of Electric Circuits - Alexander &amp; Sadiku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/linear-programming-vanderbei/index.html">Linear Programming - Vanderbei</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/multiple-view-geometry-hz/index.html">Multiple View Geometry in Computer Vision - Hartley &amp; Zisserman</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/numerical-methods-for-unconstrained-optimization-and-nonlinear-equations-ds/index.html">Numerical Methods for Unconstrained Optimization and Nonlinear Equations - Dennis &amp; Schnabel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/pattern-recognition-and-machine-learning-bishop/index.html">Pattern Recognition and Machine Learning - Bishop</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/reinforcement-learning-sb/index.html">Reinforcement Learning: An Introduction - Sutton &amp; Barto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nb/stat-labs-ns/index.html">Stat Labs - Nolan &amp; Speed</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Exponential Family Harmoniums with an Application to Information Retrieval</a><ul>
<li><a class="reference internal" href="#motivation-s">Motivation(s)</a></li>
<li><a class="reference internal" href="#proposed-solution-s">Proposed Solution(s)</a></li>
<li><a class="reference internal" href="#evaluation-s">Evaluation(s)</a></li>
<li><a class="reference internal" href="#future-direction-s">Future Direction(s)</a></li>
<li><a class="reference internal" href="#question-s">Question(s)</a></li>
<li><a class="reference internal" href="#analysis">Analysis</a></li>
<li><a class="reference internal" href="#notes">Notes</a><ul>
<li><a class="reference internal" href="#general-exponential-families">General Exponential Families</a></li>
<li><a class="reference internal" href="#exponential-family-harmonium">Exponential Family Harmonium</a></li>
<li><a class="reference internal" href="#bernoulli-bernoulli">Bernoulli-Bernoulli</a></li>
<li><a class="reference internal" href="#gaussian-bernoulli">Gaussian-Bernoulli</a></li>
<li><a class="reference internal" href="#bernoulli-gaussian">Bernoulli-Gaussian</a></li>
<li><a class="reference internal" href="#gaussian-gaussian">Gaussian-Gaussian</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="../06/one-weird-trick-for-parallelizing-convolutional-neural-networks.html" title="Previous Chapter: One Weird Trick for Parallelizing Convolutional Neural Networks"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; One Weird Tri...</span>
    </a>
  </li>
  <li>
    <a href="../04/pose-space-deformation-a-unified-approach-to-shape-interpolation-and-skeleton-driven-deformation.html" title="Next Chapter: Pose Space Deformation: A Unified Approach to Shape Interpolation and Skeleton-Driven Deformation"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Pose Space De... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="exponential-family-harmoniums-with-an-application-to-information-retrieval">
<h1>Exponential Family Harmoniums with an Application to Information Retrieval<a class="headerlink" href="#exponential-family-harmoniums-with-an-application-to-information-retrieval" title="Permalink to this headline">¶</a></h1>
<div class="section" id="motivation-s">
<h2>Motivation(s)<a class="headerlink" href="#motivation-s" title="Permalink to this headline">¶</a></h2>
<p>Graphical models with latent variables is one way to capture hidden structure in
the data.  With as few as two layers, many datasets can be modeled accurately
using directed models such as</p>
<ul class="simple">
<li><p>mixture of Gaussians,</p></li>
<li><p>probabilistic PCA,</p></li>
<li><p>factor analysis,</p></li>
<li><p>independent component analysis,</p></li>
<li><p>sigmoid belief networks,</p></li>
<li><p>latent trait models, latent Dirichlet allocation a.k.a. multinomial PCA,</p></li>
<li><p>exponential PCA,</p></li>
<li><p>probabilistic latent semantic indexing,</p></li>
<li><p>non-negative matrix factorization, and</p></li>
<li><p>multiple multiplicative factor.</p></li>
</ul>
<p>This family of models dictates marginal independence of the latent variables, so
(ancestral) sampling becomes trivial at the expense of making the inference of
the posterior distribution of the latent variables given the observations
intractable.  Algorithms that need said posterior resort to approximations or
slow iterative procedures.</p>
<p>The undirected analogue of the aforementioned family of models is the harmonium.
Inference in these models is very fast because latent variables are
conditionally independent given the observations.  Furthermore, the product
structure of harmoniums can model distributions with sharp boundaries, and
adding a new expert may decrease or increase the variance of the distribution.
The harmonium’s most important disadvantage is the presence of a global
normalization factor that complicates both the evaluation of probabilities of
input vectors and learning free parameters from examples.</p>
</div>
<div class="section" id="proposed-solution-s">
<h2>Proposed Solution(s)<a class="headerlink" href="#proposed-solution-s" title="Permalink to this headline">¶</a></h2>
<p>Harmoniums have only been considered in the context of discrete binary variables
and more recently in the Gaussian case.  The authors propose exponential
family harmoniums (EFHs), an extension of bipartite harmoniums into the
exponential family.  Their goal is to demonstrate that harmoniums can be a
viable alternative or complementary to directed models.</p>
</div>
<div class="section" id="evaluation-s">
<h2>Evaluation(s)<a class="headerlink" href="#evaluation-s" title="Permalink to this headline">¶</a></h2>
<p>The authors propose an EFH for latent semantic indexing.  The precision-recall
curves indicate that EFH beats LSI, TF-IDF, and LDA.  Its application of
contrastive divergence enables the model to handle an exponentially large number
of documents.  EFH allows a principled way to deal with unobserved entries by
inferring them using the model with mean field calculations; all the other
methods ignore unobserved entries.  The same model with Gaussian units in both
hidden and observed layers has been shown to be equivalent to factor analysis.</p>
</div>
<div class="section" id="future-direction-s">
<h2>Future Direction(s)<a class="headerlink" href="#future-direction-s" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Different learning rules result when the normalization constant is changed,
but their structure is very similar.  Are these relationships coincidental or
are actually useful?</p></li>
</ul>
</div>
<div class="section" id="question-s">
<h2>Question(s)<a class="headerlink" href="#question-s" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How much would the accuracy improve if the model included higher order
interaction terms?</p></li>
</ul>
</div>
<div class="section" id="analysis">
<h2>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline">¶</a></h2>
<p>EFH provides an elegant framework to impose prior knowledge on each random
variable.</p>
<p>The only complaint about this paper is its omission of the derivations.  Those
could be provided as a supplement instead of having the reader rederive
everything.</p>
<p>Applying the model to existing RBM models reveals the assumptions on the
interaction term.  This insight enables one to be less arbitrary in designing
models.  Another interesting result is how an EFH can be interpreted as a
<a class="reference internal" href="../../11/23/training-products-of-experts-by-minimizing-contrastive-divergence.html"><span class="doc">product of experts</span></a>.</p>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-exponential-families">
<h3>General Exponential Families<a class="headerlink" href="#general-exponential-families" title="Permalink to this headline">¶</a></h3>
<p>Suppose that <span class="math notranslate nohighlight">\(X\)</span> is a random variable taking values in
<span class="math notranslate nohighlight">\(\mathcal{S}\)</span>, and that the distribution of <span class="math notranslate nohighlight">\(X\)</span> depends on an
unspecified parameter <span class="math notranslate nohighlight">\(\theta\)</span> taking values in a parameter space
<span class="math notranslate nohighlight">\(\Theta\)</span>.  The distribution of <span class="math notranslate nohighlight">\(X\)</span> is a <span class="math notranslate nohighlight">\(k\)</span>-parameter
exponential family if it can be expressed as</p>
<div class="math notranslate nohighlight">
\[f_\theta(x) =
\alpha(\theta) g(x) \exp\left(
  \sum_{i = 1}^k \beta_i(\theta) h_i(x)
\right);
\qquad
x \in \mathcal{S}, \theta \in \Theta, \alpha(\theta) \geq 0, g(x) \geq 0\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\left( \beta_1, \ldots, \beta_k \right)\)</span> are
real-valued functions on <span class="math notranslate nohighlight">\(\Theta\)</span>, and where <span class="math notranslate nohighlight">\(g\)</span> and
<span class="math notranslate nohighlight">\(\left( h_1, \ldots, h_k \right)\)</span> are real-valued functions on
<span class="math notranslate nohighlight">\(\mathcal{S}\)</span>.  Furthermore, <span class="math notranslate nohighlight">\(k\)</span> is assumed to be the smallest
possible integer.  The parameters <span class="math notranslate nohighlight">\(\{ \beta_i(\theta) \}\)</span> are called the
natural paramaters of the distribution, and the random variables
<span class="math notranslate nohighlight">\(\{ h_i(X) \}\)</span> are tagged as the natural statistics of the distribution.</p>
</div>
<div class="section" id="exponential-family-harmonium">
<h3>Exponential Family Harmonium<a class="headerlink" href="#exponential-family-harmonium" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{x} = \left\{ x_i \right\}_{i = 1}^{M_v}\)</span> be the set of
observed random variables and
<span class="math notranslate nohighlight">\(\mathbf{h} = \left\{ h_j \right\}_{j = 1}^{M_h}\)</span> be the set of hidden
(latent) variables.  Both <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{h}\)</span> can take on
values in either the continuous or the discrete domain.  The distribution of
each random variable is chosen independently from the exponential family as</p>
<div class="math notranslate nohighlight">
\[\begin{split}p_i(x_i; \boldsymbol{\theta}_i)
 &amp;= \frac{1}{A'_i\left( \boldsymbol{\theta}_i \right)}
    r_i(x_i) \exp\left[ \sum_{a'} \theta_{ia'} f_{ia'}(x_i) \right]\\
 &amp;= \frac{1}{A'_i\left( \boldsymbol{\theta}_i \right)}
    \exp\left[ \sum_a \theta_{ia} f_{ia}(x_i) \right]
    &amp; \quad &amp; \theta_{ia} = 1 \text{ and } f_{ia}(x_i) = \log r_i(x_i)
              \text{ when } a = 0\\
 &amp;= \exp\left[
      \sum_a \theta_{ia} f_{ia}(x_i) -
      A_i\left( \boldsymbol{\theta}_i \right)
    \right]
    &amp; \quad &amp; A_i\left( \boldsymbol{\theta}_i \right) =
              \log \sum_{x'_i} \exp \sum_a \theta_{ia} f_{ia}(x'_i)\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p_j(h_j; \boldsymbol{\lambda}_j)
 &amp;= \frac{1}{B'_j\left( \boldsymbol{\lambda}_j \right)}
    s_j(h_j) \exp\left[ \sum_{b'} \lambda_{jb'} g_{jb'}(h_j) \right]\\
 &amp;= \frac{1}{B'_j\left( \boldsymbol{\lambda}_j \right)}
    \exp\left[ \sum_b \lambda_{jb} g_{jb}(h_j) \right]
    &amp; \quad &amp; \lambda_{jb} = 1 \text{ and } g_{jb}(h_j) = \log s_j(h_j)
              \text{ when } b = 0\\
 &amp;= \exp\left[
      \sum_b \lambda_{jb} g_{jb}(h_j) -
      B_j\left( \boldsymbol{\lambda}_j \right)
    \right]
    &amp; \quad &amp; B_j\left( \boldsymbol{\lambda}_j \right) =
              \log \sum_{h'_j} \exp \sum_b \lambda_{jb} g_{jb}(h'_j)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\left\{ f_{ia}(x_i), g_{jb}(h_j) \right\}\)</span> are sufficient
statistics for the models,
<span class="math notranslate nohighlight">\(\left\{ \boldsymbol{\theta}_i, \boldsymbol{\lambda}_j \right\}\)</span> the
canonical parameters of the models, and
<span class="math notranslate nohighlight">\(\left\{ A_i, B_j \right\}\)</span> the log-partition functions.</p>
<p>To model the pairwise interactions between random variables <span class="math notranslate nohighlight">\(x_i\)</span> and
<span class="math notranslate nohighlight">\(h_j\)</span>, the authors introduce a quadratic interaction term to the joint
distribution</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{x}, \mathbf{h})
 &amp;= \frac{
      \exp\left[
        \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
        \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    }{
      \sum_{\mathbf{x}', \mathbf{h}'} \exp\left[
        \sum_{i, a} \theta_{ia} f_{ia}(x'_i) +
        \sum_{j, b} \lambda_{jb} g_{jb}(h'_j) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x'_i) g_{jb}(h'_j)
      \right]
    }\\
 &amp;= Z^{-1} \exp E(\mathbf{x}, \mathbf{h}; \phi)
    &amp; \quad &amp; \phi =
              \left\{
                \boldsymbol{\theta}_i, \boldsymbol{\lambda}_j, \mathbf{W}_i^j
              \right\}.\end{split}\]</div>
<p>As a consequence of this construction,</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{x} \mid \mathbf{h})
 &amp;= \frac{
      p(\mathbf{x}, \mathbf{h})
    }{
      \sum_{\mathbf{x}'} p(\mathbf{x}', \mathbf{h})
    }\\
 &amp;= \frac{
      \exp\left[
        \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    }{
      \sum_{\mathbf{x}'} \exp\left[
        \sum_{i, a} \theta_{ia} f_{ia}(x'_i) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x'_i) g_{jb}(h_j)
      \right]
    }
    &amp; \quad &amp; \text{cancel out } \lambda_{jb}\\
 &amp;= \frac{
      \prod_i \exp \sum_a \hat{\theta}_{ia} f_{ia}(x_i)
    }{
      \left(
        \sum_{x'_1} \exp \sum_a \hat{\theta}_{1a} f_{1a}(x'_1)
      \right)
      \cdots
      \left(
        \sum_{x'_{M_v}}
          \exp \sum_a \hat{\theta}_{{M_v}a} f_{{M_v}a}(x'_{M_v})
      \right)
    }
    &amp; \quad &amp; \hat{\theta}_{ia} =
              \theta_{ia} + \sum_{j, b} W_{ia}^{jb} g_{jb}(h_j)\\
 &amp;= \prod_{i = 1}^{M_v}
      \exp\left[
        \sum_a \hat{\theta}_{ia} f_{ia}(x_i) -
        A_i\left( \hat{\boldsymbol{\theta}}_i \right)
      \right]\\
 &amp;= \prod_i p(x_i \mid \mathbf{h})\\
 &amp;= \prod_i p_i(x_i; \hat{\boldsymbol{\theta}}_i)\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{h} \mid \mathbf{x})
 &amp;= \frac{
      p(\mathbf{h}, \mathbf{x})
    }{
      \sum_{\mathbf{h}} p(\mathbf{h}, \mathbf{x})
    }\\
 &amp;= \frac{
      \exp\left[
        \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    }{
      \sum_{\mathbf{h}'} \exp\left[
        \sum_{j, b} \lambda_{jb} g_{jb}(h'_j) +
        \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h'_j)
      \right]
    }
    &amp; \quad &amp; \text{cancel out } \theta_{ia}\\
 &amp;= \frac{
      \prod_j \exp \sum_b \hat{\lambda}_{jb} g_{jb}(h_j)
    }{
      \left(
        \sum_{h'_1} \exp \sum_b \hat{\lambda}_{1b} g_{1b}(h'_1)
      \right)
      \cdots
      \left(
        \sum_{h'_{M_h}}
          \exp \sum_b \hat{\lambda}_{{M_h}b} g_{{M_h}b}(h'_{M_h})
      \right)
    }
    &amp; \quad &amp; \hat{\lambda}_{jb} =
              \lambda_{jb} + \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i)\\
 &amp;= \prod_{j = 1}^{M_h}
      \exp\left[
        \sum_b \hat{\lambda}_{jb} g_{jb}(h_j) -
        B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
      \right]\\
 &amp;= \prod_j p(h_j \mid \mathbf{x})\\
 &amp;= \prod_j p_j(h_j; \hat{\boldsymbol{\lambda}}_j).\end{split}\]</div>
<p>The marginal distributions of the observed and latent variables are</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{x})
 &amp;= \frac{
      p(\mathbf{h}, \mathbf{x})
    }{
      p(\mathbf{h} \mid \mathbf{x})
    }
    &amp; \quad &amp; \forall \mathbf{h}\\
 &amp;= \frac{
      Z^{-1} \exp E(\mathbf{x}, \mathbf{h}; \phi)
    }{
      \prod_{j = 1}^{M_h} \exp\left[
        \sum_b \hat{\lambda}_{jb} g_{jb}(h_j) -
        B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
      \right]
    }\\
 &amp;= Z^{-1} \exp\left\{
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \left[
        \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right] +
      \sum_j
        B_j\left( \hat{\boldsymbol{\lambda}}_j \right) -
        \sum_b \hat{\lambda}_{jb} g_{jb}(h_j)
    \right\}\\
 &amp;= Z^{-1} \exp\left[
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \sum_j B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    \right]
    &amp; \quad &amp; \text{cancel out } \hat{\lambda}_{jb}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{h})
 &amp;= \frac{
      p(\mathbf{x}, \mathbf{h})
    }{
      p(\mathbf{x} \mid \mathbf{h})
    }
    &amp; \quad &amp; \forall \mathbf{x}\\
 &amp;= \frac{
      Z^{-1} \exp E(\mathbf{x}, \mathbf{h}; \phi)
    }{
      \prod_{i = 1}^{M_v}
        \exp\left[
          \sum_a \hat{\theta}_{ia} f_{ia}(x_i) -
          A_i\left( \hat{\boldsymbol{\theta}}_i \right)
        \right]
    }\\
 &amp;= Z^{-1} \exp\left\{
      \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
      \left[
        \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
          \sum_{j, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right] +
      \sum_i
        A_i\left( \hat{\boldsymbol{\theta}}_i \right) -
        \sum_a \hat{\theta}_{ia} f_{ia}(x_i)
    \right\}\\
 &amp;= Z^{-1} \exp\left[
      \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
      \sum_i
        A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    \right]
    &amp; \quad &amp; \text{cancel out } \hat{\theta}_{ia}.\end{split}\]</div>
<p>Note that</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
  Z &amp;= \sum_{\mathbf{x}'}
         \exp\left[
           \sum_{i, a} \theta_{ia} f_{ia}(x'_i)
         \right]
         \sum_{\mathbf{h}'}
           \exp\left[
             \sum_{j, b} \lambda_{jb} g_{jb}(h'_j) +
               \sum_{i, a} W_{ia}^{jb} f_{ia}(x'_i) g_{jb}(h'_j)
           \right]\\
   &amp;= \sum_{\mathbf{x}'}
        \exp\left[
          \sum_{i, a} \theta_{ia} f_{ia}(x'_i)
        \right]
        \prod_j \sum_{h'_j} \exp \sum_b \hat{\lambda}_{jb} g_{jb}(h'_j)\\
   &amp;= \sum_{\mathbf{x}'}
        \exp\left[
          \sum_{i, a} \theta_{ia} f_{ia}(x'_i) +
          \sum_j B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
        \right]
\end{aligned}
\quad \iff \quad
\begin{aligned}
  Z &amp;= \sum_{\mathbf{h}'}
         \exp\left[
           \sum_{j, b} \lambda_{jb} g_{jb}(h'_j)
         \right]
         \sum_{\mathbf{x}'}
           \exp\left[
             \sum_{i, a} \theta_{ia} f_{ia}(x'_i) +
               \sum_{j, b} W_{ia}^{jb} f_{ia}(x'_i) g_{jb}(h'_j)
           \right]\\
   &amp;= \sum_{\mathbf{h}'}
        \exp\left[
          \sum_{j, b} \lambda_{jb} g_{jb}(h'_j)
        \right]
        \prod_i \sum_{x'_i} \exp \sum_a \hat{\theta}_{ia} f_{ia}(x'_i)\\
   &amp;= \sum_{\mathbf{h}'}
        \exp\left[
          \sum_{j, b} \lambda_{jb} g_{jb}(h'_j) +
          \sum_i A_i\left( \hat{\boldsymbol{\theta}}_i \right)
        \right]
\end{aligned}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial \phi} \log Z
 &amp;= Z^{-1} \sum_{\mathbf{x}', \mathbf{h}'}
      \exp\left( E' \right)
      \frac{\partial E'}{\partial \phi}
 &amp;= \sum_{\mathbf{x}', \mathbf{h}'}
      p(\mathbf{x}', \mathbf{h}') \frac{\partial E'}{\partial \phi}
 &amp;= \left\langle
      \frac{\partial E'}{\partial \phi}
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}
    &amp; \quad &amp; E' = E(\mathbf{x}', \mathbf{h}'; \phi)\\
 &amp;= Z^{-1} \sum_{\mathbf{x}'}
      \exp\left( E'_\mathbf{x} \right)
      \frac{\partial E'_\mathbf{x}}{\partial \phi}
 &amp;= \sum_{\mathbf{x}'}
      p(\mathbf{x}') \frac{\partial E'_\mathbf{x}}{\partial \phi}
 &amp;= \left\langle
      \frac{\partial E'_\mathbf{x}}{\partial \phi}
    \right\rangle_{p(\mathbf{x}')}
    &amp; \quad &amp; E'_\mathbf{x} =
              \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
              \sum_j B_j\left( \hat{\boldsymbol{\lambda}}_j \right).\end{split}\]</div>
<p>The derivation of the learning rules under the maximum likelihood objective
follows in the same manner as the original <a class="reference internal" href="../../11/30/information-processing-in-dynamical-systems-foundations-of-harmony-theory.html"><span class="doc">harmonium</span></a>.
The log-likelihood gradient for a single sample is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial \phi} \log p(\mathbf{x})
 &amp;= \frac{\partial}{\partial \phi} \left(
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \sum_j B_j\left( \hat{\boldsymbol{\lambda}}_j \right) -
      \log Z
    \right)\\
 &amp;= \frac{\partial}{\partial \phi} \left(
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \sum_j \log \sum_{h_j} \exp\left[
        \sum_b \hat{\lambda}_{jb} g_{jb}(h_j)
      \right]
    \right) -
    \left\langle
      \frac{\partial E'}{\partial \phi}
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= \frac{\partial}{\partial \phi} \left(
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \sum_j \log \sum_{h_j} \exp\left[
        \sum_b \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    \right) -
    \left\langle
      \frac{\partial E'_\mathbf{x}}{\partial \phi}
    \right\rangle_{p(\mathbf{x}')}.\end{split}\]</div>
<p>The learning rules themselves are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial}{\partial \theta_{ia}} \log p(\mathbf{x})
 &amp;= f_{ia}(x_i) -
    \left\langle
      f_{ia}(x'_i)
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= f_{ia}(x_i) -
    \left\langle
      f_{ia}(x'_i)
    \right\rangle_{p(\mathbf{x}')},\\\\\\
\frac{\partial}{\partial \lambda_{jb}} \log p(\mathbf{x})
 &amp;= \frac{
      \sum_{h_j} \exp\left[
        \sum_b \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
      g_{jb}(h_j)
    }{
      \sum_{h_j} \exp\left[
        \sum_b \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    } -
    \left\langle
      \frac{\partial E'}{\partial \lambda_{jb}}
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= \frac{
      \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    }{
      \partial \lambda_{jb}
    } -
    \left\langle
      g_{jb}(h'_j)
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= \frac{
      \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    }{
      \partial \lambda_{jb}
    } -
    \left\langle
      \frac{
        \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
      }{
        \partial \lambda_{jb}
      }
    \right\rangle_{p(\mathbf{x}')},\\\\\\
\frac{\partial}{\partial W_{ia}^{jb}}  \log p(\mathbf{x})
 &amp;= \frac{
      \sum_{h_j} \exp\left[
        \sum_b \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
      f_{ia}(x_i) g_{jb}(h_j)
    }{
      \sum_{h_j} \exp\left[
        \sum_b \lambda_{jb} g_{jb}(h_j) +
          \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
      \right]
    } -
    \left\langle
      \frac{\partial E'}{\partial W_{ia}^{jb}}
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= f_{ia}(x_i) \frac{
      \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    }{
      \partial \lambda_{jb}
    } -
    \left\langle
      f_{ia}(x'_i) g_{jb}(h'_j)
    \right\rangle_{p(\mathbf{x}', \mathbf{h}')}\\
 &amp;= f_{ia}(x_i) \frac{
      \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    }{
      \partial \lambda_{jb}
    } -
    \left\langle
      f_{ia}(x'_i) \frac{
        \partial B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
      }{
        \partial \lambda_{jb}
      }
    \right\rangle_{p(\mathbf{x}')}.\end{split}\]</div>
</div>
<div class="section" id="bernoulli-bernoulli">
<h3>Bernoulli-Bernoulli<a class="headerlink" href="#bernoulli-bernoulli" title="Permalink to this headline">¶</a></h3>
<p>Recall that a Bernoulli distribution is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator{\BernDist}{Bern}
p(x \in \{0, 1\} \mid \lambda)
 &amp;= \BernDist_x\left[ \lambda \right]\\
 &amp;= \lambda^x (1 - \lambda)^{(1 - x)}\\
 &amp;= \exp \log \lambda^x (1 - \lambda)^{(1 - x)}\\
 &amp;= \exp\left\{
      x \log \lambda + (1 - x) \log(1 - \lambda)
    \right\}\\
 &amp;= \exp\left\{
      x \log \frac{\lambda}{1 - \lambda} + \log(1 - \lambda)
    \right\}\\
 &amp;= \exp\left\{ \eta x + \log\left( 1 + e^\eta \right) \right\}
    &amp; \quad &amp; \eta = \log \frac{\lambda}{1 - \lambda}.\end{split}\]</div>
<p>By inspection, <span class="math notranslate nohighlight">\(\lambda = \left( 1 + \exp\{-\eta\} \right)^{-1}\)</span>.</p>
<p>An EFH with Bernoulli observed variables and Bernoulli latent variables defines</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(x_i \mid \mathbf{h})
 &amp;= p_i(x_i; \hat{\boldsymbol{\theta}}_i)\\
 &amp;= \exp\left[
      \sum_a \hat{\theta}_{ia} f_{ia}(x_i) -
      A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    \right]\\
 &amp;= \exp\left[
      \sum_a \hat{\theta_{ia}} x_i -
      \log \sum_{x'_i} \exp \sum_a \hat{\theta}_{ia} x'_i
    \right]
    &amp; \quad &amp; f_{ia}(x_i) = x_i\\
 &amp;= \exp\left[
      \sum_a \hat{\theta}_{ia} x_i -
      \log\left( 1 + \exp \sum_a \hat{\theta}_{ia} \right)
    \right]
    &amp; \quad &amp; x'_i \in \{0, 1\}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(h_j \mid \mathbf{x})
 &amp;= p_j(h_j; \hat{\boldsymbol{\lambda}}_j)\\
 &amp;= \exp\left[
      \sum_b \hat{\lambda}_{jb} g_{jb}(h_j) -
      B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    \right]\\
 &amp;= \exp\left[
      \sum_b \hat{\lambda}_{jb} h_j -
      \log \sum_{h'_j} \exp \sum_b \hat{\lambda}_{jb} h'_j
    \right]
    &amp; \quad &amp; g_{jb}(h_j) = h_j\\
 &amp;= \exp\left[
      \sum_b \hat{\lambda}_{jb} h_j -
      \log\left( 1 + \exp \sum_b \hat{\lambda}_{jb} \right)
    \right]
    &amp; \quad &amp; h'_j \in \{0, 1\}.\end{split}\]</div>
<p>Note that this formulation is equivalent to the
<a class="reference internal" href="../../11/30/information-processing-in-dynamical-systems-foundations-of-harmony-theory.html"><span class="doc">Bernoulli-Bernoulli RBM</span></a>.</p>
</div>
<div class="section" id="gaussian-bernoulli">
<h3>Gaussian-Bernoulli<a class="headerlink" href="#gaussian-bernoulli" title="Permalink to this headline">¶</a></h3>
<p>Recall that a Gaussian distribution is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator{\NormDist}{Norm}
p(x \mid \mu, \sigma)
 &amp;= \NormDist_{x}\left[ \mu, \sigma^2 \right]\\
 &amp;= \frac{1}{\sqrt{2 \pi \sigma^2}}
    \exp\left( -\frac{(x - \mu)^2}{2 \sigma^2} \right)\\
 &amp;= \exp\left( -\frac{\mu^2}{2 \sigma^2} - \log \sigma \sqrt{2 \pi} \right)
    \exp\left( \frac{\mu x}{\sigma^2} - \frac{x^2}{2 \sigma^2} \right).\end{split}\]</div>
<p>An EFH with Gaussian observed variables and Bernoulli latent variables defines</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta_{i1} &amp;= -\frac{\mu_i^2}{2 \sigma_i^2} - \log \sigma_i \sqrt{2 \pi},
  &amp; \qquad &amp;
  f_{i1} &amp;= 1,
  &amp; \qquad &amp;
  W_{i1}^{\cdot \cdot} &amp;= 0;\\
\theta_{i2} &amp;= \frac{\mu_i}{\sigma_i^2},
  &amp; \qquad &amp;
  f_{i2} &amp;= x_i,
  &amp; \qquad &amp;
  W_{i2}^{\cdot \cdot} &amp;\in \mathbb{R};\\
\theta_{i3} &amp;= -\frac{1}{2 \sigma_i^2},
  &amp; \qquad &amp;
  f_{i3} &amp;= x_i^2,
  &amp; \qquad &amp;
  W_{i3}^{\cdot \cdot} &amp;= 0\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(x_i \mid \mathbf{h})
 &amp;= p_i(x_i; \hat{\boldsymbol{\theta}}_i)\\
 &amp;= \exp\left[
      \sum_a
        \left( \theta_{ia} + \sum_{j, b} W_{ia}^{jb} g_{jb}(h_j) \right)
          f_{ia}(x_i) -
      A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    \right]\\
 &amp;= \frac{1}{\exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)}
    \exp\left[
      -\frac{\mu_i^2}{2 \sigma_i^2} - \log \sigma_i \sqrt{2 \pi}
    \right]
    \exp\left[
      \frac{\mu_i x_i}{\sigma_i^2} - \frac{x_i^2}{2 \sigma_i^2} +
      x_i \sum_{j, b} W_{i2}^{jb} h_j
    \right]
    &amp; \quad &amp; g_{jb}(h_j) = h_j\\
 &amp;= \frac{
      \exp\left[ \log \sigma_i \sqrt{2 \pi} \right]^{-1}
    }{
      \exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    }
    \exp\left[
      \frac{x_i \sum_j w_{ij} h_j}{\sigma_i^2} -
      \frac{\left( x_i - \mu_i \right)^2}{2 \sigma_i^2}
    \right]
    &amp; \quad &amp; W_{i2}^{jb} = \frac{w_{ij}}{\sigma_i^2}\\
 &amp;= \frac{
      \exp\left[ \log \sigma_i \sqrt{2 \pi} \right]^{-1}
    }{
      \exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    }
    \exp \frac{
           -\left( x_i - \mu_i - \sum_j w_{ij} h_j \right)^2 +
           \left( \sum_j w_{ij} h_j \right)^2 +
           2 \mu_i \sum_j w_{ij} h_j
         }{2 \sigma_i^2}
    &amp; \quad &amp; \frac{ax}{\sigma^2} -
                \frac{\left( x - b \right)^2}{2 \sigma^2} =
              \frac{-\left( x - a - b \right)^2 + a^2 + 2ab}{2 \sigma^2}\\
 &amp;= \frac{
      \exp\left[
        -\log \sigma_i \sqrt{2 \pi} +
        \left( \sum_j w_{ij} h_j \right)^2 +
        2 \mu_i \sum_j w_{ij} h_j
      \right]
    }{
      \exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    }
    \exp \frac{
           -\left( x_i - \mu_i - \sum_j w_{ij} h_j \right)^2
         }{2 \sigma_i^2}\\
 &amp;= \frac{1}{
      \int
        \exp -\left( x'_i - \mu_i - \sum_j w_{ij} h_j \right)^2
             \left( 2 \sigma_i^2 \right)^{-1}
        dx'_i
    }
    \exp \frac{
           -\left( x_i - \mu_i - \sum_j w_{ij} h_j \right)^2
         }{2 \sigma_i^2}\\
 &amp;= \frac{1}{\sigma_i \sqrt{2 \pi}}
    \exp \frac{
           -\left(
             x_i - \mu_i - \sum_j w_{ij} h_j
           \right)^2
         }{2 \sigma_i^2}
    &amp; \quad &amp; \int_{-\infty}^\infty e^{-a (x + b)^2} dx = \sqrt{a^{-1} \pi}\\
 &amp;= \NormDist_{x_i}\left[ \mu_i + \sum_j w_{ij} h_j, \sigma_i^2 \right]\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}\DeclareMathOperator{\sigmoid}{sigmoid}
p(h_j = 1 \mid \mathbf{x})
 &amp;= p_j(h_j = 1; \hat{\boldsymbol{\lambda}}_j)\\
 &amp;= \exp\left[
      \sum_b
        \left(
          \lambda_{jb} + \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i)
        \right) h_j -
      \log\left( 1 + \exp \sum_b \hat{\lambda}_{jb} \right)
    \right]\\
 &amp;= \frac{
      \exp\left( \lambda_j + \sum_i \frac{w_{ij}}{\sigma_i^2} x_i \right)
    }{
      1 + \exp \hat{\lambda}_j
    }
    &amp; \quad &amp; \lambda_{jb} = \lambda_j\\
 &amp;= \sigmoid\left(
      \lambda_j + \sum_i \frac{w_{ij}}{\sigma_i^2} x_i
    \right)
    &amp; \quad &amp; \sigmoid(u) = \frac{1}{1 + \exp(-u)}\end{split}\]</div>
<p>By inspection,</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{x}, \mathbf{h})
 &amp;= Z^{-1}
    \exp\left[
      \sum_{i, a} \theta_{ia} f_{ia}(x_i) +
      \sum_{j, b} \lambda_{jb} g_{jb}(h_j) +
      \sum_{i, j, a, b} W_{ia}^{jb} f_{ia}(x_i) g_{jb}(h_j)
    \right]\\
 &amp;= Z^{-1}
    \exp\left[
      \left(
        \sum_i
          -\frac{\mu_i^2}{2 \sigma_i^2} - \log \sigma_i \sqrt{2 \pi} +
          \frac{\mu_i}{\sigma_i^2} x_i -
          \frac{1}{2 \sigma_i^2} x_i^2
      \right) +
      \sum_j \lambda_j h_j +
      \sum_{i, j} \frac{w_{ij}}{\sigma_i^2} x_i h_j
    \right]\\
 &amp;= \frac{\exp -\sum_i \log \sigma_i \sqrt{2 \pi}}{Z^{-1}}
    \exp\left[
      \sum_i -\frac{\left( x_i - \mu_i \right)^2}{2 \sigma_i^2} +
      \sum_j \lambda_j h_j +
      \sum_{i, j} \frac{w_{ij}}{\sigma_i^2} x_i h_j
    \right]\\
 &amp;\approx
    \exp\left[
      \sum_i -\frac{\left( x_i - \mu_i \right)^2}{2 \sigma_i^2} +
      \sum_j \lambda_j h_j +
      \sum_{i, j} \frac{w_{ij}}{\sigma_i^2} x_i h_j
    \right].\end{split}\]</div>
</div>
<div class="section" id="bernoulli-gaussian">
<h3>Bernoulli-Gaussian<a class="headerlink" href="#bernoulli-gaussian" title="Permalink to this headline">¶</a></h3>
<p>An EFH with Bernoulli observed variables and Gaussian latent variables defines</p>
<div class="math notranslate nohighlight">
\[\begin{split}\lambda_{j1} &amp;= -\frac{\mu_j^2}{2 \sigma_j^2} - \log \sigma_j \sqrt{2 \pi},
  &amp; \qquad &amp;
  g_{j1} &amp;= 1,
  &amp; \qquad &amp;
  W_{\cdot \cdot}^{j1} &amp;= 0;\\
\lambda_{j2} &amp;= \frac{\mu_j}{\sigma_j^2},
  &amp; \qquad &amp;
  g_{j2} &amp;= h_j,
  &amp; \qquad &amp;
  W_{\cdot \cdot}^{j2} &amp;\in \mathbb{R};\\
\lambda_{j3} &amp;= -\frac{1}{2 \sigma_j^2},
  &amp; \qquad &amp;
  g_{j3} &amp;= h_j^2,
  &amp; \qquad &amp;
  W_{\cdot \cdot}^{j3} &amp;= 0\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(h_j \mid \mathbf{x})
 &amp;= p_j(h_j; \hat{\boldsymbol{\lambda}}_j)\\
 &amp;= \exp\left[
      \sum_b
        \left(
          \lambda_{jb} + \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i)
        \right) g_{jb}(h_j) -
      B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    \right]\\
 &amp;= \frac{1}{\exp B_j\left( \hat{\boldsymbol{\lambda}}_j \right)}
    \exp\left[
      -\frac{\mu_j^2}{2 \sigma_j^2} - \log \sigma_j \sqrt{2 \pi}
    \right]
    \exp\left[
      \frac{\mu_j h_j}{\sigma_j^2} - \frac{h_j^2}{2 \sigma_j^2} +
      h_j \sum_{i, a} W_{ia}^{j2} x_i
    \right]
    &amp; \quad &amp; f_{ia}(x_i) = x_i\\
 &amp;= \NormDist_{h_j}\left[ \mu_j + \sum_i w_{ij} x_i, \sigma_j^2 \right]
    &amp; \quad &amp; W_{ia}^{j2} = \frac{w_{ij}}{\sigma_j^2}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(x_i = 1 \mid \mathbf{h})
 &amp;= p_i(x_i = 1; \hat{\boldsymbol{\theta}}_i)\\
 &amp;= \exp\left[
      \sum_a
        \left(
          \theta_{ia} + \sum_{j, b} W_{ia}^{jb} g_{jb}(h_j)
        \right) x_i -
      \log\left( 1 + \exp \sum_a \hat{\theta}_{ia} \right)
    \right]\\
 &amp;= \frac{
      \exp\left( \theta_i + \sum_j \frac{w_{ij}}{\sigma_j^2} h_j \right)
    }{
      1 + \exp \hat{\theta}_i
    }
    &amp; \quad &amp; \theta_{ia} = \theta_i\\
 &amp;= \sigmoid\left( \theta_i + \sum_j \frac{w_{ij}}{\sigma_j^2} h_j \right).\end{split}\]</div>
<p>By inspection,</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\mathbf{x}, \mathbf{h})
 &amp;= Z^{-1}
    \exp\left[
      \sum_i \theta_i x_i +
      \left(
        \sum_j
          -\frac{\mu_j^2}{2 \sigma_j^2} - \log \sigma_j \sqrt{2 \pi} +
          \frac{\mu_j}{\sigma_j^2} h_j -
          \frac{1}{2 \sigma_j^2} h_j^2
      \right) +
      \sum_{i, j} \frac{w_{ij}}{\sigma_j^2} x_i h_j
    \right]\\
 &amp;\approx
    \exp\left[
      \sum_i \theta_i x_i -
      \sum_j \frac{\left( h_j - \mu_j \right)^2}{2 \sigma_j^2} +
      \sum_{i, j} \frac{w_{ij}}{\sigma_j^2} x_i h_j
    \right].\end{split}\]</div>
</div>
<div class="section" id="gaussian-gaussian">
<h3>Gaussian-Gaussian<a class="headerlink" href="#gaussian-gaussian" title="Permalink to this headline">¶</a></h3>
<p>An EFH with Gaussian observed variables and Gaussian latent variables defines</p>
<div class="math notranslate nohighlight">
\[\begin{split}\theta_{i1} &amp;= -\frac{\mu_i^2}{2 \sigma_i^2} - \log \sigma_i \sqrt{2 \pi},
  &amp; \qquad &amp;
  f_{i1} &amp;= 1,
  &amp; \qquad &amp;
  g_{j1} &amp;= 1,
  &amp; \qquad &amp;
  \lambda_{j1} &amp;= -\frac{\mu_j^2}{2 \sigma_j^2} - \log \sigma_j \sqrt{2 \pi},
  &amp; \qquad &amp;
  W_{i2}^{j2} &amp;\in \mathbb{R};\\
\theta_{i2} &amp;= \frac{\mu_i}{\sigma_i^2},
  &amp; \qquad &amp;
  f_{i2} &amp;= x_i,
  &amp; \qquad &amp;
  g_{j2} &amp;= h_j,
  &amp; \qquad &amp;
  \lambda_{j2} &amp;= \frac{\mu_j}{\sigma_j^2};\\
\theta_{i3} &amp;= -\frac{1}{2 \sigma_i^2},
  &amp; \qquad &amp;
  f_{i3} &amp;= x_i^2,
  &amp; \qquad &amp;
  g_{j3} &amp;= h_j^2,
  &amp; \qquad &amp;
  \lambda_{j3} &amp;= -\frac{1}{2 \sigma_j^2},
  &amp; \qquad &amp;
  W_{ia}^{jb} &amp;= 0 \quad \forall i \neq 2, j \neq 2\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(x_i \mid \mathbf{h})
 &amp;= p_i(x_i; \hat{\boldsymbol{\theta}}_i)\\
 &amp;= \exp\left[
      \sum_a
        \left( \theta_{ia} + \sum_{j, b} W_{ia}^{jb} g_{jb}(h_j) \right)
          f_{ia}(x_i) -
      A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    \right]\\
 &amp;= \frac{1}{\exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)}
    \exp\left[
      -\frac{\mu_i^2}{2 \sigma_i^2} - \log \sigma_i \sqrt{2 \pi}
    \right]
    \exp\left[
      \frac{\mu_i x_i}{\sigma_i^2} - \frac{x_i^2}{2 \sigma_i^2} +
      x_i \sum_j W_{i2}^{j2} h_j
    \right]\\
 &amp;= \frac{
      \exp\left[ \log \sigma_i \sqrt{2 \pi} \right]^{-1}
    }{
      \exp A_i\left( \hat{\boldsymbol{\theta}}_i \right)
    }
    \exp\left[
      \frac{x_i \sigma_i^2 \sum_j W_{i2}^{j2} h_j}{\sigma_i^2} -
      \frac{\left( x_i - \mu_i \right)^2}{2 \sigma_i^2}
    \right]\\
 &amp;= \NormDist_{x_i}\left[
      \mu_i + \sigma_i^2 \sum_j W_{i2}^{j2} h_j, \sigma_i^2
    \right]\\
 &amp;= \NormDist_{x_i}\left[
      \mu_i + \sum_j \frac{w_{ij}}{\sigma_j^2} h_j, \sigma_i^2
    \right]
    &amp; \quad &amp; W_{i2}^{j2} = \frac{w_{ij}}{\sigma_i^2 \sigma_j^2}\\\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(h_j \mid \mathbf{x})
 &amp;= p_j(h_j; \hat{\boldsymbol{\lambda}}_j)\\
 &amp;= \exp\left[
      \sum_b
        \left(
          \lambda_{jb} + \sum_{i, a} W_{ia}^{jb} f_{ia}(x_i)
        \right) g_{jb}(h_j) -
      B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    \right]\\
 &amp;= \frac{1}{\exp B_j\left( \hat{\boldsymbol{\lambda}}_j \right)}
    \exp\left[
      -\frac{\mu_j^2}{2 \sigma_j^2} - \log \sigma_j \sqrt{2 \pi}
    \right]
    \exp\left[
      \frac{\mu_j h_j}{\sigma_j^2} - \frac{h_j^2}{2 \sigma_j^2} +
      h_j \sum_i W_{i2}^{j2} x_i
    \right]\\
 &amp;= \frac{
      \exp\left[ \log \sigma_j \sqrt{2 \pi} \right]^{-1}
    }{
      \exp B_j\left( \hat{\boldsymbol{\lambda}}_j \right)
    }
    \exp\left[
      \frac{h_j \sigma_j^2 \sum_i W_{i2}^{j2} x_i}{\sigma_j^2} -
      \frac{\left( h_j - \mu_j \right)^2}{2 \sigma_j^2}
    \right]\\
 &amp;= \NormDist_{h_j}\left[
      \mu_j + \sigma_j^2 \sum_i W_{i2}^{j2} x_i, \sigma_j^2
    \right]\\
 &amp;= \NormDist_{h_j}\left[
      \mu_j + \sum_i \frac{w_{ij}}{\sigma_i^2} x_i, \sigma_j^2
    \right].\end{split}\]</div>
<p>By inspection,</p>
<div class="math notranslate nohighlight">
\[p(\mathbf{x}, \mathbf{h}) \approx
\exp\left[
  -\sum_i \frac{\left( x_i - \mu_i \right)^2}{2 \sigma_i^2} -
  \sum_j \frac{\left( h_j - \mu_j \right)^2}{2 \sigma_j^2} +
  \sum_{i, j} \frac{w_{ij}}{\sigma_i^2 \sigma_j^2} x_i h_j
\right].\]</div>
<p class="rubric">References</p>
<p id="bibtex-bibliography-blog/2016/12/05/exponential-family-harmoniums-with-an-application-to-information-retrieval-0"><dl class="citation">
<dt class="bibtex label" id="welling2005exponential"><span class="brackets">WRZH05</span></dt>
<dd><p>Max Welling, Michal Rosen-Zvi, and Geoffrey E Hinton. Exponential family harmoniums with an application to information retrieval. In <em>Advances in neural information processing systems</em>, 1481–1488. 2005.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../../../../_sources/blog/2016/12/05/exponential-family-harmoniums-with-an-application-to-information-retrieval.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2013-2020, alphaXomega.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>